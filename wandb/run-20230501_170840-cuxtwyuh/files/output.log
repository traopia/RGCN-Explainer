24
start training
masked_hor: tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.8258, 0.8068, 0.7790, 0.0597, 0.0768, 0.0656, 0.0729,
                      0.0631, 0.0751, 0.0690, 0.0702, 0.0745, 0.0664, 0.7362,
                      0.5820, 0.7186, 0.7131, 0.7080, 0.7742, 0.6944, 0.6962,
                      0.7275, 0.6815, 0.7494]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
gt_label_node tensor(2, dtype=torch.int32)
gt_label_node <class 'torch.Tensor'>
logit tensor(0.2903, grad_fn=<SelectBackward0>)
mask_without_small tensor([0.8258, 0.8068, 0.7790, 0.5968, 0.7678, 0.6556, 0.7286, 0.6311, 0.7508,
        0.6904, 0.7022, 0.7445, 0.6636, 0.7362, 0.5820, 0.7186, 0.7131, 0.7080,
        0.7742, 0.6944, 0.6962, 0.7275, 0.6815, 0.7494],
       grad_fn=<IndexBackward0>)
num_high 24
pred_loss tensor(1.2367, grad_fn=<MulBackward0>)
size_loss tensor(-0.0360, grad_fn=<MulBackward0>)
size_num_loss 1.0
  0%|                                                                                                                | 0/10 [00:00<?, ?it/s]/Users/macoftraopia/Documents/GitHub/RGCN-Explainer/RGCN_stuff/r.py:126: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  adj = torch.tensor(adj)
epoch:  0 ; loss:  2.2006912231445312 ; pred:  tensor([0.2633, 0.2760, 0.2903, 0.1704], grad_fn=<SoftmaxBackward0>)
masked_hor: tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.8866, 0.8732, 0.8532, 0.0473, 0.0845, 0.0536, 0.0816,
                      0.0509, 0.0832, 0.0575, 0.0795, 0.0828, 0.0545, 0.8215,
                      0.4579, 0.8081, 0.8039, 0.7999, 0.8497, 0.7893, 0.7907,
                      0.8148, 0.7792, 0.6446]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
gt_label_node tensor(2, dtype=torch.int32)
gt_label_node <class 'torch.Tensor'>
logit tensor(1., grad_fn=<SelectBackward0>)
mask_without_small tensor([0.8866, 0.8732, 0.8532, 0.8450, 0.5358, 0.8157, 0.5092, 0.8324, 0.5749,
        0.7954, 0.8277, 0.5447, 0.8215, 0.8081, 0.8039, 0.7999, 0.8497, 0.7893,
        0.7907, 0.8148, 0.7792, 0.6446], grad_fn=<IndexBackward0>)
num_high 22
pred_loss tensor(-0., grad_fn=<MulBackward0>)
size_loss tensor(-129.0164, grad_fn=<AddBackward0>)
size_num_loss 0.9166666666666666
 10%|██████████▍                                                                                             | 1/10 [00:22<03:21, 22.34s/it]
masked_hor: tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.9190, 0.9090, 0.8940, 0.0391, 0.0888, 0.0443, 0.0865,
                      0.0417, 0.0878, 0.0482, 0.0849, 0.0875, 0.0452, 0.8698,
                      0.3766, 0.8593, 0.8561, 0.8530, 0.8913, 0.8446, 0.8457,
                      0.8646, 0.8366, 0.5556]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
gt_label_node tensor(2, dtype=torch.int32)
gt_label_node <class 'torch.Tensor'>
logit tensor(1., grad_fn=<SelectBackward0>)
mask_without_small tensor([0.9190, 0.9090, 0.8940, 0.8878, 0.8653, 0.8781, 0.8495, 0.8747, 0.8698,
        0.8593, 0.8561, 0.8530, 0.8913, 0.8446, 0.8457, 0.8646, 0.8366, 0.5556],
       grad_fn=<IndexBackward0>)
num_high 18
pred_loss tensor(-0., grad_fn=<MulBackward0>)
size_loss tensor(-52.5757, grad_fn=<AddBackward0>)

 20%|████████████████████▊                                                                                   | 2/10 [00:44<02:56, 22.04s/it]
epoch:  2 ; loss:  -51.825740814208984 ; pred:  tensor([1.1283e-24, 1.5601e-23, 1.0000e+00, 1.0983e-23],
       grad_fn=<SoftmaxBackward0>)
masked_hor: tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.9442, 0.9369, 0.9257, 0.0331, 0.0921, 0.0374, 0.0901,
                      0.0349, 0.0913, 0.0411, 0.0879, 0.0910, 0.0382, 0.9055,
                      0.3180, 0.8944, 0.8900, 0.8852, 0.9236, 0.8656, 0.8690,
                      0.9004, 0.8310, 0.4587]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
gt_label_node tensor(2, dtype=torch.int32)
gt_label_node <class 'torch.Tensor'>
logit tensor(1., grad_fn=<SelectBackward0>)
mask_without_small tensor([0.9442, 0.9369, 0.9257, 0.9208, 0.9011, 0.9130, 0.8785, 0.9101, 0.9055,
        0.8944, 0.8900, 0.8852, 0.9236, 0.8656, 0.8690, 0.9004, 0.8310],
       grad_fn=<IndexBackward0>)
num_high 17
pred_loss tensor(-0., grad_fn=<MulBackward0>)
size_loss tensor(-0.4628, grad_fn=<AddBackward0>)

 30%|███████████████████████████████▏                                                                        | 3/10 [01:06<02:34, 22.12s/it]
masked_hor: tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.9612, 0.9559, 0.9474, 0.0286, 0.0943, 0.0320, 0.0924,
                      0.0298, 0.0937, 0.0356, 0.0881, 0.0934, 0.0328, 0.9293,
                      0.2739, 0.9147, 0.9071, 0.8972, 0.9457, 0.8495, 0.8576,
                      0.9233, 0.7867, 0.3813]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
gt_label_node tensor(2, dtype=torch.int32)
gt_label_node <class 'torch.Tensor'>
logit tensor(1., grad_fn=<SelectBackward0>)
mask_without_small tensor([0.9612, 0.9559, 0.9474, 0.9435, 0.9241, 0.9367, 0.8814, 0.9340, 0.9293,
        0.9147, 0.9071, 0.8972, 0.9457, 0.8495, 0.8576, 0.9233, 0.7867],
       grad_fn=<IndexBackward0>)
num_high 17
pred_loss tensor(-0., grad_fn=<MulBackward0>)
size_loss tensor(-12.9571, grad_fn=<AddBackward0>)

 40%|█████████████████████████████████████████▌                                                              | 4/10 [01:28<02:12, 22.10s/it]
epoch:  4 ; loss:  -12.248778343200684 ; pred:  tensor([0., 0., 1., 0.], grad_fn=<SoftmaxBackward0>)
masked_hor: tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.9727, 0.9689, 0.9625, 0.0251, 0.0960, 0.0279, 0.0942,
                      0.0258, 0.0954, 0.0312, 0.0866, 0.0952, 0.0286, 0.9471,
                      0.2397, 0.9298, 0.9180, 0.8995, 0.9613, 0.8086, 0.8218,
                      0.9407, 0.7220, 0.3202]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
gt_label_node tensor(2, dtype=torch.int32)
gt_label_node <class 'torch.Tensor'>
logit tensor(1., grad_fn=<SelectBackward0>)
mask_without_small tensor([0.9727, 0.9689, 0.9625, 0.9595, 0.9416, 0.9539, 0.8663, 0.9516, 0.9471,
        0.9298, 0.9180, 0.8995, 0.9613, 0.8086, 0.8218, 0.9407, 0.7220],
       grad_fn=<IndexBackward0>)
num_high 17
pred_loss tensor(-0., grad_fn=<MulBackward0>)
size_loss tensor(-40.9457, grad_fn=<AddBackward0>)

 50%|████████████████████████████████████████████████████                                                    | 5/10 [01:50<01:49, 21.95s/it]
masked_hor: tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.9806, 0.9779, 0.9733, 0.0223, 0.0971, 0.0246, 0.0956,
                      0.0226, 0.0967, 0.0276, 0.0832, 0.0965, 0.0252, 0.9610,
                      0.2127, 0.9433, 0.9275, 0.8953, 0.9724, 0.7484, 0.7659,
                      0.9552, 0.6397, 0.2719]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
gt_label_node tensor(2, dtype=torch.int32)
gt_label_node <class 'torch.Tensor'>
logit tensor(1., grad_fn=<SelectBackward0>)
mask_without_small tensor([0.9806, 0.9779, 0.9733, 0.9711, 0.9560, 0.9668, 0.8321, 0.9649, 0.9610,
        0.9433, 0.9275, 0.8953, 0.9724, 0.7484, 0.7659, 0.9552, 0.6397],
       grad_fn=<IndexBackward0>)
num_high 17
pred_loss tensor(-0., grad_fn=<MulBackward0>)
size_loss tensor(-93.3914, grad_fn=<AddBackward0>)

 60%|██████████████████████████████████████████████████████████████▍                                         | 6/10 [02:11<01:26, 21.72s/it]
epoch:  6 ; loss:  -92.68303680419922 ; pred:  tensor([0., 0., 1., 0.], grad_fn=<SoftmaxBackward0>)
masked_hor: tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.9860, 0.9841, 0.9809, 0.0201, 0.0979, 0.0219, 0.0968,
                      0.0201, 0.0976, 0.0247, 0.0779, 0.0975, 0.0225, 0.9719,
                      0.1910, 0.9563, 0.9386, 0.8856, 0.9803, 0.6709, 0.6926,
                      0.9671, 0.5434, 0.2337]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
gt_label_node tensor(2, dtype=torch.int32)
gt_label_node <class 'torch.Tensor'>
logit tensor(1., grad_fn=<SelectBackward0>)
mask_without_small tensor([0.9860, 0.9841, 0.9809, 0.9793, 0.9678, 0.9763, 0.7787, 0.9749, 0.9719,
        0.9563, 0.9386, 0.8856, 0.9803, 0.6709, 0.6926, 0.9671, 0.5434],
       grad_fn=<IndexBackward0>)
num_high 17
pred_loss tensor(-0., grad_fn=<MulBackward0>)
size_loss tensor(-180.7666, grad_fn=<AddBackward0>)

 70%|████████████████████████████████████████████████████████████████████████▊                               | 7/10 [02:33<01:05, 21.77s/it]
masked_hor: tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.9898, 0.9885, 0.9863, 0.0182, 0.0985, 0.0197, 0.0977,
                      0.0181, 0.0983, 0.0223, 0.0708, 0.0982, 0.0203, 0.9802,
                      0.1733, 0.9678, 0.9515, 0.8710, 0.9859, 0.5787, 0.6039,
                      0.9766, 0.4392, 0.2032]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
gt_label_node tensor(2, dtype=torch.int32)
gt_label_node <class 'torch.Tensor'>
logit tensor(1., grad_fn=<SelectBackward0>)
mask_without_small tensor([0.9898, 0.9885, 0.9863, 0.9853, 0.9771, 0.9832, 0.7081, 0.9823, 0.9802,
        0.9678, 0.9515, 0.8710, 0.9859, 0.5787, 0.6039, 0.9766],
       grad_fn=<IndexBackward0>)
num_high 16
pred_loss tensor(-0., grad_fn=<MulBackward0>)
size_loss tensor(-196.0195, grad_fn=<AddBackward0>)

 80%|███████████████████████████████████████████████████████████████████████████████████▏                    | 8/10 [02:54<00:43, 21.66s/it]
epoch:  8 ; loss:  -195.35287475585938 ; pred:  tensor([0., 0., 1., 0.], grad_fn=<SoftmaxBackward0>)
masked_hor: tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.9924, 0.9915, 0.9901, 0.0167, 0.0989, 0.0179, 0.0984,
                      0.0164, 0.0988, 0.0204, 0.0625, 0.0987, 0.0184, 0.9860,
                      0.1586, 0.9770, 0.9634, 0.8401, 0.9898, 0.4787, 0.5061,
                      0.9835, 0.3507, 0.1788]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
gt_label_node tensor(2, dtype=torch.int32)
gt_label_node <class 'torch.Tensor'>
logit tensor(1., grad_fn=<SelectBackward0>)
mask_without_small tensor([0.9924, 0.9915, 0.9901, 0.9894, 0.9839, 0.9881, 0.6255, 0.9875, 0.9860,
        0.9770, 0.9634, 0.8401, 0.9898, 0.5061, 0.9835],
       grad_fn=<IndexBackward0>)
num_high 15
pred_loss tensor(-0., grad_fn=<MulBackward0>)
size_loss tensor(-218.9570, grad_fn=<AddBackward0>)

 90%|█████████████████████████████████████████████████████████████████████████████████████████████▌          | 9/10 [03:16<00:21, 21.77s/it]
sel masked ver tensor(indices=tensor([[6860, 6874, 6920, 7731, 7857, 7933, 5757, 5757],
                       [5757, 5757, 5757, 5757, 5757, 5757,  908, 2227]]),
       values=tensor([0.9924, 0.9915, 0.9901, 0.9894, 0.9839, 0.9881, 0.6255,
                      0.9875]),
       size=(7934, 5758), nnz=8, layout=torch.sparse_coo,

100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [03:38<00:00, 21.84s/it]
Counter({'author': 6, 'fax': 1, 'name': 1})
dict index: {}
/usr/local/Caskroom/miniconda/base/lib/python3.9/site-packages/networkx/drawing/nx_pylab.py:433: UserWarning: No data for colormapping provided via 'c'. Parameters 'cmap' will be ignored
  node_collection = ax.scatter(
ypred explain tensor([0., 0., 1., 0.], grad_fn=<SoftmaxBackward0>)
ypred full tensor([0.0905, 0.1411, 0.7186, 0.0498], grad_fn=<SoftmaxBackward0>)
original label [2]
num mislabel 1
num correct 34
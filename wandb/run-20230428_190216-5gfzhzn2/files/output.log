24
start training
tensor([[ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        ...,
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028]], grad_fn=<AddBackward0>)
masked_hor: tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.8258, 0.8068, 0.7790, 0.0597, 0.0768, 0.0656, 0.0729,
                      0.0631, 0.0751, 0.0690, 0.0702, 0.0745, 0.0664, 0.7362,
                      0.5820, 0.7186, 0.7131, 0.7080, 0.7742, 0.6944, 0.6962,
                      0.7275, 0.6815, 0.7494]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
tensor([[ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        ...,
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028]], grad_fn=<AddBackward0>)
gt_label_node tensor(2, dtype=torch.int32)
gt_label_node <class 'torch.Tensor'>
logit tensor(0.2903, grad_fn=<SelectBackward0>)
mask_without_small tensor([0.8258, 0.8068, 0.7790, 0.5968, 0.7678, 0.6556, 0.7286, 0.6311, 0.7508,
        0.6904, 0.7022, 0.7445, 0.6636, 0.7362, 0.5820, 0.7186, 0.7131, 0.7080,
        0.7742, 0.6944, 0.6962, 0.7275, 0.6815, 0.7494],
       grad_fn=<IndexBackward0>)
pred_loss tensor(1.2367, grad_fn=<MulBackward0>)
size_loss tensor(-0.3599, grad_fn=<MulBackward0>)
size_num_loss 0.72
/Users/macoftraopia/Documents/GitHub/RGCN-Explainer/RGCN_stuff/r.py:125: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  adj = torch.tensor(adj)
epoch:  0 ; loss:  1.596799373626709 ; pred:  tensor([0.2633, 0.2760, 0.2903, 0.1704], grad_fn=<SoftmaxBackward0>)
tensor([[ 0.0714, -0.1144,  0.0671, -0.1528],
        [ 0.0714, -0.1144,  0.0671, -0.1528],
        [ 0.0714, -0.1144,  0.0671, -0.1528],
        ...,
        [ 0.0714, -0.1144,  0.0671, -0.1528],
        [ 0.0714, -0.1144,  0.0671, -0.1528],
        [ 0.0714, -0.1144,  0.0671, -0.1528]], grad_fn=<AddBackward0>)
masked_hor: tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.8329, 0.8145, 0.7875, 0.0585, 0.0777, 0.0644, 0.0738,
                      0.0619, 0.0760, 0.0680, 0.0692, 0.0754, 0.0652, 0.7458,
                      0.5698, 0.7286, 0.7232, 0.6976, 0.7828, 0.6836, 0.6855,
                      0.7373, 0.6706, 0.7587]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
tensor([[ 0.0714, -0.1144,  0.0671, -0.1528],
        [ 0.0714, -0.1144,  0.0671, -0.1528],
        [ 0.0714, -0.1144,  0.0671, -0.1528],
        ...,
        [ 0.0714, -0.1144,  0.0671, -0.1528],
        [ 0.0714, -0.1144,  0.0671, -0.1528],
        [ 0.0714, -0.1144,  0.0671, -0.1528]], grad_fn=<AddBackward0>)
gt_label_node tensor(2, dtype=torch.int32)
gt_label_node <class 'torch.Tensor'>
logit tensor(0.6107, grad_fn=<SelectBackward0>)
mask_without_small tensor([0.8329, 0.8145, 0.7875, 0.5847, 0.7766, 0.6442, 0.7384, 0.6193, 0.7600,
        0.6796, 0.6916, 0.7539, 0.6523, 0.7458, 0.5698, 0.7286, 0.7232, 0.6976,
        0.7828, 0.6836, 0.6855, 0.7373, 0.6706, 0.7587],
       grad_fn=<IndexBackward0>)
pred_loss tensor(0.4931, grad_fn=<MulBackward0>)
size_loss tensor(-0.4658, grad_fn=<MulBackward0>)
size_num_loss 0.72
24
start training
tensor([[ 0.0251, -0.1619,  0.1143, -0.2009],
        [ 0.0251, -0.1619,  0.1143, -0.2009],
        [ 0.0251, -0.1619,  0.1143, -0.2009],
        ...,
        [ 0.0251, -0.1619,  0.1143, -0.2009],
        [ 0.0251, -0.1619,  0.1143, -0.2009],
        [ 0.0251, -0.1619,  0.1143, -0.2009]], grad_fn=<AddBackward0>)
masked_hor: tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.8258, 0.8068, 0.7790, 0.0597, 0.0768, 0.0656, 0.0729,
                      0.0631, 0.0751, 0.0690, 0.0702, 0.0745, 0.0664, 0.7362,
                      0.5820, 0.7186, 0.7131, 0.7080, 0.7742, 0.6944, 0.6962,
                      0.7275, 0.6815, 0.7494]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
tensor([[ 0.0251, -0.1619,  0.1143, -0.2009],
        [ 0.0251, -0.1619,  0.1143, -0.2009],
        [ 0.0251, -0.1619,  0.1143, -0.2009],
        ...,
        [ 0.0251, -0.1619,  0.1143, -0.2009],
        [ 0.0251, -0.1619,  0.1143, -0.2009],
        [ 0.0251, -0.1619,  0.1143, -0.2009]], grad_fn=<AddBackward0>)
gt_label_node tensor(2, dtype=torch.int32)
gt_label_node <class 'torch.Tensor'>
logit tensor(0.8566, grad_fn=<SelectBackward0>)
mask_without_small tensor([0.8258, 0.8068, 0.7790, 0.5968, 0.7678, 0.6556, 0.7286, 0.6311, 0.7508,
        0.6904, 0.7022, 0.7445, 0.6636, 0.7362, 0.5820, 0.7186, 0.7131, 0.7080,
        0.7742, 0.6944, 0.6962, 0.7275, 0.6815, 0.7494],
       grad_fn=<IndexBackward0>)
pred_loss tensor(0.1548, grad_fn=<MulBackward0>)
size_loss tensor(-0.3599, grad_fn=<MulBackward0>)
size_num_loss 0.72
epoch:  0 ; loss:  0.5149006843566895 ; pred:  tensor([0.0410, 0.0600, 0.8566, 0.0424], grad_fn=<SoftmaxBackward0>)
tensor([[-0.0749, -0.2619,  0.2143, -0.3009],
        [-0.0749, -0.2619,  0.2143, -0.3009],
        [-0.0749, -0.2619,  0.2143, -0.3009],
        ...,
        [-0.0749, -0.2619,  0.2143, -0.3009],
        [-0.0749, -0.2619,  0.2143, -0.3009],
        [-0.0749, -0.2619,  0.2143, -0.3009]], grad_fn=<AddBackward0>)
masked_hor: tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.8397, 0.8219, 0.7958, 0.0573, 0.0785, 0.0633, 0.0748,
                      0.0607, 0.0769, 0.0669, 0.0723, 0.0763, 0.0641, 0.7552,
                      0.5575, 0.7384, 0.7331, 0.6869, 0.7912, 0.6727, 0.6746,
                      0.7468, 0.6594, 0.7677]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
tensor([[-0.0749, -0.2619,  0.2143, -0.3009],
        [-0.0749, -0.2619,  0.2143, -0.3009],
        [-0.0749, -0.2619,  0.2143, -0.3009],
        ...,
        [-0.0749, -0.2619,  0.2143, -0.3009],
        [-0.0749, -0.2619,  0.2143, -0.3009],
        [-0.0749, -0.2619,  0.2143, -0.3009]], grad_fn=<AddBackward0>)
gt_label_node tensor(2, dtype=torch.int32)
gt_label_node <class 'torch.Tensor'>
logit tensor(0.9983, grad_fn=<SelectBackward0>)
mask_without_small tensor([0.8397, 0.8219, 0.7958, 0.5725, 0.7851, 0.6327, 0.7479, 0.6075, 0.7690,
        0.6686, 0.7226, 0.7631, 0.6409, 0.7552, 0.5575, 0.7384, 0.7331, 0.6869,
        0.7912, 0.6727, 0.6746, 0.7468, 0.6594, 0.7677],
       grad_fn=<IndexBackward0>)
pred_loss tensor(0.0017, grad_fn=<MulBackward0>)
size_loss tensor(-0.5880, grad_fn=<MulBackward0>)
size_num_loss 0.72
24
start training
tensor([[-0.1427, -0.3300,  0.2822, -0.3686],
        [-0.1427, -0.3300,  0.2822, -0.3686],
        [-0.1427, -0.3300,  0.2822, -0.3686],
        ...,
        [-0.1427, -0.3300,  0.2822, -0.3686],
        [-0.1427, -0.3300,  0.2822, -0.3686],
        [-0.1427, -0.3300,  0.2822, -0.3686]], grad_fn=<AddBackward0>)
masked_hor: tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.8258, 0.8068, 0.7790, 0.0597, 0.0768, 0.0656, 0.0729,
                      0.0631, 0.0751, 0.0690, 0.0702, 0.0745, 0.0664, 0.7362,
                      0.5820, 0.7186, 0.7131, 0.7080, 0.7742, 0.6944, 0.6962,
                      0.7275, 0.6815, 0.7494]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
tensor([[-0.1427, -0.3300,  0.2822, -0.3686],
        [-0.1427, -0.3300,  0.2822, -0.3686],
        [-0.1427, -0.3300,  0.2822, -0.3686],
        ...,
        [-0.1427, -0.3300,  0.2822, -0.3686],
        [-0.1427, -0.3300,  0.2822, -0.3686],
        [-0.1427, -0.3300,  0.2822, -0.3686]], grad_fn=<AddBackward0>)
gt_label_node tensor(2, dtype=torch.int32)
gt_label_node <class 'torch.Tensor'>
logit tensor(1.0000, grad_fn=<SelectBackward0>)
mask_without_small tensor([0.8258, 0.8068, 0.7790, 0.5968, 0.7678, 0.6556, 0.7286, 0.6311, 0.7508,
        0.6904, 0.7022, 0.7445, 0.6636, 0.7362, 0.5820, 0.7186, 0.7131, 0.7080,
        0.7742, 0.6944, 0.6962, 0.7275, 0.6815, 0.7494],
       grad_fn=<IndexBackward0>)
pred_loss tensor(1.9670e-05, grad_fn=<MulBackward0>)
size_loss tensor(-0.3599, grad_fn=<MulBackward0>)
size_num_loss 0.72
epoch:  0 ; loss:  0.360139936208725 ; pred:  tensor([4.9075e-06, 1.0693e-05, 9.9998e-01, 4.0310e-06],
       grad_fn=<SoftmaxBackward0>)
tensor([[-0.6416, -0.8295,  0.7819, -0.8674],
        [-0.6416, -0.8295,  0.7819, -0.8674],
        [-0.6416, -0.8295,  0.7819, -0.8674],
        ...,
        [-0.6416, -0.8295,  0.7819, -0.8674],
        [-0.6416, -0.8295,  0.7819, -0.8674],
        [-0.6416, -0.8295,  0.7819, -0.8674]], grad_fn=<AddBackward0>)
masked_hor: tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.8866, 0.8732, 0.8532, 0.0473, 0.0845, 0.0536, 0.0816,
                      0.0509, 0.0832, 0.0575, 0.0588, 0.0828, 0.0545, 0.8215,
                      0.4579, 0.8081, 0.6012, 0.5953, 0.8497, 0.5795, 0.5815,
                      0.8148, 0.5648, 0.8314]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
tensor([[-0.6416, -0.8295,  0.7819, -0.8674],
        [-0.6416, -0.8295,  0.7819, -0.8674],
        [-0.6416, -0.8295,  0.7819, -0.8674],
        ...,
        [-0.6416, -0.8295,  0.7819, -0.8674],
        [-0.6416, -0.8295,  0.7819, -0.8674],
        [-0.6416, -0.8295,  0.7819, -0.8674]], grad_fn=<AddBackward0>)
gt_label_node tensor(2, dtype=torch.int32)
gt_label_node <class 'torch.Tensor'>
logit tensor(1., grad_fn=<SelectBackward0>)
mask_without_small tensor([0.8866, 0.8732, 0.8532, 0.8450, 0.5358, 0.8157, 0.5092, 0.8324, 0.5749,
        0.5885, 0.8277, 0.5447, 0.8215, 0.8081, 0.6012, 0.5953, 0.8497, 0.5795,
        0.5815, 0.8148, 0.5648, 0.8314], grad_fn=<IndexBackward0>)
pred_loss tensor(-0., grad_fn=<MulBackward0>)
size_loss tensor(-1970.7267, grad_fn=<MulBackward0>)
size_num_loss 0.845
24
start training
tensor([[-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        ...,
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013]], grad_fn=<AddBackward0>)
masked_hor: tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.8258, 0.8068, 0.7790, 0.0597, 0.0768, 0.0656, 0.0729,
                      0.0631, 0.0751, 0.0690, 0.0702, 0.0745, 0.0664, 0.7362,
                      0.5820, 0.7186, 0.7131, 0.7080, 0.7742, 0.6944, 0.6962,
                      0.7275, 0.6815, 0.7494]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
tensor([[-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        ...,
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013]], grad_fn=<AddBackward0>)
gt_label_node tensor(2, dtype=torch.int32)
gt_label_node <class 'torch.Tensor'>
logit tensor(1., grad_fn=<SelectBackward0>)
mask_without_small tensor([0.8258, 0.8068, 0.7790, 0.5968, 0.7678, 0.6556, 0.7286, 0.6311, 0.7508,
        0.6904, 0.7022, 0.7445, 0.6636, 0.7362, 0.5820, 0.7186, 0.7131, 0.7080,
        0.7742, 0.6944, 0.6962, 0.7275, 0.6815, 0.7494],
       grad_fn=<IndexBackward0>)
pred_loss tensor(-0., grad_fn=<MulBackward0>)
size_loss tensor(-0.3599, grad_fn=<MulBackward0>)
size_num_loss 7.2
epoch:  0 ; loss:  6.8401198387146 ; pred:  tensor([0., 0., 1., 0.], grad_fn=<SoftmaxBackward0>)
tensor([[-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        ...,
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013]], grad_fn=<AddBackward0>)
masked_hor: tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.8329, 0.8145, 0.7875, 0.0585, 0.0777, 0.0644, 0.0738,
                      0.0619, 0.0760, 0.0680, 0.0692, 0.0754, 0.0652, 0.7458,
                      0.5698, 0.7286, 0.7028, 0.6976, 0.7828, 0.6836, 0.6855,
                      0.7373, 0.6706, 0.7587]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
tensor([[-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        ...,
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013]], grad_fn=<AddBackward0>)
gt_label_node tensor(2, dtype=torch.int32)
gt_label_node <class 'torch.Tensor'>
logit tensor(1., grad_fn=<SelectBackward0>)
mask_without_small tensor([0.8329, 0.8145, 0.7875, 0.5847, 0.7766, 0.6442, 0.7384, 0.6193, 0.7600,
        0.6796, 0.6916, 0.7539, 0.6523, 0.7458, 0.5698, 0.7286, 0.7028, 0.6976,
        0.7828, 0.6836, 0.6855, 0.7373, 0.6706, 0.7587],
       grad_fn=<IndexBackward0>)
pred_loss tensor(-0., grad_fn=<MulBackward0>)
size_loss tensor(-0.4658, grad_fn=<MulBackward0>)
size_num_loss 7.2
24
start training
tensor([[-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        ...,
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013]], grad_fn=<AddBackward0>)
masked_hor: tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.8258, 0.8068, 0.7790, 0.0597, 0.0768, 0.0656, 0.0729,
                      0.0631, 0.0751, 0.0690, 0.0702, 0.0745, 0.0664, 0.7362,
                      0.5820, 0.7186, 0.7131, 0.7080, 0.7742, 0.6944, 0.6962,
                      0.7275, 0.6815, 0.7494]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
tensor([[-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        ...,
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013]], grad_fn=<AddBackward0>)
gt_label_node tensor(2, dtype=torch.int32)
gt_label_node <class 'torch.Tensor'>
logit tensor(1., grad_fn=<SelectBackward0>)
mask_without_small tensor([0.8258, 0.8068, 0.7790, 0.5968, 0.7678, 0.6556, 0.7286, 0.6311, 0.7508,
        0.6904, 0.7022, 0.7445, 0.6636, 0.7362, 0.5820, 0.7186, 0.7131, 0.7080,
        0.7742, 0.6944, 0.6962, 0.7275, 0.6815, 0.7494],
       grad_fn=<IndexBackward0>)
pred_loss tensor(-0., grad_fn=<MulBackward0>)
size_loss tensor(-0.3599, grad_fn=<MulBackward0>)
size_num_loss 7.2
epoch:  0 ; loss:  6.8401198387146 ; pred:  tensor([0., 0., 1., 0.], grad_fn=<SoftmaxBackward0>)
tensor([[-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        ...,
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013]], grad_fn=<AddBackward0>)
masked_hor: tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.8397, 0.8219, 0.7958, 0.0573, 0.0785, 0.0633, 0.0748,
                      0.0607, 0.0769, 0.0669, 0.0681, 0.0763, 0.0641, 0.7552,
                      0.5575, 0.7384, 0.6922, 0.6869, 0.7912, 0.6727, 0.6746,
                      0.7468, 0.6594, 0.7677]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
tensor([[-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        ...,
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013]], grad_fn=<AddBackward0>)
gt_label_node tensor(2, dtype=torch.int32)
gt_label_node <class 'torch.Tensor'>
logit tensor(1., grad_fn=<SelectBackward0>)
mask_without_small tensor([0.8397, 0.8219, 0.7958, 0.5725, 0.7851, 0.6327, 0.7479, 0.6075, 0.7690,
        0.6686, 0.6808, 0.7631, 0.6409, 0.7552, 0.5575, 0.7384, 0.6922, 0.6869,
        0.7912, 0.6727, 0.6746, 0.7468, 0.6594, 0.7677],
       grad_fn=<IndexBackward0>)
pred_loss tensor(-0., grad_fn=<MulBackward0>)
size_loss tensor(-0.5922, grad_fn=<MulBackward0>)
size_num_loss 7.2
24
start training
tensor([[-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        ...,
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013]], grad_fn=<AddBackward0>)
masked_hor: tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.8258, 0.8068, 0.7790, 0.0597, 0.0768, 0.0656, 0.0729,
                      0.0631, 0.0751, 0.0690, 0.0702, 0.0745, 0.0664, 0.7362,
                      0.5820, 0.7186, 0.7131, 0.7080, 0.7742, 0.6944, 0.6962,
                      0.7275, 0.6815, 0.7494]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
tensor([[-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        ...,
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013]], grad_fn=<AddBackward0>)
gt_label_node tensor(2, dtype=torch.int32)
gt_label_node <class 'torch.Tensor'>
logit tensor(1., grad_fn=<SelectBackward0>)
mask_without_small tensor([0.8258, 0.8068, 0.7790, 0.5968, 0.7678, 0.6556, 0.7286, 0.6311, 0.7508,
        0.6904, 0.7022, 0.7445, 0.6636, 0.7362, 0.5820, 0.7186, 0.7131, 0.7080,
        0.7742, 0.6944, 0.6962, 0.7275, 0.6815, 0.7494],
       grad_fn=<IndexBackward0>)
pred_loss tensor(-0., grad_fn=<MulBackward0>)
size_loss tensor(-0.3599, grad_fn=<MulBackward0>)
size_num_loss 7.2
epoch:  0 ; loss:  6.8401198387146 ; pred:  tensor([0., 0., 1., 0.], grad_fn=<SoftmaxBackward0>)
tensor([[-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        ...,
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013]], grad_fn=<AddBackward0>)
masked_hor: tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.8866, 0.8732, 0.8532, 0.0473, 0.0845, 0.0536, 0.0816,
                      0.0509, 0.0832, 0.0575, 0.0588, 0.0828, 0.0545, 0.8215,
                      0.4579, 0.8081, 0.6012, 0.5953, 0.8497, 0.5795, 0.5815,
                      0.8148, 0.5648, 0.8314]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
tensor([[-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        ...,
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013]], grad_fn=<AddBackward0>)
gt_label_node tensor(2, dtype=torch.int32)
gt_label_node <class 'torch.Tensor'>
logit tensor(1., grad_fn=<SelectBackward0>)
mask_without_small tensor([0.8866, 0.8732, 0.8532, 0.8450, 0.5358, 0.8157, 0.5092, 0.8324, 0.5749,
        0.5885, 0.8277, 0.5447, 0.8215, 0.8081, 0.6012, 0.5953, 0.8497, 0.5795,
        0.5815, 0.8148, 0.5648, 0.8314], grad_fn=<IndexBackward0>)
pred_loss tensor(-0., grad_fn=<MulBackward0>)
size_loss tensor(-1970.7264, grad_fn=<MulBackward0>)
size_num_loss 8.450000000000001
24
start training
tensor([[-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        ...,
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013]], grad_fn=<AddBackward0>)
masked_hor: tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.8258, 0.8068, 0.7790, 0.0597, 0.0768, 0.0656, 0.0729,
                      0.0631, 0.0751, 0.0690, 0.0702, 0.0745, 0.0664, 0.7362,
                      0.5820, 0.7186, 0.7131, 0.7080, 0.7742, 0.6944, 0.6962,
                      0.7275, 0.6815, 0.7494]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
tensor([[-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        ...,
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013]], grad_fn=<AddBackward0>)
gt_label_node tensor(2, dtype=torch.int32)
gt_label_node <class 'torch.Tensor'>
logit tensor(1., grad_fn=<SelectBackward0>)
mask_without_small tensor([0.8258, 0.8068, 0.7790, 0.5968, 0.7678, 0.6556, 0.7286, 0.6311, 0.7508,
        0.6904, 0.7022, 0.7445, 0.6636, 0.7362, 0.5820, 0.7186, 0.7131, 0.7080,
        0.7742, 0.6944, 0.6962, 0.7275, 0.6815, 0.7494],
       grad_fn=<IndexBackward0>)
pred_loss tensor(-0., grad_fn=<MulBackward0>)
size_loss tensor(-0.3599, grad_fn=<MulBackward0>)
size_num_loss 72.0
epoch:  0 ; loss:  71.64012145996094 ; pred:  tensor([0., 0., 1., 0.], grad_fn=<SoftmaxBackward0>)
tensor([[-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        ...,
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013]], grad_fn=<AddBackward0>)
masked_hor: tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.8329, 0.8145, 0.7875, 0.0585, 0.0777, 0.0644, 0.0738,
                      0.0619, 0.0760, 0.0680, 0.0692, 0.0754, 0.0652, 0.7458,
                      0.5698, 0.7286, 0.7028, 0.6976, 0.7828, 0.6836, 0.6855,
                      0.7373, 0.6706, 0.7587]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
tensor([[-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        ...,
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013]], grad_fn=<AddBackward0>)
gt_label_node tensor(2, dtype=torch.int32)
gt_label_node <class 'torch.Tensor'>
logit tensor(1., grad_fn=<SelectBackward0>)
mask_without_small tensor([0.8329, 0.8145, 0.7875, 0.5847, 0.7766, 0.6442, 0.7384, 0.6193, 0.7600,
        0.6796, 0.6916, 0.7539, 0.6523, 0.7458, 0.5698, 0.7286, 0.7028, 0.6976,
        0.7828, 0.6836, 0.6855, 0.7373, 0.6706, 0.7587],
       grad_fn=<IndexBackward0>)
pred_loss tensor(-0., grad_fn=<MulBackward0>)
size_loss tensor(-0.4658, grad_fn=<MulBackward0>)
size_num_loss 72.0
24
start training
tensor([[-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        ...,
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013]], grad_fn=<AddBackward0>)
masked_hor: tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.8258, 0.8068, 0.7790, 0.0597, 0.0768, 0.0656, 0.0729,
                      0.0631, 0.0751, 0.0690, 0.0702, 0.0745, 0.0664, 0.7362,
                      0.5820, 0.7186, 0.7131, 0.7080, 0.7742, 0.6944, 0.6962,
                      0.7275, 0.6815, 0.7494]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
tensor([[-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        ...,
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013]], grad_fn=<AddBackward0>)
gt_label_node tensor(2, dtype=torch.int32)
gt_label_node <class 'torch.Tensor'>
logit tensor(1., grad_fn=<SelectBackward0>)
mask_without_small tensor([0.8258, 0.8068, 0.7790, 0.5968, 0.7678, 0.6556, 0.7286, 0.6311, 0.7508,
        0.6904, 0.7022, 0.7445, 0.6636, 0.7362, 0.5820, 0.7186, 0.7131, 0.7080,
        0.7742, 0.6944, 0.6962, 0.7275, 0.6815, 0.7494],
       grad_fn=<IndexBackward0>)
pred_loss tensor(-0., grad_fn=<MulBackward0>)
size_loss tensor(-0.3599, grad_fn=<MulBackward0>)
size_num_loss 72.0
epoch:  0 ; loss:  71.64012145996094 ; pred:  tensor([0., 0., 1., 0.], grad_fn=<SoftmaxBackward0>)
tensor([[-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        ...,
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013]], grad_fn=<AddBackward0>)
masked_hor: tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.8397, 0.8219, 0.7958, 0.0573, 0.0785, 0.0633, 0.0748,
                      0.0607, 0.0769, 0.0669, 0.0681, 0.0763, 0.0641, 0.7552,
                      0.5575, 0.7384, 0.6922, 0.6869, 0.7912, 0.6727, 0.6746,
                      0.7468, 0.6594, 0.7677]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
tensor([[-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        ...,
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013]], grad_fn=<AddBackward0>)
gt_label_node tensor(2, dtype=torch.int32)
gt_label_node <class 'torch.Tensor'>
logit tensor(1., grad_fn=<SelectBackward0>)
mask_without_small tensor([0.8397, 0.8219, 0.7958, 0.5725, 0.7851, 0.6327, 0.7479, 0.6075, 0.7690,
        0.6686, 0.6808, 0.7631, 0.6409, 0.7552, 0.5575, 0.7384, 0.6922, 0.6869,
        0.7912, 0.6727, 0.6746, 0.7468, 0.6594, 0.7677],
       grad_fn=<IndexBackward0>)
pred_loss tensor(-0., grad_fn=<MulBackward0>)
size_loss tensor(-0.5922, grad_fn=<MulBackward0>)
size_num_loss 72.0
24
start training
tensor([[-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        ...,
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013]], grad_fn=<AddBackward0>)
masked_hor: tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.8258, 0.8068, 0.7790, 0.0597, 0.0768, 0.0656, 0.0729,
                      0.0631, 0.0751, 0.0690, 0.0702, 0.0745, 0.0664, 0.7362,
                      0.5820, 0.7186, 0.7131, 0.7080, 0.7742, 0.6944, 0.6962,
                      0.7275, 0.6815, 0.7494]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
tensor([[-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        ...,
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013]], grad_fn=<AddBackward0>)
gt_label_node tensor(2, dtype=torch.int32)
gt_label_node <class 'torch.Tensor'>
logit tensor(1., grad_fn=<SelectBackward0>)
mask_without_small tensor([0.8258, 0.8068, 0.7790, 0.5968, 0.7678, 0.6556, 0.7286, 0.6311, 0.7508,
        0.6904, 0.7022, 0.7445, 0.6636, 0.7362, 0.5820, 0.7186, 0.7131, 0.7080,
        0.7742, 0.6944, 0.6962, 0.7275, 0.6815, 0.7494],
       grad_fn=<IndexBackward0>)
pred_loss tensor(-0., grad_fn=<MulBackward0>)
size_loss tensor(-0.3599, grad_fn=<MulBackward0>)
size_num_loss 72.0
epoch:  0 ; loss:  71.64012145996094 ; pred:  tensor([0., 0., 1., 0.], grad_fn=<SoftmaxBackward0>)
tensor([[-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        ...,
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013]], grad_fn=<AddBackward0>)
masked_hor: tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.8866, 0.8732, 0.8532, 0.0473, 0.0845, 0.0536, 0.0816,
                      0.0509, 0.0832, 0.0575, 0.0588, 0.0828, 0.0545, 0.8215,
                      0.4579, 0.8081, 0.6012, 0.5953, 0.8497, 0.5795, 0.5815,
                      0.8148, 0.5648, 0.8314]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
tensor([[-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        ...,
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013]], grad_fn=<AddBackward0>)
gt_label_node tensor(2, dtype=torch.int32)
gt_label_node <class 'torch.Tensor'>
logit tensor(1., grad_fn=<SelectBackward0>)
mask_without_small tensor([0.8866, 0.8732, 0.8532, 0.8450, 0.5358, 0.8157, 0.5092, 0.8324, 0.5749,
        0.5885, 0.8277, 0.5447, 0.8215, 0.8081, 0.6012, 0.5953, 0.8497, 0.5795,
        0.5815, 0.8148, 0.5648, 0.8314], grad_fn=<IndexBackward0>)
pred_loss tensor(-0., grad_fn=<MulBackward0>)
size_loss tensor(-1970.7264, grad_fn=<MulBackward0>)
size_num_loss 84.5
24
start training
tensor([[-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        ...,
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013]], grad_fn=<AddBackward0>)
masked_hor: tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.8258, 0.8068, 0.7790, 0.0597, 0.0768, 0.0656, 0.0729,
                      0.0631, 0.0751, 0.0690, 0.0702, 0.0745, 0.0664, 0.7362,
                      0.5820, 0.7186, 0.7131, 0.7080, 0.7742, 0.6944, 0.6962,
                      0.7275, 0.6815, 0.7494]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
tensor([[-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        ...,
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013]], grad_fn=<AddBackward0>)
gt_label_node tensor(2, dtype=torch.int32)
gt_label_node <class 'torch.Tensor'>
logit tensor(1., grad_fn=<SelectBackward0>)
mask_without_small tensor([0.8258, 0.8068, 0.7790, 0.5968, 0.7678, 0.6556, 0.7286, 0.6311, 0.7508,
        0.6904, 0.7022, 0.7445, 0.6636, 0.7362, 0.5820, 0.7186, 0.7131, 0.7080,
        0.7742, 0.6944, 0.6962, 0.7275, 0.6815, 0.7494],
       grad_fn=<IndexBackward0>)
pred_loss tensor(-0., grad_fn=<MulBackward0>)
size_loss tensor(-0.0360, grad_fn=<MulBackward0>)
size_num_loss 0.72
epoch:  0 ; loss:  0.6840120553970337 ; pred:  tensor([0., 0., 1., 0.], grad_fn=<SoftmaxBackward0>)
tensor([[-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        ...,
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013]], grad_fn=<AddBackward0>)
masked_hor: tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.8329, 0.8145, 0.7875, 0.0585, 0.0777, 0.0644, 0.0738,
                      0.0619, 0.0760, 0.0680, 0.0692, 0.0754, 0.0652, 0.7458,
                      0.5698, 0.7286, 0.7028, 0.6976, 0.7828, 0.6836, 0.6855,
                      0.7373, 0.6706, 0.7587]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
tensor([[-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        ...,
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013]], grad_fn=<AddBackward0>)
gt_label_node tensor(2, dtype=torch.int32)
gt_label_node <class 'torch.Tensor'>
logit tensor(1., grad_fn=<SelectBackward0>)
mask_without_small tensor([0.8329, 0.8145, 0.7875, 0.5847, 0.7766, 0.6442, 0.7384, 0.6193, 0.7600,
        0.6796, 0.6916, 0.7539, 0.6523, 0.7458, 0.5698, 0.7286, 0.7028, 0.6976,
        0.7828, 0.6836, 0.6855, 0.7373, 0.6706, 0.7587],
       grad_fn=<IndexBackward0>)
pred_loss tensor(-0., grad_fn=<MulBackward0>)
size_loss tensor(-0.0466, grad_fn=<MulBackward0>)
size_num_loss 0.72
24
start training
tensor([[-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        ...,
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013]], grad_fn=<AddBackward0>)
masked_hor: tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.8258, 0.8068, 0.7790, 0.0597, 0.0768, 0.0656, 0.0729,
                      0.0631, 0.0751, 0.0690, 0.0702, 0.0745, 0.0664, 0.7362,
                      0.5820, 0.7186, 0.7131, 0.7080, 0.7742, 0.6944, 0.6962,
                      0.7275, 0.6815, 0.7494]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
tensor([[-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        ...,
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013]], grad_fn=<AddBackward0>)
gt_label_node tensor(2, dtype=torch.int32)
gt_label_node <class 'torch.Tensor'>
logit tensor(1., grad_fn=<SelectBackward0>)
mask_without_small tensor([0.8258, 0.8068, 0.7790, 0.5968, 0.7678, 0.6556, 0.7286, 0.6311, 0.7508,
        0.6904, 0.7022, 0.7445, 0.6636, 0.7362, 0.5820, 0.7186, 0.7131, 0.7080,
        0.7742, 0.6944, 0.6962, 0.7275, 0.6815, 0.7494],
       grad_fn=<IndexBackward0>)
pred_loss tensor(-0., grad_fn=<MulBackward0>)
size_loss tensor(-0.0360, grad_fn=<MulBackward0>)
size_num_loss 0.72
epoch:  0 ; loss:  0.6840120553970337 ; pred:  tensor([0., 0., 1., 0.], grad_fn=<SoftmaxBackward0>)
tensor([[-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        ...,
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013]], grad_fn=<AddBackward0>)
masked_hor: tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.8397, 0.8219, 0.7958, 0.0573, 0.0785, 0.0633, 0.0748,
                      0.0607, 0.0769, 0.0669, 0.0681, 0.0763, 0.0641, 0.7552,
                      0.5575, 0.7384, 0.6922, 0.6869, 0.7912, 0.6727, 0.6746,
                      0.7468, 0.6594, 0.7677]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
tensor([[-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        ...,
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013]], grad_fn=<AddBackward0>)
gt_label_node tensor(2, dtype=torch.int32)
gt_label_node <class 'torch.Tensor'>
logit tensor(1., grad_fn=<SelectBackward0>)
mask_without_small tensor([0.8397, 0.8219, 0.7958, 0.5725, 0.7851, 0.6327, 0.7479, 0.6075, 0.7690,
        0.6686, 0.6808, 0.7631, 0.6409, 0.7552, 0.5575, 0.7384, 0.6922, 0.6869,
        0.7912, 0.6727, 0.6746, 0.7468, 0.6594, 0.7677],
       grad_fn=<IndexBackward0>)
pred_loss tensor(-0., grad_fn=<MulBackward0>)
size_loss tensor(-0.0592, grad_fn=<MulBackward0>)
size_num_loss 0.72
24
start training
tensor([[-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        ...,
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013]], grad_fn=<AddBackward0>)
masked_hor: tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.8258, 0.8068, 0.7790, 0.0597, 0.0768, 0.0656, 0.0729,
                      0.0631, 0.0751, 0.0690, 0.0702, 0.0745, 0.0664, 0.7362,
                      0.5820, 0.7186, 0.7131, 0.7080, 0.7742, 0.6944, 0.6962,
                      0.7275, 0.6815, 0.7494]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
tensor([[-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        ...,
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013]], grad_fn=<AddBackward0>)
gt_label_node tensor(2, dtype=torch.int32)
gt_label_node <class 'torch.Tensor'>
logit tensor(1., grad_fn=<SelectBackward0>)
mask_without_small tensor([0.8258, 0.8068, 0.7790, 0.5968, 0.7678, 0.6556, 0.7286, 0.6311, 0.7508,
        0.6904, 0.7022, 0.7445, 0.6636, 0.7362, 0.5820, 0.7186, 0.7131, 0.7080,
        0.7742, 0.6944, 0.6962, 0.7275, 0.6815, 0.7494],
       grad_fn=<IndexBackward0>)
pred_loss tensor(-0., grad_fn=<MulBackward0>)
size_loss tensor(-0.0360, grad_fn=<MulBackward0>)
size_num_loss 0.72
epoch:  0 ; loss:  0.6840120553970337 ; pred:  tensor([0., 0., 1., 0.], grad_fn=<SoftmaxBackward0>)
tensor([[-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        ...,
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013]], grad_fn=<AddBackward0>)
masked_hor: tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.8866, 0.8732, 0.8532, 0.0473, 0.0845, 0.0536, 0.0816,
                      0.0509, 0.0832, 0.0575, 0.0588, 0.0828, 0.0545, 0.8215,
                      0.4579, 0.8081, 0.6012, 0.5953, 0.8497, 0.5795, 0.5815,
                      0.8148, 0.5648, 0.8314]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
tensor([[-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        ...,
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013]], grad_fn=<AddBackward0>)
gt_label_node tensor(2, dtype=torch.int32)
gt_label_node <class 'torch.Tensor'>
logit tensor(1., grad_fn=<SelectBackward0>)
mask_without_small tensor([0.8866, 0.8732, 0.8532, 0.8450, 0.5358, 0.8157, 0.5092, 0.8324, 0.5749,
        0.5885, 0.8277, 0.5447, 0.8215, 0.8081, 0.6012, 0.5953, 0.8497, 0.5795,
        0.5815, 0.8148, 0.5648, 0.8314], grad_fn=<IndexBackward0>)
pred_loss tensor(-0., grad_fn=<MulBackward0>)
size_loss tensor(-197.0703, grad_fn=<MulBackward0>)
size_num_loss 0.845
24
start training
tensor([[-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        ...,
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013]], grad_fn=<AddBackward0>)
masked_hor: tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.8258, 0.8068, 0.7790, 0.0597, 0.0768, 0.0656, 0.0729,
                      0.0631, 0.0751, 0.0690, 0.0702, 0.0745, 0.0664, 0.7362,
                      0.5820, 0.7186, 0.7131, 0.7080, 0.7742, 0.6944, 0.6962,
                      0.7275, 0.6815, 0.7494]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
tensor([[-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        ...,
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013]], grad_fn=<AddBackward0>)
gt_label_node tensor(2, dtype=torch.int32)
gt_label_node <class 'torch.Tensor'>
logit tensor(1., grad_fn=<SelectBackward0>)
mask_without_small tensor([0.8258, 0.8068, 0.7790, 0.5968, 0.7678, 0.6556, 0.7286, 0.6311, 0.7508,
        0.6904, 0.7022, 0.7445, 0.6636, 0.7362, 0.5820, 0.7186, 0.7131, 0.7080,
        0.7742, 0.6944, 0.6962, 0.7275, 0.6815, 0.7494],
       grad_fn=<IndexBackward0>)
pred_loss tensor(-0., grad_fn=<MulBackward0>)
size_loss tensor(-0.0360, grad_fn=<MulBackward0>)
size_num_loss 7.2
epoch:  0 ; loss:  7.1640119552612305 ; pred:  tensor([0., 0., 1., 0.], grad_fn=<SoftmaxBackward0>)
tensor([[-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        ...,
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013]], grad_fn=<AddBackward0>)
masked_hor: tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.8329, 0.8145, 0.7875, 0.0585, 0.0777, 0.0644, 0.0738,
                      0.0619, 0.0760, 0.0680, 0.0692, 0.0754, 0.0652, 0.7458,
                      0.5698, 0.7286, 0.7028, 0.6976, 0.7828, 0.6836, 0.6855,
                      0.7373, 0.6706, 0.7587]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
tensor([[-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        ...,
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013]], grad_fn=<AddBackward0>)
gt_label_node tensor(2, dtype=torch.int32)
gt_label_node <class 'torch.Tensor'>
logit tensor(1., grad_fn=<SelectBackward0>)
mask_without_small tensor([0.8329, 0.8145, 0.7875, 0.5847, 0.7766, 0.6442, 0.7384, 0.6193, 0.7600,
        0.6796, 0.6916, 0.7539, 0.6523, 0.7458, 0.5698, 0.7286, 0.7028, 0.6976,
        0.7828, 0.6836, 0.6855, 0.7373, 0.6706, 0.7587],
       grad_fn=<IndexBackward0>)
pred_loss tensor(-0., grad_fn=<MulBackward0>)
size_loss tensor(-0.0466, grad_fn=<MulBackward0>)
size_num_loss 7.2
24
start training
tensor([[-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        ...,
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013]], grad_fn=<AddBackward0>)
masked_hor: tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.8258, 0.8068, 0.7790, 0.0597, 0.0768, 0.0656, 0.0729,
                      0.0631, 0.0751, 0.0690, 0.0702, 0.0745, 0.0664, 0.7362,
                      0.5820, 0.7186, 0.7131, 0.7080, 0.7742, 0.6944, 0.6962,
                      0.7275, 0.6815, 0.7494]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
tensor([[-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        ...,
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013]], grad_fn=<AddBackward0>)
gt_label_node tensor(2, dtype=torch.int32)
gt_label_node <class 'torch.Tensor'>
logit tensor(1., grad_fn=<SelectBackward0>)
mask_without_small tensor([0.8258, 0.8068, 0.7790, 0.5968, 0.7678, 0.6556, 0.7286, 0.6311, 0.7508,
        0.6904, 0.7022, 0.7445, 0.6636, 0.7362, 0.5820, 0.7186, 0.7131, 0.7080,
        0.7742, 0.6944, 0.6962, 0.7275, 0.6815, 0.7494],
       grad_fn=<IndexBackward0>)
pred_loss tensor(-0., grad_fn=<MulBackward0>)
size_loss tensor(-0.0360, grad_fn=<MulBackward0>)
size_num_loss 7.2
epoch:  0 ; loss:  7.1640119552612305 ; pred:  tensor([0., 0., 1., 0.], grad_fn=<SoftmaxBackward0>)
tensor([[-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        ...,
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013]], grad_fn=<AddBackward0>)
masked_hor: tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.8397, 0.8219, 0.7958, 0.0573, 0.0785, 0.0633, 0.0748,
                      0.0607, 0.0769, 0.0669, 0.0681, 0.0763, 0.0641, 0.7552,
                      0.5575, 0.7384, 0.6922, 0.6869, 0.7912, 0.6727, 0.6746,
                      0.7468, 0.6594, 0.7677]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
tensor([[-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        ...,
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013]], grad_fn=<AddBackward0>)
gt_label_node tensor(2, dtype=torch.int32)
gt_label_node <class 'torch.Tensor'>
logit tensor(1., grad_fn=<SelectBackward0>)
mask_without_small tensor([0.8397, 0.8219, 0.7958, 0.5725, 0.7851, 0.6327, 0.7479, 0.6075, 0.7690,
        0.6686, 0.6808, 0.7631, 0.6409, 0.7552, 0.5575, 0.7384, 0.6922, 0.6869,
        0.7912, 0.6727, 0.6746, 0.7468, 0.6594, 0.7677],
       grad_fn=<IndexBackward0>)
pred_loss tensor(-0., grad_fn=<MulBackward0>)
size_loss tensor(-0.0592, grad_fn=<MulBackward0>)
size_num_loss 7.2
24
start training
tensor([[-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        ...,
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013]], grad_fn=<AddBackward0>)
masked_hor: tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.8258, 0.8068, 0.7790, 0.0597, 0.0768, 0.0656, 0.0729,
                      0.0631, 0.0751, 0.0690, 0.0702, 0.0745, 0.0664, 0.7362,
                      0.5820, 0.7186, 0.7131, 0.7080, 0.7742, 0.6944, 0.6962,
                      0.7275, 0.6815, 0.7494]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
tensor([[-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        ...,
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013]], grad_fn=<AddBackward0>)
gt_label_node tensor(2, dtype=torch.int32)
gt_label_node <class 'torch.Tensor'>
logit tensor(1., grad_fn=<SelectBackward0>)
mask_without_small tensor([0.8258, 0.8068, 0.7790, 0.5968, 0.7678, 0.6556, 0.7286, 0.6311, 0.7508,
        0.6904, 0.7022, 0.7445, 0.6636, 0.7362, 0.5820, 0.7186, 0.7131, 0.7080,
        0.7742, 0.6944, 0.6962, 0.7275, 0.6815, 0.7494],
       grad_fn=<IndexBackward0>)
pred_loss tensor(-0., grad_fn=<MulBackward0>)
size_loss tensor(-0.0360, grad_fn=<MulBackward0>)
size_num_loss 7.2
epoch:  0 ; loss:  7.1640119552612305 ; pred:  tensor([0., 0., 1., 0.], grad_fn=<SoftmaxBackward0>)
tensor([[-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        ...,
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013]], grad_fn=<AddBackward0>)
masked_hor: tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.8866, 0.8732, 0.8532, 0.0473, 0.0845, 0.0536, 0.0816,
                      0.0509, 0.0832, 0.0575, 0.0588, 0.0828, 0.0545, 0.8215,
                      0.4579, 0.8081, 0.6012, 0.5953, 0.8497, 0.5795, 0.5815,
                      0.8148, 0.5648, 0.8314]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
tensor([[-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        ...,
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013]], grad_fn=<AddBackward0>)
gt_label_node tensor(2, dtype=torch.int32)
gt_label_node <class 'torch.Tensor'>
logit tensor(1., grad_fn=<SelectBackward0>)
mask_without_small tensor([0.8866, 0.8732, 0.8532, 0.8450, 0.5358, 0.8157, 0.5092, 0.8324, 0.5749,
        0.5885, 0.8277, 0.5447, 0.8215, 0.8081, 0.6012, 0.5953, 0.8497, 0.5795,
        0.5815, 0.8148, 0.5648, 0.8314], grad_fn=<IndexBackward0>)
pred_loss tensor(-0., grad_fn=<MulBackward0>)
size_loss tensor(-197.0703, grad_fn=<MulBackward0>)
size_num_loss 8.450000000000001
24
start training
tensor([[-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        ...,
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013]], grad_fn=<AddBackward0>)
masked_hor: tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.8258, 0.8068, 0.7790, 0.0597, 0.0768, 0.0656, 0.0729,
                      0.0631, 0.0751, 0.0690, 0.0702, 0.0745, 0.0664, 0.7362,
                      0.5820, 0.7186, 0.7131, 0.7080, 0.7742, 0.6944, 0.6962,
                      0.7275, 0.6815, 0.7494]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
tensor([[-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        ...,
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013]], grad_fn=<AddBackward0>)
gt_label_node tensor(2, dtype=torch.int32)
gt_label_node <class 'torch.Tensor'>
logit tensor(1., grad_fn=<SelectBackward0>)
mask_without_small tensor([0.8258, 0.8068, 0.7790, 0.5968, 0.7678, 0.6556, 0.7286, 0.6311, 0.7508,
        0.6904, 0.7022, 0.7445, 0.6636, 0.7362, 0.5820, 0.7186, 0.7131, 0.7080,
        0.7742, 0.6944, 0.6962, 0.7275, 0.6815, 0.7494],
       grad_fn=<IndexBackward0>)
pred_loss tensor(-0., grad_fn=<MulBackward0>)
size_loss tensor(-0.0360, grad_fn=<MulBackward0>)
size_num_loss 72.0
epoch:  0 ; loss:  71.9640121459961 ; pred:  tensor([0., 0., 1., 0.], grad_fn=<SoftmaxBackward0>)
tensor([[-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        ...,
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013]], grad_fn=<AddBackward0>)
masked_hor: tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.8329, 0.8145, 0.7875, 0.0585, 0.0777, 0.0644, 0.0738,
                      0.0619, 0.0760, 0.0680, 0.0692, 0.0754, 0.0652, 0.7458,
                      0.5698, 0.7286, 0.7028, 0.6976, 0.7828, 0.6836, 0.6855,
                      0.7373, 0.6706, 0.7587]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
tensor([[-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        ...,
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013]], grad_fn=<AddBackward0>)
gt_label_node tensor(2, dtype=torch.int32)
gt_label_node <class 'torch.Tensor'>
logit tensor(1., grad_fn=<SelectBackward0>)
mask_without_small tensor([0.8329, 0.8145, 0.7875, 0.5847, 0.7766, 0.6442, 0.7384, 0.6193, 0.7600,
        0.6796, 0.6916, 0.7539, 0.6523, 0.7458, 0.5698, 0.7286, 0.7028, 0.6976,
        0.7828, 0.6836, 0.6855, 0.7373, 0.6706, 0.7587],
       grad_fn=<IndexBackward0>)
pred_loss tensor(-0., grad_fn=<MulBackward0>)
size_loss tensor(-0.0466, grad_fn=<MulBackward0>)
size_num_loss 72.0
24
start training
tensor([[-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        ...,
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013]], grad_fn=<AddBackward0>)
masked_hor: tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.8258, 0.8068, 0.7790, 0.0597, 0.0768, 0.0656, 0.0729,
                      0.0631, 0.0751, 0.0690, 0.0702, 0.0745, 0.0664, 0.7362,
                      0.5820, 0.7186, 0.7131, 0.7080, 0.7742, 0.6944, 0.6962,
                      0.7275, 0.6815, 0.7494]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
tensor([[-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        ...,
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013]], grad_fn=<AddBackward0>)
gt_label_node tensor(2, dtype=torch.int32)
gt_label_node <class 'torch.Tensor'>
logit tensor(1., grad_fn=<SelectBackward0>)
mask_without_small tensor([0.8258, 0.8068, 0.7790, 0.5968, 0.7678, 0.6556, 0.7286, 0.6311, 0.7508,
        0.6904, 0.7022, 0.7445, 0.6636, 0.7362, 0.5820, 0.7186, 0.7131, 0.7080,
        0.7742, 0.6944, 0.6962, 0.7275, 0.6815, 0.7494],
       grad_fn=<IndexBackward0>)
pred_loss tensor(-0., grad_fn=<MulBackward0>)
size_loss tensor(-0.0360, grad_fn=<MulBackward0>)
size_num_loss 72.0
epoch:  0 ; loss:  71.9640121459961 ; pred:  tensor([0., 0., 1., 0.], grad_fn=<SoftmaxBackward0>)
tensor([[-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        ...,
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013]], grad_fn=<AddBackward0>)
masked_hor: tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.8397, 0.8219, 0.7958, 0.0573, 0.0785, 0.0633, 0.0748,
                      0.0607, 0.0769, 0.0669, 0.0681, 0.0763, 0.0641, 0.7552,
                      0.5575, 0.7384, 0.6922, 0.6869, 0.7912, 0.6727, 0.6746,
                      0.7468, 0.6594, 0.7677]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
tensor([[-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        ...,
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013]], grad_fn=<AddBackward0>)
gt_label_node tensor(2, dtype=torch.int32)
gt_label_node <class 'torch.Tensor'>
logit tensor(1., grad_fn=<SelectBackward0>)
mask_without_small tensor([0.8397, 0.8219, 0.7958, 0.5725, 0.7851, 0.6327, 0.7479, 0.6075, 0.7690,
        0.6686, 0.6808, 0.7631, 0.6409, 0.7552, 0.5575, 0.7384, 0.6922, 0.6869,
        0.7912, 0.6727, 0.6746, 0.7468, 0.6594, 0.7677],
       grad_fn=<IndexBackward0>)
pred_loss tensor(-0., grad_fn=<MulBackward0>)
size_loss tensor(-0.0592, grad_fn=<MulBackward0>)
size_num_loss 72.0
24
start training
tensor([[-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        ...,
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013]], grad_fn=<AddBackward0>)
masked_hor: tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.8258, 0.8068, 0.7790, 0.0597, 0.0768, 0.0656, 0.0729,
                      0.0631, 0.0751, 0.0690, 0.0702, 0.0745, 0.0664, 0.7362,
                      0.5820, 0.7186, 0.7131, 0.7080, 0.7742, 0.6944, 0.6962,
                      0.7275, 0.6815, 0.7494]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
tensor([[-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        ...,
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013]], grad_fn=<AddBackward0>)
gt_label_node tensor(2, dtype=torch.int32)
gt_label_node <class 'torch.Tensor'>
logit tensor(1., grad_fn=<SelectBackward0>)
mask_without_small tensor([0.8258, 0.8068, 0.7790, 0.5968, 0.7678, 0.6556, 0.7286, 0.6311, 0.7508,
        0.6904, 0.7022, 0.7445, 0.6636, 0.7362, 0.5820, 0.7186, 0.7131, 0.7080,
        0.7742, 0.6944, 0.6962, 0.7275, 0.6815, 0.7494],
       grad_fn=<IndexBackward0>)
pred_loss tensor(-0., grad_fn=<MulBackward0>)
size_loss tensor(-0.0360, grad_fn=<MulBackward0>)
size_num_loss 72.0
epoch:  0 ; loss:  71.9640121459961 ; pred:  tensor([0., 0., 1., 0.], grad_fn=<SoftmaxBackward0>)
tensor([[-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        ...,
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013]], grad_fn=<AddBackward0>)
masked_hor: tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.8866, 0.8732, 0.8532, 0.0473, 0.0845, 0.0536, 0.0816,
                      0.0509, 0.0832, 0.0575, 0.0588, 0.0828, 0.0545, 0.8215,
                      0.4579, 0.8081, 0.6012, 0.5953, 0.8497, 0.5795, 0.5815,
                      0.8148, 0.5648, 0.8314]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
tensor([[-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        ...,
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013]], grad_fn=<AddBackward0>)
gt_label_node tensor(2, dtype=torch.int32)
gt_label_node <class 'torch.Tensor'>
logit tensor(1., grad_fn=<SelectBackward0>)
mask_without_small tensor([0.8866, 0.8732, 0.8532, 0.8450, 0.5358, 0.8157, 0.5092, 0.8324, 0.5749,
        0.5885, 0.8277, 0.5447, 0.8215, 0.8081, 0.6012, 0.5953, 0.8497, 0.5795,
        0.5815, 0.8148, 0.5648, 0.8314], grad_fn=<IndexBackward0>)
pred_loss tensor(-0., grad_fn=<MulBackward0>)
size_loss tensor(-197.0703, grad_fn=<MulBackward0>)
size_num_loss 84.5
24
start training
tensor([[-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        ...,
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013]], grad_fn=<AddBackward0>)
masked_hor: tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.8258, 0.8068, 0.7790, 0.0597, 0.0768, 0.0656, 0.0729,
                      0.0631, 0.0751, 0.0690, 0.0702, 0.0745, 0.0664, 0.7362,
                      0.5820, 0.7186, 0.7131, 0.7080, 0.7742, 0.6944, 0.6962,
                      0.7275, 0.6815, 0.7494]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
tensor([[-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        ...,
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013]], grad_fn=<AddBackward0>)
gt_label_node tensor(2, dtype=torch.int32)
gt_label_node <class 'torch.Tensor'>
logit tensor(1., grad_fn=<SelectBackward0>)
mask_without_small tensor([0.8258, 0.8068, 0.7790, 0.5968, 0.7678, 0.6556, 0.7286, 0.6311, 0.7508,
        0.6904, 0.7022, 0.7445, 0.6636, 0.7362, 0.5820, 0.7186, 0.7131, 0.7080,
        0.7742, 0.6944, 0.6962, 0.7275, 0.6815, 0.7494],
       grad_fn=<IndexBackward0>)
pred_loss tensor(-0., grad_fn=<MulBackward0>)
size_loss tensor(-0.0036, grad_fn=<MulBackward0>)
size_num_loss 0.72
epoch:  0 ; loss:  0.716401219367981 ; pred:  tensor([0., 0., 1., 0.], grad_fn=<SoftmaxBackward0>)
tensor([[-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        ...,
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013]], grad_fn=<AddBackward0>)
masked_hor: tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.8329, 0.8145, 0.7875, 0.0585, 0.0777, 0.0644, 0.0738,
                      0.0619, 0.0760, 0.0680, 0.0692, 0.0754, 0.0652, 0.7458,
                      0.5698, 0.7286, 0.7028, 0.6976, 0.7828, 0.6836, 0.6855,
                      0.7373, 0.6706, 0.7587]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
tensor([[-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        ...,
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013]], grad_fn=<AddBackward0>)
gt_label_node tensor(2, dtype=torch.int32)
gt_label_node <class 'torch.Tensor'>
logit tensor(1., grad_fn=<SelectBackward0>)
mask_without_small tensor([0.8329, 0.8145, 0.7875, 0.5847, 0.7766, 0.6442, 0.7384, 0.6193, 0.7600,
        0.6796, 0.6916, 0.7539, 0.6523, 0.7458, 0.5698, 0.7286, 0.7028, 0.6976,
        0.7828, 0.6836, 0.6855, 0.7373, 0.6706, 0.7587],
       grad_fn=<IndexBackward0>)
pred_loss tensor(-0., grad_fn=<MulBackward0>)
size_loss tensor(-0.0047, grad_fn=<MulBackward0>)
size_num_loss 0.72
24
start training
tensor([[-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        ...,
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013]], grad_fn=<AddBackward0>)
masked_hor: tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.8258, 0.8068, 0.7790, 0.0597, 0.0768, 0.0656, 0.0729,
                      0.0631, 0.0751, 0.0690, 0.0702, 0.0745, 0.0664, 0.7362,
                      0.5820, 0.7186, 0.7131, 0.7080, 0.7742, 0.6944, 0.6962,
                      0.7275, 0.6815, 0.7494]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
tensor([[-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        ...,
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013]], grad_fn=<AddBackward0>)
gt_label_node tensor(2, dtype=torch.int32)
gt_label_node <class 'torch.Tensor'>
logit tensor(1., grad_fn=<SelectBackward0>)
mask_without_small tensor([0.8258, 0.8068, 0.7790, 0.5968, 0.7678, 0.6556, 0.7286, 0.6311, 0.7508,
        0.6904, 0.7022, 0.7445, 0.6636, 0.7362, 0.5820, 0.7186, 0.7131, 0.7080,
        0.7742, 0.6944, 0.6962, 0.7275, 0.6815, 0.7494],
       grad_fn=<IndexBackward0>)
pred_loss tensor(-0., grad_fn=<MulBackward0>)
size_loss tensor(-0.0036, grad_fn=<MulBackward0>)
size_num_loss 0.72
epoch:  0 ; loss:  0.716401219367981 ; pred:  tensor([0., 0., 1., 0.], grad_fn=<SoftmaxBackward0>)
tensor([[-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        ...,
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013]], grad_fn=<AddBackward0>)
masked_hor: tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.8397, 0.8219, 0.7958, 0.0573, 0.0785, 0.0633, 0.0748,
                      0.0607, 0.0769, 0.0669, 0.0681, 0.0763, 0.0641, 0.7552,
                      0.5575, 0.7383, 0.6923, 0.6869, 0.7912, 0.6727, 0.6746,
                      0.7468, 0.6594, 0.7677]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
tensor([[-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        ...,
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013]], grad_fn=<AddBackward0>)
gt_label_node tensor(2, dtype=torch.int32)
gt_label_node <class 'torch.Tensor'>
logit tensor(1., grad_fn=<SelectBackward0>)
mask_without_small tensor([0.8397, 0.8219, 0.7958, 0.5725, 0.7851, 0.6327, 0.7479, 0.6075, 0.7690,
        0.6686, 0.6808, 0.7631, 0.6409, 0.7552, 0.5575, 0.7383, 0.6923, 0.6869,
        0.7912, 0.6727, 0.6746, 0.7468, 0.6594, 0.7677],
       grad_fn=<IndexBackward0>)
pred_loss tensor(-0., grad_fn=<MulBackward0>)
size_loss tensor(-0.0059, grad_fn=<MulBackward0>)
size_num_loss 0.72
24
start training
tensor([[-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        ...,
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013]], grad_fn=<AddBackward0>)
masked_hor: tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.8258, 0.8068, 0.7790, 0.0597, 0.0768, 0.0656, 0.0729,
                      0.0631, 0.0751, 0.0690, 0.0702, 0.0745, 0.0664, 0.7362,
                      0.5820, 0.7186, 0.7131, 0.7080, 0.7742, 0.6944, 0.6962,
                      0.7275, 0.6815, 0.7494]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
tensor([[-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        ...,
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013]], grad_fn=<AddBackward0>)
gt_label_node tensor(2, dtype=torch.int32)
gt_label_node <class 'torch.Tensor'>
logit tensor(1., grad_fn=<SelectBackward0>)
mask_without_small tensor([0.8258, 0.8068, 0.7790, 0.5968, 0.7678, 0.6556, 0.7286, 0.6311, 0.7508,
        0.6904, 0.7022, 0.7445, 0.6636, 0.7362, 0.5820, 0.7186, 0.7131, 0.7080,
        0.7742, 0.6944, 0.6962, 0.7275, 0.6815, 0.7494],
       grad_fn=<IndexBackward0>)
pred_loss tensor(-0., grad_fn=<MulBackward0>)
size_loss tensor(-0.0036, grad_fn=<MulBackward0>)
size_num_loss 0.72
epoch:  0 ; loss:  0.716401219367981 ; pred:  tensor([0., 0., 1., 0.], grad_fn=<SoftmaxBackward0>)
tensor([[-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        ...,
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013]], grad_fn=<AddBackward0>)
masked_hor: tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.8866, 0.8732, 0.8532, 0.0473, 0.0845, 0.0536, 0.0816,
                      0.0509, 0.0832, 0.0575, 0.0588, 0.0828, 0.0545, 0.8215,
                      0.4579, 0.8080, 0.6014, 0.5953, 0.8497, 0.5795, 0.5815,
                      0.8148, 0.5648, 0.8314]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
tensor([[-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        ...,
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013]], grad_fn=<AddBackward0>)
gt_label_node tensor(2, dtype=torch.int32)
gt_label_node <class 'torch.Tensor'>
logit tensor(1., grad_fn=<SelectBackward0>)
mask_without_small tensor([0.8866, 0.8732, 0.8532, 0.8450, 0.5358, 0.8157, 0.5092, 0.8324, 0.5749,
        0.5885, 0.8277, 0.5447, 0.8215, 0.8080, 0.6014, 0.5953, 0.8497, 0.5795,
        0.5815, 0.8148, 0.5648, 0.8314], grad_fn=<IndexBackward0>)
pred_loss tensor(-0., grad_fn=<MulBackward0>)
size_loss tensor(-19.7047, grad_fn=<MulBackward0>)
size_num_loss 0.845
24
start training
tensor([[-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        ...,
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013]], grad_fn=<AddBackward0>)
masked_hor: tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.8258, 0.8068, 0.7790, 0.0597, 0.0768, 0.0656, 0.0729,
                      0.0631, 0.0751, 0.0690, 0.0702, 0.0745, 0.0664, 0.7362,
                      0.5820, 0.7186, 0.7131, 0.7080, 0.7742, 0.6944, 0.6962,
                      0.7275, 0.6815, 0.7494]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
tensor([[-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        ...,
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013]], grad_fn=<AddBackward0>)
gt_label_node tensor(2, dtype=torch.int32)
gt_label_node <class 'torch.Tensor'>
logit tensor(1., grad_fn=<SelectBackward0>)
mask_without_small tensor([0.8258, 0.8068, 0.7790, 0.5968, 0.7678, 0.6556, 0.7286, 0.6311, 0.7508,
        0.6904, 0.7022, 0.7445, 0.6636, 0.7362, 0.5820, 0.7186, 0.7131, 0.7080,
        0.7742, 0.6944, 0.6962, 0.7275, 0.6815, 0.7494],
       grad_fn=<IndexBackward0>)
pred_loss tensor(-0., grad_fn=<MulBackward0>)
size_loss tensor(-0.0036, grad_fn=<MulBackward0>)
size_num_loss 7.2
epoch:  0 ; loss:  7.196401119232178 ; pred:  tensor([0., 0., 1., 0.], grad_fn=<SoftmaxBackward0>)
tensor([[-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        ...,
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013]], grad_fn=<AddBackward0>)
masked_hor: tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.8329, 0.8145, 0.7875, 0.0585, 0.0777, 0.0644, 0.0738,
                      0.0619, 0.0760, 0.0680, 0.0692, 0.0754, 0.0652, 0.7458,
                      0.5698, 0.7286, 0.7028, 0.6976, 0.7828, 0.6836, 0.6855,
                      0.7373, 0.6706, 0.7587]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
tensor([[-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        ...,
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013]], grad_fn=<AddBackward0>)
gt_label_node tensor(2, dtype=torch.int32)
gt_label_node <class 'torch.Tensor'>
logit tensor(1., grad_fn=<SelectBackward0>)
mask_without_small tensor([0.8329, 0.8145, 0.7875, 0.5847, 0.7766, 0.6442, 0.7384, 0.6193, 0.7600,
        0.6796, 0.6916, 0.7539, 0.6523, 0.7458, 0.5698, 0.7286, 0.7028, 0.6976,
        0.7828, 0.6836, 0.6855, 0.7373, 0.6706, 0.7587],
       grad_fn=<IndexBackward0>)
pred_loss tensor(-0., grad_fn=<MulBackward0>)
size_loss tensor(-0.0047, grad_fn=<MulBackward0>)
size_num_loss 7.2
24
start training
tensor([[-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        ...,
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013]], grad_fn=<AddBackward0>)
masked_hor: tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.8258, 0.8068, 0.7790, 0.0597, 0.0768, 0.0656, 0.0729,
                      0.0631, 0.0751, 0.0690, 0.0702, 0.0745, 0.0664, 0.7362,
                      0.5820, 0.7186, 0.7131, 0.7080, 0.7742, 0.6944, 0.6962,
                      0.7275, 0.6815, 0.7494]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
tensor([[-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        ...,
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013]], grad_fn=<AddBackward0>)
gt_label_node tensor(2, dtype=torch.int32)
gt_label_node <class 'torch.Tensor'>
logit tensor(1., grad_fn=<SelectBackward0>)
mask_without_small tensor([0.8258, 0.8068, 0.7790, 0.5968, 0.7678, 0.6556, 0.7286, 0.6311, 0.7508,
        0.6904, 0.7022, 0.7445, 0.6636, 0.7362, 0.5820, 0.7186, 0.7131, 0.7080,
        0.7742, 0.6944, 0.6962, 0.7275, 0.6815, 0.7494],
       grad_fn=<IndexBackward0>)
pred_loss tensor(-0., grad_fn=<MulBackward0>)
size_loss tensor(-0.0036, grad_fn=<MulBackward0>)
size_num_loss 7.2
epoch:  0 ; loss:  7.196401119232178 ; pred:  tensor([0., 0., 1., 0.], grad_fn=<SoftmaxBackward0>)
tensor([[-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        ...,
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013]], grad_fn=<AddBackward0>)
masked_hor: tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.8397, 0.8219, 0.7958, 0.0573, 0.0785, 0.0633, 0.0748,
                      0.0607, 0.0769, 0.0669, 0.0681, 0.0763, 0.0641, 0.7552,
                      0.5575, 0.7383, 0.6923, 0.6869, 0.7912, 0.6727, 0.6746,
                      0.7468, 0.6594, 0.7677]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
tensor([[-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        ...,
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013]], grad_fn=<AddBackward0>)
gt_label_node tensor(2, dtype=torch.int32)
gt_label_node <class 'torch.Tensor'>
logit tensor(1., grad_fn=<SelectBackward0>)
mask_without_small tensor([0.8397, 0.8219, 0.7958, 0.5725, 0.7851, 0.6327, 0.7479, 0.6075, 0.7690,
        0.6686, 0.6808, 0.7631, 0.6409, 0.7552, 0.5575, 0.7383, 0.6923, 0.6869,
        0.7912, 0.6727, 0.6746, 0.7468, 0.6594, 0.7677],
       grad_fn=<IndexBackward0>)
pred_loss tensor(-0., grad_fn=<MulBackward0>)
size_loss tensor(-0.0059, grad_fn=<MulBackward0>)
size_num_loss 7.2
24
start training
tensor([[-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        ...,
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013]], grad_fn=<AddBackward0>)
masked_hor: tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.8258, 0.8068, 0.7790, 0.0597, 0.0768, 0.0656, 0.0729,
                      0.0631, 0.0751, 0.0690, 0.0702, 0.0745, 0.0664, 0.7362,
                      0.5820, 0.7186, 0.7131, 0.7080, 0.7742, 0.6944, 0.6962,
                      0.7275, 0.6815, 0.7494]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
tensor([[-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        ...,
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013]], grad_fn=<AddBackward0>)
gt_label_node tensor(2, dtype=torch.int32)
gt_label_node <class 'torch.Tensor'>
logit tensor(1., grad_fn=<SelectBackward0>)
mask_without_small tensor([0.8258, 0.8068, 0.7790, 0.5968, 0.7678, 0.6556, 0.7286, 0.6311, 0.7508,
        0.6904, 0.7022, 0.7445, 0.6636, 0.7362, 0.5820, 0.7186, 0.7131, 0.7080,
        0.7742, 0.6944, 0.6962, 0.7275, 0.6815, 0.7494],
       grad_fn=<IndexBackward0>)
pred_loss tensor(-0., grad_fn=<MulBackward0>)
size_loss tensor(-0.0036, grad_fn=<MulBackward0>)
size_num_loss 7.2
epoch:  0 ; loss:  7.196401119232178 ; pred:  tensor([0., 0., 1., 0.], grad_fn=<SoftmaxBackward0>)
tensor([[-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        ...,
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013]], grad_fn=<AddBackward0>)
masked_hor: tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.8866, 0.8732, 0.8532, 0.0473, 0.0845, 0.0536, 0.0816,
                      0.0509, 0.0832, 0.0575, 0.0588, 0.0828, 0.0545, 0.8215,
                      0.4579, 0.8080, 0.6014, 0.5953, 0.8497, 0.5795, 0.5815,
                      0.8148, 0.5648, 0.8314]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
tensor([[-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        ...,
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013]], grad_fn=<AddBackward0>)
gt_label_node tensor(2, dtype=torch.int32)
gt_label_node <class 'torch.Tensor'>
logit tensor(1., grad_fn=<SelectBackward0>)
mask_without_small tensor([0.8866, 0.8732, 0.8532, 0.8450, 0.5358, 0.8157, 0.5092, 0.8324, 0.5749,
        0.5885, 0.8277, 0.5447, 0.8215, 0.8080, 0.6014, 0.5953, 0.8497, 0.5795,
        0.5815, 0.8148, 0.5648, 0.8314], grad_fn=<IndexBackward0>)
pred_loss tensor(-0., grad_fn=<MulBackward0>)
size_loss tensor(-19.7047, grad_fn=<MulBackward0>)
size_num_loss 8.450000000000001
24
start training
tensor([[-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        ...,
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013]], grad_fn=<AddBackward0>)
masked_hor: tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.8258, 0.8068, 0.7790, 0.0597, 0.0768, 0.0656, 0.0729,
                      0.0631, 0.0751, 0.0690, 0.0702, 0.0745, 0.0664, 0.7362,
                      0.5820, 0.7186, 0.7131, 0.7080, 0.7742, 0.6944, 0.6962,
                      0.7275, 0.6815, 0.7494]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
tensor([[-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        ...,
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013]], grad_fn=<AddBackward0>)
gt_label_node tensor(2, dtype=torch.int32)
gt_label_node <class 'torch.Tensor'>
logit tensor(1., grad_fn=<SelectBackward0>)
mask_without_small tensor([0.8258, 0.8068, 0.7790, 0.5968, 0.7678, 0.6556, 0.7286, 0.6311, 0.7508,
        0.6904, 0.7022, 0.7445, 0.6636, 0.7362, 0.5820, 0.7186, 0.7131, 0.7080,
        0.7742, 0.6944, 0.6962, 0.7275, 0.6815, 0.7494],
       grad_fn=<IndexBackward0>)
pred_loss tensor(-0., grad_fn=<MulBackward0>)
size_loss tensor(-0.0036, grad_fn=<MulBackward0>)
size_num_loss 72.0
epoch:  0 ; loss:  71.99639892578125 ; pred:  tensor([0., 0., 1., 0.], grad_fn=<SoftmaxBackward0>)
tensor([[-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        ...,
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013]], grad_fn=<AddBackward0>)
masked_hor: tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.8329, 0.8145, 0.7875, 0.0585, 0.0777, 0.0644, 0.0738,
                      0.0619, 0.0760, 0.0680, 0.0692, 0.0754, 0.0652, 0.7458,
                      0.5698, 0.7286, 0.7028, 0.6976, 0.7828, 0.6836, 0.6855,
                      0.7373, 0.6706, 0.7587]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
tensor([[-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        ...,
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013]], grad_fn=<AddBackward0>)
gt_label_node tensor(2, dtype=torch.int32)
gt_label_node <class 'torch.Tensor'>
logit tensor(1., grad_fn=<SelectBackward0>)
mask_without_small tensor([0.8329, 0.8145, 0.7875, 0.5847, 0.7766, 0.6442, 0.7384, 0.6193, 0.7600,
        0.6796, 0.6916, 0.7539, 0.6523, 0.7458, 0.5698, 0.7286, 0.7028, 0.6976,
        0.7828, 0.6836, 0.6855, 0.7373, 0.6706, 0.7587],
       grad_fn=<IndexBackward0>)
pred_loss tensor(-0., grad_fn=<MulBackward0>)
size_loss tensor(-0.0047, grad_fn=<MulBackward0>)
size_num_loss 72.0
24
start training
tensor([[-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        ...,
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013]], grad_fn=<AddBackward0>)
masked_hor: tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.8258, 0.8068, 0.7790, 0.0597, 0.0768, 0.0656, 0.0729,
                      0.0631, 0.0751, 0.0690, 0.0702, 0.0745, 0.0664, 0.7362,
                      0.5820, 0.7186, 0.7131, 0.7080, 0.7742, 0.6944, 0.6962,
                      0.7275, 0.6815, 0.7494]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
tensor([[-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        ...,
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013]], grad_fn=<AddBackward0>)
gt_label_node tensor(2, dtype=torch.int32)
gt_label_node <class 'torch.Tensor'>
logit tensor(1., grad_fn=<SelectBackward0>)
mask_without_small tensor([0.8258, 0.8068, 0.7790, 0.5968, 0.7678, 0.6556, 0.7286, 0.6311, 0.7508,
        0.6904, 0.7022, 0.7445, 0.6636, 0.7362, 0.5820, 0.7186, 0.7131, 0.7080,
        0.7742, 0.6944, 0.6962, 0.7275, 0.6815, 0.7494],
       grad_fn=<IndexBackward0>)
pred_loss tensor(-0., grad_fn=<MulBackward0>)
size_loss tensor(-0.0036, grad_fn=<MulBackward0>)
size_num_loss 72.0
epoch:  0 ; loss:  71.99639892578125 ; pred:  tensor([0., 0., 1., 0.], grad_fn=<SoftmaxBackward0>)
tensor([[-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        ...,
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013]], grad_fn=<AddBackward0>)
masked_hor: tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.8397, 0.8219, 0.7958, 0.0573, 0.0785, 0.0633, 0.0748,
                      0.0607, 0.0769, 0.0669, 0.0681, 0.0763, 0.0641, 0.7552,
                      0.5575, 0.7383, 0.6923, 0.6869, 0.7912, 0.6727, 0.6746,
                      0.7468, 0.6594, 0.7677]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
tensor([[-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        ...,
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013]], grad_fn=<AddBackward0>)
gt_label_node tensor(2, dtype=torch.int32)
gt_label_node <class 'torch.Tensor'>
logit tensor(1., grad_fn=<SelectBackward0>)
mask_without_small tensor([0.8397, 0.8219, 0.7958, 0.5725, 0.7851, 0.6327, 0.7479, 0.6075, 0.7690,
        0.6686, 0.6808, 0.7631, 0.6409, 0.7552, 0.5575, 0.7383, 0.6923, 0.6869,
        0.7912, 0.6727, 0.6746, 0.7468, 0.6594, 0.7677],
       grad_fn=<IndexBackward0>)
pred_loss tensor(-0., grad_fn=<MulBackward0>)
size_loss tensor(-0.0059, grad_fn=<MulBackward0>)
size_num_loss 72.0
24
start training
tensor([[-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        ...,
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013]], grad_fn=<AddBackward0>)
masked_hor: tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.8258, 0.8068, 0.7790, 0.0597, 0.0768, 0.0656, 0.0729,
                      0.0631, 0.0751, 0.0690, 0.0702, 0.0745, 0.0664, 0.7362,
                      0.5820, 0.7186, 0.7131, 0.7080, 0.7742, 0.6944, 0.6962,
                      0.7275, 0.6815, 0.7494]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
tensor([[-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        ...,
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013]], grad_fn=<AddBackward0>)
gt_label_node tensor(2, dtype=torch.int32)
gt_label_node <class 'torch.Tensor'>
logit tensor(1., grad_fn=<SelectBackward0>)
mask_without_small tensor([0.8258, 0.8068, 0.7790, 0.5968, 0.7678, 0.6556, 0.7286, 0.6311, 0.7508,
        0.6904, 0.7022, 0.7445, 0.6636, 0.7362, 0.5820, 0.7186, 0.7131, 0.7080,
        0.7742, 0.6944, 0.6962, 0.7275, 0.6815, 0.7494],
       grad_fn=<IndexBackward0>)
pred_loss tensor(-0., grad_fn=<MulBackward0>)
size_loss tensor(-0.0036, grad_fn=<MulBackward0>)
size_num_loss 72.0
epoch:  0 ; loss:  71.99639892578125 ; pred:  tensor([0., 0., 1., 0.], grad_fn=<SoftmaxBackward0>)
tensor([[-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        ...,
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013]], grad_fn=<AddBackward0>)
masked_hor: tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.8866, 0.8732, 0.8532, 0.0473, 0.0845, 0.0536, 0.0816,
                      0.0509, 0.0832, 0.0575, 0.0588, 0.0828, 0.0545, 0.8215,
                      0.4579, 0.8080, 0.6014, 0.5953, 0.8497, 0.5795, 0.5815,
                      0.8148, 0.5648, 0.8314]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
tensor([[-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        ...,
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013],
        [-0.9757, -1.1641,  1.1167, -1.2013]], grad_fn=<AddBackward0>)
gt_label_node tensor(2, dtype=torch.int32)
gt_label_node <class 'torch.Tensor'>
logit tensor(1., grad_fn=<SelectBackward0>)
mask_without_small tensor([0.8866, 0.8732, 0.8532, 0.8450, 0.5358, 0.8157, 0.5092, 0.8324, 0.5749,
        0.5885, 0.8277, 0.5447, 0.8215, 0.8080, 0.6014, 0.5953, 0.8497, 0.5795,
        0.5815, 0.8148, 0.5648, 0.8314], grad_fn=<IndexBackward0>)
pred_loss tensor(-0., grad_fn=<MulBackward0>)
size_loss tensor(-19.7047, grad_fn=<MulBackward0>)
size_num_loss 84.5
masked_ver tensor(indices=tensor([[ 23430,  23444,  23490,  23546,  24301,  24407,  24427,
                         24475,  24503,  24543,  88607, 196312, 229452, 254307,
                        254307, 254307, 254307, 254307, 254307, 254307, 254307,
                        254307, 254307, 328872],
                       [  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,    908,   2227,   1002,   6860,
                          6874,   6920,   6976,   7731,   7837,   7857,   7905,
                          7933,   7973,   5230]]),
       values=tensor([0.8866, 0.8732, 0.8532, 0.4731, 0.8450, 0.5358, 0.8157,
                      0.5092, 0.8324, 0.5749, 0.5885, 0.8277, 0.5447, 0.0821,
                      0.0458, 0.0808, 0.0601, 0.0595, 0.0850, 0.0579, 0.0582,
                      0.0815, 0.0565, 0.8314]),
       size=(753935, 8285), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
sel masked ver tensor(indices=tensor([[6860, 6874, 6920, 7731, 7837, 7857, 7905, 7933, 7973,
                        5757, 5757, 5757, 5757],
                       [5757, 5757, 5757, 5757, 5757, 5757, 5757, 5757, 5757,
                         908, 2227, 1002, 5230]]),
       values=tensor([0.8866, 0.8732, 0.8532, 0.8450, 0.5358, 0.8157, 0.5092,
                      0.8324, 0.5749, 0.5885, 0.8277, 0.5447, 0.8314]),
       size=(7974, 5758), nnz=13, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
Counter({'author': 9, 'fax': 1, 'phone': 1, 'name': 1, 'type': 1})
dict index: {}
/usr/local/Caskroom/miniconda/base/lib/python3.9/site-packages/networkx/drawing/nx_pylab.py:433: UserWarning: No data for colormapping provided via 'c'. Parameters 'cmap' will be ignored
  node_collection = ax.scatter(
most important relations:  Counter({'author': 9, 'fax': 1, 'phone': 1, 'name': 1, 'type': 1})
ypred explain tensor([0., 0., 1., 0.], grad_fn=<SoftmaxBackward0>)
ypred full tensor([0., 0., 1., 0.], grad_fn=<SoftmaxBackward0>)
original label [2]
num mislabel 1
num correct 34
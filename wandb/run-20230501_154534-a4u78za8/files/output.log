119
start training
masked_hor: tensor(indices=tensor([[  5357,   5357,   5408,   5408,   5413,   5413,   5431,
                          5431,   5450,   5450,   5494,   5494,   5502,   5502,
                          5502,   5502,   5502,   5502,   5502,   5502,   5502,
                          5502,   5502,   5502,   5502,   5502,   5502,   5502,
                          5502,   5502,   5502,   5502,   5678,   5678,   5678,
                          5678,   5678,   5678,   5678,   5678,   5678,   5678,
                          5678,   5678,   5678,   5678,   5678,   5678,   5678,
                          5678,   5678,   5678,   5678,   5678,   5678,   5678,
                          5678,   5937,   5937,   5937,   5937,   5937,   5939,
                          5939,   5939,   5939,   5939,   5939,   5939,   5939,
                          5939,   5939,   5939,   5939,   5939,   5939,   5939,
                          6881,   6881,   6881,   6887,   6887,   6887,   6888,
                          6888,   6981,   6981,   6997,   6997,   6997,   7045,
                          7045,   7068,   7068,   7100,   7100,   7393,   7393,
                          7393,   7861,   7911,   7911,   7911,   7968,   8010,
                          8010,   8010,   8012,   8012,   8012,   8013,   8013,
                          8013,   8014,   8014,   8014,   8015,   8015,   8015],
                       [ 63934, 154808,  63934, 154808,  63934, 154808,  63932,
                        154808,  63934, 154808,  63932, 154808,  47362,  47364,
                        179663, 263716, 263722, 263723, 263816, 263832, 263880,
                        263903, 263935, 264228, 264696, 264746, 264803, 264845,
                        264847, 264848, 264849, 264850,  82872, 124392, 192770,
                        223730, 237515, 255431, 255437, 255438, 255531, 255547,
                        255595, 255618, 255650, 255943, 256411, 256461, 256518,
                        256560, 256562, 256563, 256564, 256565, 304199, 328345,
                        328346,  38642, 146276, 146339, 179663, 247153,  38642,
                        146202, 146253, 146258, 146295, 179663, 247146, 247152,
                        247262, 248176, 248275, 248277, 248278, 248279, 248280,
                         22248, 113644, 146202,  80243, 113644, 146295,  22248,
                        113642,  22248, 146295,  22248, 113644, 146295,  22248,
                        146295,  22248, 146295,  22248, 146295,  22248, 146202,
                        146295,  22248,  22248, 113644, 146295,  22248,  22248,
                        113644, 146295,  22248, 113644, 146295,  22248, 113644,
                        146295,  22248, 113644, 146295,  22248, 113644, 146295]]),
       values=tensor([0.7773, 0.7672, 0.7534, 0.6742, 0.7480, 0.6985, 0.7300,
                      0.6883, 0.7115, 0.7710, 0.7209, 0.6938, 0.3561, 0.3583,
                      0.7110, 0.0441, 0.0453, 0.0428, 0.0422, 0.0437, 0.0418,
                      0.0446, 0.0442, 0.0454, 0.0448, 0.0449, 0.0439, 0.0449,
                      0.0427, 0.0431, 0.0426, 0.0443, 0.6943, 0.7083, 0.7253,
                      0.7725, 0.7391, 0.0424, 0.0435, 0.0418, 0.0406, 0.0445,
                      0.0417, 0.0421, 0.0410, 0.0460, 0.0411, 0.0423, 0.0416,
                      0.0420, 0.0431, 0.0438, 0.0423, 0.0447, 0.7098, 0.3559,
                      0.3469, 0.7320, 0.3647, 0.3740, 0.7286, 0.7754, 0.6998,
                      0.1912, 0.1916, 0.1881, 0.1959, 0.7442, 0.0822, 0.0807,
                      0.0781, 0.0847, 0.0807, 0.0827, 0.0814, 0.0824, 0.0828,
                      0.7144, 0.6713, 0.7115, 0.7313, 0.7223, 0.6955, 0.7159,
                      0.7445, 0.7442, 0.7591, 0.7324, 0.7496, 0.7186, 0.7035,
                      0.7462, 0.6850, 0.7094, 0.7637, 0.7432, 0.6625, 0.3717,
                      0.3753, 0.7318, 0.7471, 0.7457, 0.7574, 0.7443, 0.7565,
                      0.7127, 0.7561, 0.7225, 0.7440, 0.7408, 0.7160, 0.7414,
                      0.7162, 0.7438, 0.7188, 0.7183, 0.7379, 0.7165, 0.7480]),
       size=(8285, 753935), nnz=119, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
num_high 119
pred_loss tensor(0.5702, grad_fn=<MulBackward0>)
size_loss tensor(-870.8996, grad_fn=<MulBackward0>) tensor(1.0126, grad_fn=<MeanBackward0>) tensor(-1189.2319, grad_fn=<MulBackward0>)
size_num_loss 1770.125
  0%|                                                                                                                                             | 0/10 [00:00<?, ?it/s]/Users/macoftraopia/Documents/GitHub/RGCN-Explainer/RGCN_stuff/r.py:126: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  adj = torch.tensor(adj)
epoch:  0 ; loss:  -288.423828125 ; pred:  tensor([0.5654, 0.1537, 0.1557, 0.1251], grad_fn=<SoftmaxBackward0>)
masked_hor: tensor(indices=tensor([[  5357,   5357,   5408,   5408,   5413,   5413,   5431,
                          5431,   5450,   5450,   5494,   5494,   5502,   5502,
                          5502,   5502,   5502,   5502,   5502,   5502,   5502,
                          5502,   5502,   5502,   5502,   5502,   5502,   5502,
                          5502,   5502,   5502,   5502,   5678,   5678,   5678,
                          5678,   5678,   5678,   5678,   5678,   5678,   5678,
                          5678,   5678,   5678,   5678,   5678,   5678,   5678,
                          5678,   5678,   5678,   5678,   5678,   5678,   5678,
                          5678,   5937,   5937,   5937,   5937,   5937,   5939,
                          5939,   5939,   5939,   5939,   5939,   5939,   5939,
                          5939,   5939,   5939,   5939,   5939,   5939,   5939,
                          6881,   6881,   6881,   6887,   6887,   6887,   6888,
                          6888,   6981,   6981,   6997,   6997,   6997,   7045,
                          7045,   7068,   7068,   7100,   7100,   7393,   7393,
                          7393,   7861,   7911,   7911,   7911,   7968,   8010,
                          8010,   8010,   8012,   8012,   8012,   8013,   8013,
                          8013,   8014,   8014,   8014,   8015,   8015,   8015],
                       [ 63934, 154808,  63934, 154808,  63934, 154808,  63932,
                        154808,  63934, 154808,  63932, 154808,  47362,  47364,
                        179663, 263716, 263722, 263723, 263816, 263832, 263880,
                        263903, 263935, 264228, 264696, 264746, 264803, 264845,
                        264847, 264848, 264849, 264850,  82872, 124392, 192770,
                        223730, 237515, 255431, 255437, 255438, 255531, 255547,
                        255595, 255618, 255650, 255943, 256411, 256461, 256518,
                        256560, 256562, 256563, 256564, 256565, 304199, 328345,
                        328346,  38642, 146276, 146339, 179663, 247153,  38642,
                        146202, 146253, 146258, 146295, 179663, 247146, 247152,
                        247262, 248176, 248275, 248277, 248278, 248279, 248280,
                         22248, 113644, 146202,  80243, 113644, 146295,  22248,
                        113642,  22248, 146295,  22248, 113644, 146295,  22248,
                        146295,  22248, 146295,  22248, 146295,  22248, 146202,
                        146295,  22248,  22248, 113644, 146295,  22248,  22248,
                        113644, 146295,  22248, 113644, 146295,  22248, 113644,
                        146295,  22248, 113644, 146295,  22248, 113644, 146295]]),
       values=tensor([0.8519, 0.8446, 0.8343, 0.7733, 0.8303, 0.7925, 0.8167,
                      0.7845, 0.8026, 0.8473, 0.8099, 0.7889, 0.4015, 0.4033,
                      0.8022, 0.0489, 0.0498, 0.0479, 0.0475, 0.0486, 0.0472,
                      0.0493, 0.0490, 0.0499, 0.0495, 0.0495, 0.0488, 0.0495,
                      0.0478, 0.0481, 0.0478, 0.0490, 0.7893, 0.8001, 0.8132,
                      0.8485, 0.8237, 0.0476, 0.0484, 0.0472, 0.0462, 0.0492,
                      0.0471, 0.0474, 0.0466, 0.0503, 0.0466, 0.0475, 0.0470,
                      0.0473, 0.0482, 0.0487, 0.0475, 0.0494, 0.8013, 0.4015,
                      0.3944, 0.8183, 0.4082, 0.4151, 0.8157, 0.8506, 0.7935,
                      0.2107, 0.2110, 0.2084, 0.2142, 0.8275, 0.0916, 0.0904,
                      0.0885, 0.0934, 0.0905, 0.0919, 0.0910, 0.0917, 0.0920,
                      0.8048, 0.7710, 0.8026, 0.8178, 0.8109, 0.7902, 0.8060,
                      0.8277, 0.8275, 0.8386, 0.8186, 0.8315, 0.8081, 0.7964,
                      0.8290, 0.7819, 0.8010, 0.8420, 0.8267, 0.7640, 0.4134,
                      0.4161, 0.8181, 0.8296, 0.8286, 0.8373, 0.8276, 0.8367,
                      0.8036, 0.8364, 0.8111, 0.8274, 0.8250, 0.8061, 0.8254,
                      0.8062, 0.8272, 0.8082, 0.8079, 0.8227, 0.8064, 0.8303]),
       size=(8285, 753935), nnz=119, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
num_high 119
pred_loss tensor(-0., grad_fn=<MulBackward0>)
size_loss tensor(-973.3783, grad_fn=<MulBackward0>) tensor(1.0073, grad_fn=<MeanBackward0>) tensor(-1784.2321, grad_fn=<MulBackward0>)
size_num_loss 1770.125
 10%|█████████████▎                                                                                                                       | 1/10 [00:25<03:52, 25.87s/it]
masked_hor: tensor(indices=tensor([[  5357,   5357,   5408,   5408,   5413,   5413,   5431,
                          5431,   5450,   5450,   5494,   5494,   5502,   5502,
                          5502,   5502,   5502,   5502,   5502,   5502,   5502,
                          5502,   5502,   5502,   5502,   5502,   5502,   5502,
                          5502,   5502,   5502,   5502,   5678,   5678,   5678,
                          5678,   5678,   5678,   5678,   5678,   5678,   5678,
                          5678,   5678,   5678,   5678,   5678,   5678,   5678,
                          5678,   5678,   5678,   5678,   5678,   5678,   5678,
                          5678,   5937,   5937,   5937,   5937,   5937,   5939,
                          5939,   5939,   5939,   5939,   5939,   5939,   5939,
                          5939,   5939,   5939,   5939,   5939,   5939,   5939,
                          6881,   6881,   6881,   6887,   6887,   6887,   6888,
                          6888,   6981,   6981,   6997,   6997,   6997,   7045,
                          7045,   7068,   7068,   7100,   7100,   7393,   7393,
                          7393,   7861,   7911,   7911,   7911,   7968,   8010,
                          8010,   8010,   8012,   8012,   8012,   8013,   8013,
                          8013,   8014,   8014,   8014,   8015,   8015,   8015],
                       [ 63934, 154808,  63934, 154808,  63934, 154808,  63932,
                        154808,  63934, 154808,  63932, 154808,  47362,  47364,
                        179663, 263716, 263722, 263723, 263816, 263832, 263880,
                        263903, 263935, 264228, 264696, 264746, 264803, 264845,
                        264847, 264848, 264849, 264850,  82872, 124392, 192770,
                        223730, 237515, 255431, 255437, 255438, 255531, 255547,
                        255595, 255618, 255650, 255943, 256411, 256461, 256518,
                        256560, 256562, 256563, 256564, 256565, 304199, 328345,
                        328346,  38642, 146276, 146339, 179663, 247153,  38642,
                        146202, 146253, 146258, 146295, 179663, 247146, 247152,
                        247262, 248176, 248275, 248277, 248278, 248279, 248280,
                         22248, 113644, 146202,  80243, 113644, 146295,  22248,
                        113642,  22248, 146295,  22248, 113644, 146295,  22248,
                        146295,  22248, 146295,  22248, 146295,  22248, 146202,
                        146295,  22248,  22248, 113644, 146295,  22248,  22248,
                        113644, 146295,  22248, 113644, 146295,  22248, 113644,
                        146295,  22248, 113644, 146295,  22248, 113644, 146295]]),
       values=tensor([0.9046, 0.8995, 0.8925, 0.8490, 0.8897, 0.8629, 0.8801,
                      0.8571, 0.8701, 0.9014, 0.8753, 0.8603, 0.4352, 0.4365,
                      0.8699, 0.0524, 0.0530, 0.0517, 0.0514, 0.0522, 0.0512,
                      0.0526, 0.0524, 0.0530, 0.0528, 0.0528, 0.0523, 0.0528,
                      0.0516, 0.0518, 0.0516, 0.0525, 0.8606, 0.8683, 0.8777,
                      0.9022, 0.8850, 0.0515, 0.0520, 0.0512, 0.0505, 0.0526,
                      0.0511, 0.0513, 0.0507, 0.0533, 0.0508, 0.0514, 0.0510,
                      0.0513, 0.0519, 0.0522, 0.0514, 0.0527, 0.8692, 0.4352,
                      0.4301, 0.8812, 0.4399, 0.4448, 0.8794, 0.9037, 0.8636,
                      0.2246, 0.2248, 0.2230, 0.2269, 0.8877, 0.0984, 0.0976,
                      0.0962, 0.0997, 0.0976, 0.0986, 0.0979, 0.0985, 0.0987,
                      0.8717, 0.8473, 0.8701, 0.8809, 0.8760, 0.8612, 0.8725,
                      0.8878, 0.8877, 0.8954, 0.8814, 0.8905, 0.8740, 0.8657,
                      0.8887, 0.8552, 0.8690, 0.8977, 0.8872, 0.8421, 0.4436,
                      0.4455, 0.8811, 0.8892, 0.8884, 0.8945, 0.8877, 0.8941,
                      0.8708, 0.8939, 0.8762, 0.8876, 0.8859, 0.8726, 0.8862,
                      0.8727, 0.8875, 0.8741, 0.8739, 0.8844, 0.8729, 0.8897]),
       size=(8285, 753935), nnz=119, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
num_high 119
pred_loss tensor(-0., grad_fn=<MulBackward0>)
size_loss tensor(-1048.2694, grad_fn=<MulBackward0>) tensor(1.0036, grad_fn=<MeanBackward0>) tensor(-2378.4854, grad_fn=<MulBackward0>)

 20%|██████████████████████████▌                                                                                                          | 2/10 [00:51<03:24, 25.56s/it]
epoch:  2 ; loss:  -1655.6259765625 ; pred:  tensor([1., 0., 0., 0.], grad_fn=<SoftmaxBackward0>)
masked_hor: tensor(indices=tensor([[  5357,   5357,   5408,   5408,   5413,   5413,   5431,
                          5431,   5450,   5450,   5494,   5494,   5502,   5502,
                          5502,   5502,   5502,   5502,   5502,   5502,   5502,
                          5502,   5502,   5502,   5502,   5502,   5502,   5502,
                          5502,   5502,   5502,   5502,   5678,   5678,   5678,
                          5678,   5678,   5678,   5678,   5678,   5678,   5678,
                          5678,   5678,   5678,   5678,   5678,   5678,   5678,
                          5678,   5678,   5678,   5678,   5678,   5678,   5678,
                          5678,   5937,   5937,   5937,   5937,   5937,   5939,
                          5939,   5939,   5939,   5939,   5939,   5939,   5939,
                          5939,   5939,   5939,   5939,   5939,   5939,   5939,
                          6881,   6881,   6881,   6887,   6887,   6887,   6888,
                          6888,   6981,   6981,   6997,   6997,   6997,   7045,
                          7045,   7068,   7068,   7100,   7100,   7393,   7393,
                          7393,   7861,   7911,   7911,   7911,   7968,   8010,
                          8010,   8010,   8012,   8012,   8012,   8013,   8013,
                          8013,   8014,   8014,   8014,   8015,   8015,   8015],
                       [ 63934, 154808,  63934, 154808,  63934, 154808,  63932,
                        154808,  63934, 154808,  63932, 154808,  47362,  47364,
                        179663, 263716, 263722, 263723, 263816, 263832, 263880,
                        263903, 263935, 264228, 264696, 264746, 264803, 264845,
                        264847, 264848, 264849, 264850,  82872, 124392, 192770,
                        223730, 237515, 255431, 255437, 255438, 255531, 255547,
                        255595, 255618, 255650, 255943, 256411, 256461, 256518,
                        256560, 256562, 256563, 256564, 256565, 304199, 328345,
                        328346,  38642, 146276, 146339, 179663, 247153,  38642,
                        146202, 146253, 146258, 146295, 179663, 247146, 247152,
                        247262, 248176, 248275, 248277, 248278, 248279, 248280,
                         22248, 113644, 146202,  80243, 113644, 146295,  22248,
                        113642,  22248, 146295,  22248, 113644, 146295,  22248,
                        146295,  22248, 146295,  22248, 146295,  22248, 146202,
                        146295,  22248,  22248, 113644, 146295,  22248,  22248,
                        113644, 146295,  22248, 113644, 146295,  22248, 113644,
                        146295,  22248, 113644, 146295,  22248, 113644, 146295]]),
       values=tensor([0.9398, 0.9365, 0.9318, 0.9025, 0.9299, 0.9120, 0.9236,
                      0.9080, 0.9168, 0.9377, 0.9203, 0.9102, 0.4585, 0.4594,
                      0.9167, 0.0547, 0.0552, 0.0543, 0.0541, 0.0546, 0.0539,
                      0.0549, 0.0548, 0.0552, 0.0550, 0.0550, 0.0547, 0.0550,
                      0.0542, 0.0544, 0.0542, 0.0548, 0.9104, 0.9157, 0.9219,
                      0.9382, 0.9268, 0.0541, 0.0545, 0.0539, 0.0534, 0.0549,
                      0.0539, 0.0540, 0.0536, 0.0554, 0.0536, 0.0541, 0.0538,
                      0.0540, 0.0544, 0.0546, 0.0541, 0.0549, 0.9162, 0.4585,
                      0.4551, 0.9243, 0.4617, 0.4650, 0.9231, 0.9392, 0.9125,
                      0.2339, 0.2340, 0.2329, 0.2355, 0.9286, 0.1030, 0.1025,
                      0.1015, 0.1039, 0.1025, 0.1032, 0.1027, 0.1031, 0.1032,
                      0.9179, 0.9013, 0.9169, 0.9241, 0.9208, 0.9108, 0.9185,
                      0.9287, 0.9286, 0.9337, 0.9245, 0.9305, 0.9195, 0.9139,
                      0.9293, 0.9067, 0.9161, 0.9353, 0.9283, 0.8978, 0.4642,
                      0.4654, 0.9242, 0.9296, 0.9291, 0.9331, 0.9287, 0.9329,
                      0.9173, 0.9327, 0.9209, 0.9286, 0.9274, 0.9185, 0.9276,
                      0.9186, 0.9285, 0.9195, 0.9194, 0.9264, 0.9187, 0.9299]),
       size=(8285, 753935), nnz=119, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
num_high 119
pred_loss tensor(-0., grad_fn=<MulBackward0>)
size_loss tensor(-1099.6140, grad_fn=<MulBackward0>) tensor(1.0016, grad_fn=<MeanBackward0>) tensor(-2971.5391, grad_fn=<MulBackward0>)


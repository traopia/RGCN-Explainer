[34m[1mwandb[39m[22m: [33mWARNING[39m Calling wandb.login() after wandb.init() has no effect.
/Users/macoftraopia/Documents/GitHub/RGCN-Explainer/RGCN_stuff/r_exp.py:222: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  adj = torch.tensor(adj)
/Users/macoftraopia/Documents/GitHub/RGCN-Explainer/RGCN_stuff/r_exp.py:248: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  adj = torch.tensor(adj)
node_idx 5757
masked_adj tensor([0.7311, 0.7311, 0.7311, 0.7311, 0.7311, 0.7311, 0.7311, 0.7311, 0.7311,
        0.7311, 0.7311, 0.7311, 0.7311, 0.7311, 0.7311, 0.7311, 0.7311, 0.7311,
        0.7311, 0.7311, 0.7311, 0.7311, 0.7311, 0.7311],
       grad_fn=<MulBackward0>)
masked_hor tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.7311, 0.7311, 0.7311, 0.7311, 0.7311, 0.7311, 0.7311,
                      0.7311, 0.7311, 0.7311, 0.7311, 0.7311, 0.7311, 0.7311,
                      0.7311, 0.7311, 0.7311, 0.7311, 0.7311, 0.7311, 0.7311,
                      0.7311, 0.7311, 0.7311]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
ypred tensor([[ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        ...,
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028]], grad_fn=<AddBackward0>)
res: tensor([0.0609, 0.1418, 0.6873, 0.1100], grad_fn=<SoftmaxBackward0>)
label tensor([2])
logit tensor([0.6873], grad_fn=<IndexBackward0>)
mask_without_small tensor([0.7311, 0.7311, 0.7311, 0.7311, 0.7311, 0.7311, 0.7311, 0.7311, 0.7311,
        0.7311, 0.7311, 0.7311, 0.7311, 0.7311, 0.7311, 0.7311, 0.7311, 0.7311,
        0.7311, 0.7311, 0.7311, 0.7311, 0.7311, 0.7311],
       grad_fn=<IndexBackward0>)
pred_loss tensor([0.3750], grad_fn=<MulBackward0>)
size_loss tensor(-3.7072e-13, grad_fn=<MulBackward0>)
size_num_loss 0.72
loss: tensor([1.0950], grad_fn=<AddBackward0>)
0
epoch:  0 ; loss:  1.095016360282898 ; pred:  tensor([0.0609, 0.1418, 0.6873, 0.1100], grad_fn=<SoftmaxBackward0>)
node_idx 5757
masked_adj tensor([0.7109, 0.7109, 0.7109, 0.7109, 0.7109, 0.7109, 0.7109, 0.7109, 0.7109,
        0.7109, 0.7109, 0.7109, 0.7109, 0.7109, 0.7109, 0.7109, 0.7109, 0.7109,
        0.7109, 0.7109, 0.7109, 0.7109, 0.7109, 0.7109],
       grad_fn=<MulBackward0>)
masked_hor tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.7109, 0.7109, 0.7109, 0.7109, 0.7109, 0.7109, 0.7109,
                      0.7109, 0.7109, 0.7109, 0.7109, 0.7109, 0.7109, 0.7109,
                      0.7109, 0.7109, 0.7109, 0.7109, 0.7109, 0.7109, 0.7109,
                      0.7109, 0.7109, 0.7109]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
ypred tensor([[ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        ...,
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028]], grad_fn=<AddBackward0>)
res: tensor([0.0663, 0.1505, 0.6668, 0.1165], grad_fn=<SoftmaxBackward0>)
label tensor([2])
logit tensor([0.6668], grad_fn=<IndexBackward0>)
mask_without_small tensor([0.7109, 0.7109, 0.7109, 0.7109, 0.7109, 0.7109, 0.7109, 0.7109, 0.7109,
        0.7109, 0.7109, 0.7109, 0.7109, 0.7109, 0.7109, 0.7109, 0.7109, 0.7109,
        0.7109, 0.7109, 0.7109, 0.7109, 0.7109, 0.7109],
       grad_fn=<IndexBackward0>)
pred_loss tensor([0.4053], grad_fn=<MulBackward0>)
size_loss tensor(-0., grad_fn=<MulBackward0>)
size_num_loss 0.72
loss: tensor([1.1253], grad_fn=<AddBackward0>)
1
epoch:  1 ; loss:  1.1252849102020264 ; pred:  tensor([0.0663, 0.1505, 0.6668, 0.1165], grad_fn=<SoftmaxBackward0>)
node_idx 5757
masked_adj tensor([0.6901, 0.6901, 0.6901, 0.6901, 0.6901, 0.6901, 0.6901, 0.6901, 0.6901,
        0.6901, 0.6901, 0.6901, 0.6900, 0.6901, 0.6902, 0.6902, 0.6902, 0.6902,
        0.6902, 0.6902, 0.6902, 0.6902, 0.6902, 0.6901],
       grad_fn=<MulBackward0>)
masked_hor tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.6901, 0.6901, 0.6901, 0.6901, 0.6901, 0.6901, 0.6901,
                      0.6901, 0.6901, 0.6901, 0.6901, 0.6901, 0.6900, 0.6901,
                      0.6902, 0.6902, 0.6902, 0.6902, 0.6902, 0.6902, 0.6902,
                      0.6902, 0.6902, 0.6901]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
ypred tensor([[ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        ...,
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028]], grad_fn=<AddBackward0>)
res: tensor([0.0721, 0.1593, 0.6455, 0.1231], grad_fn=<SoftmaxBackward0>)
label tensor([2])
logit tensor([0.6455], grad_fn=<IndexBackward0>)
mask_without_small tensor([0.6901, 0.6901, 0.6901, 0.6901, 0.6901, 0.6901, 0.6901, 0.6901, 0.6901,
        0.6901, 0.6901, 0.6901, 0.6900, 0.6901, 0.6902, 0.6902, 0.6902, 0.6902,
        0.6902, 0.6902, 0.6902, 0.6902, 0.6902, 0.6901],
       grad_fn=<IndexBackward0>)
pred_loss tensor([0.4377], grad_fn=<MulBackward0>)
size_loss tensor(-3.3360e-07, grad_fn=<MulBackward0>)
size_num_loss 0.72
loss: tensor([1.1577], grad_fn=<AddBackward0>)
2
epoch:  2 ; loss:  1.1576952934265137 ; pred:  tensor([0.0721, 0.1593, 0.6455, 0.1231], grad_fn=<SoftmaxBackward0>)
node_idx 5757
masked_adj tensor([0.6685, 0.6685, 0.6685, 0.6685, 0.6685, 0.6685, 0.6685, 0.6685, 0.6685,
        0.6685, 0.6687, 0.6688, 0.6684, 0.6687, 0.6691, 0.6691, 0.6691, 0.6691,
        0.6691, 0.6691, 0.6691, 0.6691, 0.6691, 0.6686],
       grad_fn=<MulBackward0>)
masked_hor tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.6685, 0.6685, 0.6685, 0.6685, 0.6685, 0.6685, 0.6685,
                      0.6685, 0.6685, 0.6685, 0.6687, 0.6688, 0.6684, 0.6687,
                      0.6691, 0.6691, 0.6691, 0.6691, 0.6691, 0.6691, 0.6691,
                      0.6691, 0.6691, 0.6686]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
ypred tensor([[ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        ...,
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028]], grad_fn=<AddBackward0>)
res: tensor([0.0782, 0.1682, 0.6239, 0.1298], grad_fn=<SoftmaxBackward0>)
label tensor([2])
logit tensor([0.6239], grad_fn=<IndexBackward0>)
mask_without_small tensor([0.6685, 0.6685, 0.6685, 0.6685, 0.6685, 0.6685, 0.6685, 0.6685, 0.6685,
        0.6685, 0.6687, 0.6688, 0.6684, 0.6687, 0.6691, 0.6691, 0.6691, 0.6691,
        0.6691, 0.6691, 0.6691, 0.6691, 0.6691, 0.6686],
       grad_fn=<IndexBackward0>)
pred_loss tensor([0.4718], grad_fn=<MulBackward0>)
size_loss tensor(-6.3844e-06, grad_fn=<MulBackward0>)
size_num_loss 0.72
loss: tensor([1.1918], grad_fn=<AddBackward0>)
3
epoch:  3 ; loss:  1.1917515993118286 ; pred:  tensor([0.0782, 0.1682, 0.6239, 0.1298], grad_fn=<SoftmaxBackward0>)
node_idx 5757
masked_adj tensor([0.6465, 0.6465, 0.6465, 0.6465, 0.6465, 0.6465, 0.6465, 0.6465, 0.6465,
        0.6465, 0.6469, 0.6473, 0.6462, 0.6471, 0.6480, 0.6480, 0.6480, 0.6480,
        0.6480, 0.6480, 0.6480, 0.6480, 0.6480, 0.6466],
       grad_fn=<MulBackward0>)
masked_hor tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.6465, 0.6465, 0.6465, 0.6465, 0.6465, 0.6465, 0.6465,
                      0.6465, 0.6465, 0.6465, 0.6469, 0.6473, 0.6462, 0.6471,
                      0.6480, 0.6480, 0.6480, 0.6480, 0.6480, 0.6480, 0.6480,
                      0.6480, 0.6480, 0.6466]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
ypred tensor([[ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        ...,
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028]], grad_fn=<AddBackward0>)
res: tensor([0.0845, 0.1767, 0.6025, 0.1363], grad_fn=<SoftmaxBackward0>)
label tensor([2])
logit tensor([0.6025], grad_fn=<IndexBackward0>)
mask_without_small tensor([0.6465, 0.6465, 0.6465, 0.6465, 0.6465, 0.6465, 0.6465, 0.6465, 0.6465,
        0.6465, 0.6469, 0.6473, 0.6462, 0.6471, 0.6480, 0.6480, 0.6480, 0.6480,
        0.6480, 0.6480, 0.6480, 0.6480, 0.6480, 0.6466],
       grad_fn=<IndexBackward0>)
pred_loss tensor([0.5067], grad_fn=<MulBackward0>)
size_loss tensor(-5.1198e-05, grad_fn=<MulBackward0>)
size_num_loss 0.72
loss: tensor([1.2266], grad_fn=<AddBackward0>)
4
epoch:  4 ; loss:  1.226621150970459 ; pred:  tensor([0.0845, 0.1767, 0.6025, 0.1363], grad_fn=<SoftmaxBackward0>)
node_idx 5757
masked_adj tensor([0.6243, 0.6243, 0.6243, 0.6243, 0.6243, 0.6243, 0.6243, 0.6243, 0.6243,
        0.6243, 0.6250, 0.6260, 0.6234, 0.6254, 0.6277, 0.6277, 0.6277, 0.6277,
        0.6277, 0.6277, 0.6277, 0.6277, 0.6277, 0.6244],
       grad_fn=<MulBackward0>)
masked_hor tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.6243, 0.6243, 0.6243, 0.6243, 0.6243, 0.6243, 0.6243,
                      0.6243, 0.6243, 0.6243, 0.6250, 0.6260, 0.6234, 0.6254,
                      0.6277, 0.6277, 0.6277, 0.6277, 0.6277, 0.6277, 0.6277,
                      0.6277, 0.6277, 0.6244]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
ypred tensor([[ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        ...,
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028]], grad_fn=<AddBackward0>)
res: tensor([0.0907, 0.1847, 0.5820, 0.1425], grad_fn=<SoftmaxBackward0>)
label tensor([2])
logit tensor([0.5820], grad_fn=<IndexBackward0>)
mask_without_small tensor([0.6243, 0.6243, 0.6243, 0.6243, 0.6243, 0.6243, 0.6243, 0.6243, 0.6243,
        0.6243, 0.6250, 0.6260, 0.6234, 0.6254, 0.6277, 0.6277, 0.6277, 0.6277,
        0.6277, 0.6277, 0.6277, 0.6277, 0.6277, 0.6244],
       grad_fn=<IndexBackward0>)
pred_loss tensor([0.5412], grad_fn=<MulBackward0>)
size_loss tensor(-0.0003, grad_fn=<MulBackward0>)
size_num_loss 0.72
loss: tensor([1.2610], grad_fn=<AddBackward0>)
5
epoch:  5 ; loss:  1.260969638824463 ; pred:  tensor([0.0907, 0.1847, 0.5820, 0.1425], grad_fn=<SoftmaxBackward0>)
node_idx 5757
masked_adj tensor([0.6019, 0.6019, 0.6019, 0.6019, 0.6019, 0.6019, 0.6019, 0.6019, 0.6019,
        0.6019, 0.6033, 0.6055, 0.6004, 0.6042, 0.6089, 0.6089, 0.6089, 0.6089,
        0.6089, 0.6089, 0.6089, 0.6089, 0.6089, 0.6022],
       grad_fn=<MulBackward0>)
masked_hor tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.6019, 0.6019, 0.6019, 0.6019, 0.6019, 0.6019, 0.6019,
                      0.6019, 0.6019, 0.6019, 0.6033, 0.6055, 0.6004, 0.6042,
                      0.6089, 0.6089, 0.6089, 0.6089, 0.6089, 0.6089, 0.6089,
                      0.6089, 0.6089, 0.6022]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
ypred tensor([[ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        ...,
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028]], grad_fn=<AddBackward0>)
res: tensor([0.0966, 0.1918, 0.5634, 0.1482], grad_fn=<SoftmaxBackward0>)
label tensor([2])
logit tensor([0.5634], grad_fn=<IndexBackward0>)
mask_without_small tensor([0.6019, 0.6019, 0.6019, 0.6019, 0.6019, 0.6019, 0.6019, 0.6019, 0.6019,
        0.6019, 0.6033, 0.6055, 0.6004, 0.6042, 0.6089, 0.6089, 0.6089, 0.6089,
        0.6089, 0.6089, 0.6089, 0.6089, 0.6089, 0.6022],
       grad_fn=<IndexBackward0>)
pred_loss tensor([0.5738], grad_fn=<MulBackward0>)
size_loss tensor(-0.0012, grad_fn=<MulBackward0>)
size_num_loss 0.72
loss: tensor([1.2926], grad_fn=<AddBackward0>)
6
epoch:  6 ; loss:  1.2926268577575684 ; pred:  tensor([0.0966, 0.1918, 0.5634, 0.1482], grad_fn=<SoftmaxBackward0>)
node_idx 5757
masked_adj tensor([0.5797, 0.5797, 0.5797, 0.5797, 0.5797, 0.5797, 0.5797, 0.5797, 0.5797,
        0.5797, 0.5821, 0.5862, 0.5771, 0.5838, 0.5929, 0.5930, 0.5930, 0.5930,
        0.5930, 0.5930, 0.5930, 0.5930, 0.5929, 0.5800],
       grad_fn=<MulBackward0>)
masked_hor tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.5797, 0.5797, 0.5797, 0.5797, 0.5797, 0.5797, 0.5797,
                      0.5797, 0.5797, 0.5797, 0.5821, 0.5862, 0.5771, 0.5838,
                      0.5929, 0.5930, 0.5930, 0.5930, 0.5930, 0.5930, 0.5930,
                      0.5930, 0.5929, 0.5800]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
ypred tensor([[ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        ...,
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028]], grad_fn=<AddBackward0>)
res: tensor([0.1018, 0.1974, 0.5477, 0.1531], grad_fn=<SoftmaxBackward0>)
label tensor([2])
logit tensor([0.5477], grad_fn=<IndexBackward0>)
mask_without_small tensor([0.5797, 0.5797, 0.5797, 0.5797, 0.5797, 0.5797, 0.5797, 0.5797, 0.5797,
        0.5797, 0.5821, 0.5862, 0.5771, 0.5838, 0.5929, 0.5930, 0.5930, 0.5930,
        0.5930, 0.5930, 0.5930, 0.5930, 0.5929, 0.5800],
       grad_fn=<IndexBackward0>)
pred_loss tensor([0.6020], grad_fn=<MulBackward0>)
size_loss tensor(-0.0042, grad_fn=<MulBackward0>)
size_num_loss 0.72
loss: tensor([1.3179], grad_fn=<AddBackward0>)
7
epoch:  7 ; loss:  1.3178703784942627 ; pred:  tensor([0.1018, 0.1974, 0.5477, 0.1531], grad_fn=<SoftmaxBackward0>)
node_idx 5757
masked_adj tensor([0.5576, 0.5576, 0.5576, 0.5576, 0.5576, 0.5576, 0.5576, 0.5576, 0.5576,
        0.5576, 0.5615, 0.5689, 0.5535, 0.5644, 0.5812, 0.5813, 0.5813, 0.5813,
        0.5813, 0.5813, 0.5813, 0.5813, 0.5812, 0.5581],
       grad_fn=<MulBackward0>)
masked_hor tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.5576, 0.5576, 0.5576, 0.5576, 0.5576, 0.5576, 0.5576,
                      0.5576, 0.5576, 0.5576, 0.5615, 0.5689, 0.5535, 0.5644,
                      0.5812, 0.5813, 0.5813, 0.5813, 0.5813, 0.5813, 0.5813,
                      0.5813, 0.5812, 0.5581]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
ypred tensor([[ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        ...,
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028]], grad_fn=<AddBackward0>)
res: tensor([0.1056, 0.2013, 0.5362, 0.1568], grad_fn=<SoftmaxBackward0>)
label tensor([2])
logit tensor([0.5362], grad_fn=<IndexBackward0>)
mask_without_small tensor([0.5576, 0.5576, 0.5576, 0.5576, 0.5576, 0.5576, 0.5576, 0.5576, 0.5576,
        0.5576, 0.5615, 0.5689, 0.5535, 0.5644, 0.5812, 0.5813, 0.5813, 0.5813,
        0.5813, 0.5813, 0.5813, 0.5813, 0.5812, 0.5581],
       grad_fn=<IndexBackward0>)
pred_loss tensor([0.6232], grad_fn=<MulBackward0>)
size_loss tensor(-0.0132, grad_fn=<MulBackward0>)
size_num_loss 0.72
loss: tensor([1.3300], grad_fn=<AddBackward0>)
8
epoch:  8 ; loss:  1.3300106525421143 ; pred:  tensor([0.1056, 0.2013, 0.5362, 0.1568], grad_fn=<SoftmaxBackward0>)
node_idx 5757
masked_adj tensor([0.5356, 0.5356, 0.5356, 0.5356, 0.5356, 0.5356, 0.5356, 0.5356, 0.5356,
        0.5356, 0.5418, 0.5542, 0.5298, 0.5464, 0.5753, 0.5756, 0.5756, 0.5756,
        0.5756, 0.5756, 0.5756, 0.5756, 0.5752, 0.5364],
       grad_fn=<MulBackward0>)
masked_hor tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.5356, 0.5356, 0.5356, 0.5356, 0.5356, 0.5356, 0.5356,
                      0.5356, 0.5356, 0.5356, 0.5418, 0.5542, 0.5298, 0.5464,
                      0.5753, 0.5756, 0.5756, 0.5756, 0.5756, 0.5756, 0.5756,
                      0.5756, 0.5752, 0.5364]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
ypred tensor([[ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        ...,
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028]], grad_fn=<AddBackward0>)
res: tensor([0.1077, 0.2029, 0.5302, 0.1592], grad_fn=<SoftmaxBackward0>)
label tensor([2])
logit tensor([0.5302], grad_fn=<IndexBackward0>)
mask_without_small tensor([0.5356, 0.5356, 0.5356, 0.5356, 0.5356, 0.5356, 0.5356, 0.5356, 0.5356,
        0.5356, 0.5418, 0.5542, 0.5298, 0.5464, 0.5753, 0.5756, 0.5756, 0.5756,
        0.5756, 0.5756, 0.5756, 0.5756, 0.5752, 0.5364],
       grad_fn=<IndexBackward0>)
pred_loss tensor([0.6345], grad_fn=<MulBackward0>)
size_loss tensor(-0.0371, grad_fn=<MulBackward0>)
size_num_loss 0.72
loss: tensor([1.3174], grad_fn=<AddBackward0>)
9
epoch:  9 ; loss:  1.3173553943634033 ; pred:  tensor([0.1077, 0.2029, 0.5302, 0.1592], grad_fn=<SoftmaxBackward0>)
node_idx 5757
masked_adj tensor([0.5136, 0.5136, 0.5136, 0.5136, 0.5136, 0.5136, 0.5136, 0.5136, 0.5136,
        0.5136, 0.5226, 0.5424, 0.5057, 0.5296, 0.5761, 0.5766, 0.5766, 0.5766,
        0.5766, 0.5766, 0.5766, 0.5766, 0.5759, 0.5146],
       grad_fn=<MulBackward0>)
masked_hor tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.5136, 0.5136, 0.5136, 0.5136, 0.5136, 0.5136, 0.5136,
                      0.5136, 0.5136, 0.5136, 0.5226, 0.5424, 0.5057, 0.5296,
                      0.5761, 0.5766, 0.5766, 0.5766, 0.5766, 0.5766, 0.5766,
                      0.5766, 0.5759, 0.5146]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
ypred tensor([[ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        ...,
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028]], grad_fn=<AddBackward0>)
res: tensor([0.1077, 0.2020, 0.5303, 0.1601], grad_fn=<SoftmaxBackward0>)
label tensor([2])
logit tensor([0.5303], grad_fn=<IndexBackward0>)
mask_without_small tensor([0.5136, 0.5136, 0.5136, 0.5136, 0.5136, 0.5136, 0.5136, 0.5136, 0.5136,
        0.5136, 0.5226, 0.5424, 0.5057, 0.5296, 0.5761, 0.5766, 0.5766, 0.5766,
        0.5766, 0.5766, 0.5766, 0.5766, 0.5759, 0.5146],
       grad_fn=<IndexBackward0>)
pred_loss tensor([0.6344], grad_fn=<MulBackward0>)
size_loss tensor(-0.0920, grad_fn=<MulBackward0>)
size_num_loss 0.72
loss: tensor([1.2623], grad_fn=<AddBackward0>)
10
epoch:  10 ; loss:  1.2623424530029297 ; pred:  tensor([0.1077, 0.2020, 0.5303, 0.1601], grad_fn=<SoftmaxBackward0>)
node_idx 5757
masked_adj tensor([0.4913, 0.4913, 0.4913, 0.4913, 0.4913, 0.4913, 0.4913, 0.4913, 0.4913,
        0.4913, 0.5036, 0.5339, 0.4813, 0.5138, 0.5833, 0.5840, 0.5841, 0.5841,
        0.5841, 0.5841, 0.5841, 0.5840, 0.5830, 0.4924],
       grad_fn=<MulBackward0>)
masked_hor tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.4913, 0.4913, 0.4913, 0.4913, 0.4913, 0.4913, 0.4913,
                      0.4913, 0.4913, 0.4913, 0.5036, 0.5339, 0.4813, 0.5138,
                      0.5833, 0.5840, 0.5841, 0.5841, 0.5841, 0.5841, 0.5841,
                      0.5840, 0.5830, 0.4924]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
ypred tensor([[ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        ...,
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028]], grad_fn=<AddBackward0>)
res: tensor([0.1056, 0.1988, 0.5360, 0.1596], grad_fn=<SoftmaxBackward0>)
label tensor([2])
logit tensor([0.5360], grad_fn=<IndexBackward0>)
mask_without_small tensor([0.5036, 0.5339, 0.5138, 0.5833, 0.5840, 0.5841, 0.5841, 0.5841, 0.5841,
        0.5841, 0.5840, 0.5830], grad_fn=<IndexBackward0>)
pred_loss tensor([0.6236], grad_fn=<MulBackward0>)
size_loss tensor(-95.4598, grad_fn=<MulBackward0>)
size_num_loss 1.62
loss: tensor([-93.2162], grad_fn=<AddBackward0>)
11
epoch:  11 ; loss:  -93.21621704101562 ; pred:  tensor([0.1056, 0.1988, 0.5360, 0.1596], grad_fn=<SoftmaxBackward0>)
node_idx 5757
masked_adj tensor([0.4715, 0.4715, 0.4715, 0.4715, 0.4715, 0.4715, 0.4715, 0.4715, 0.4715,
        0.4715, 0.4915, 0.5219, 0.4586, 0.5018, 0.5950, 0.5957, 0.5957, 0.5957,
        0.5957, 0.5957, 0.5957, 0.5957, 0.5947, 0.4729],
       grad_fn=<MulBackward0>)
masked_hor tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.4715, 0.4715, 0.4715, 0.4715, 0.4715, 0.4715, 0.4715,
                      0.4715, 0.4715, 0.4715, 0.4915, 0.5219, 0.4586, 0.5018,
                      0.5950, 0.5957, 0.5957, 0.5957, 0.5957, 0.5957, 0.5957,
                      0.5957, 0.5947, 0.4729]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
ypred tensor([[ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        ...,
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028]], grad_fn=<AddBackward0>)
res: tensor([0.1024, 0.1940, 0.5455, 0.1581], grad_fn=<SoftmaxBackward0>)
label tensor([2])
logit tensor([0.5455], grad_fn=<IndexBackward0>)
mask_without_small tensor([0.5219, 0.5018, 0.5950, 0.5957, 0.5957, 0.5957, 0.5957, 0.5957, 0.5957,
        0.5957, 0.5947], grad_fn=<IndexBackward0>)
pred_loss tensor([0.6060], grad_fn=<MulBackward0>)
size_loss tensor(-116.5744, grad_fn=<MulBackward0>)
size_num_loss 1.71125
loss: tensor([-114.2571], grad_fn=<AddBackward0>)
12
epoch:  12 ; loss:  -114.25713348388672 ; pred:  tensor([0.1024, 0.1940, 0.5455, 0.1581], grad_fn=<SoftmaxBackward0>)
node_idx 5757
masked_adj tensor([0.4543, 0.4543, 0.4543, 0.4543, 0.4543, 0.4543, 0.4543, 0.4543, 0.4543,
        0.4543, 0.4807, 0.5062, 0.4377, 0.4858, 0.6105, 0.6112, 0.6112, 0.6112,
        0.6112, 0.6112, 0.6112, 0.6112, 0.6102, 0.4562],
       grad_fn=<MulBackward0>)
masked_hor tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.4543, 0.4543, 0.4543, 0.4543, 0.4543, 0.4543, 0.4543,
                      0.4543, 0.4543, 0.4543, 0.4807, 0.5062, 0.4377, 0.4858,
                      0.6105, 0.6112, 0.6112, 0.6112, 0.6112, 0.6112, 0.6112,
                      0.6112, 0.6102, 0.4562]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
ypred tensor([[ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        ...,
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028]], grad_fn=<AddBackward0>)
res: tensor([0.0982, 0.1879, 0.5579, 0.1559], grad_fn=<SoftmaxBackward0>)
label tensor([2])
logit tensor([0.5579], grad_fn=<IndexBackward0>)
mask_without_small tensor([0.5062, 0.6105, 0.6112, 0.6112, 0.6112, 0.6112, 0.6112, 0.6112, 0.6112,
        0.6102], grad_fn=<IndexBackward0>)
pred_loss tensor([0.5835], grad_fn=<MulBackward0>)
size_loss tensor(-109.7851, grad_fn=<MulBackward0>)
size_num_loss 1.805
loss: tensor([-107.3966], grad_fn=<AddBackward0>)
13
epoch:  13 ; loss:  -107.39659881591797 ; pred:  tensor([0.0982, 0.1879, 0.5579, 0.1559], grad_fn=<SoftmaxBackward0>)
node_idx 5757
masked_adj tensor([0.4399, 0.4399, 0.4399, 0.4399, 0.4399, 0.4399, 0.4399, 0.4399, 0.4399,
        0.4399, 0.4709, 0.4885, 0.4188, 0.4714, 0.6280, 0.6287, 0.6288, 0.6288,
        0.6288, 0.6288, 0.6288, 0.6287, 0.6277, 0.4425],
       grad_fn=<MulBackward0>)
masked_hor tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.4399, 0.4399, 0.4399, 0.4399, 0.4399, 0.4399, 0.4399,
                      0.4399, 0.4399, 0.4399, 0.4709, 0.4885, 0.4188, 0.4714,
                      0.6280, 0.6287, 0.6288, 0.6288, 0.6288, 0.6288, 0.6288,
                      0.6287, 0.6277, 0.4425]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
ypred tensor([[ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        ...,
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028]], grad_fn=<AddBackward0>)
res: tensor([0.0935, 0.1811, 0.5721, 0.1533], grad_fn=<SoftmaxBackward0>)
label tensor([2])
logit tensor([0.5721], grad_fn=<IndexBackward0>)
mask_without_small tensor([0.6280, 0.6287, 0.6288, 0.6288, 0.6288, 0.6288, 0.6288, 0.6287, 0.6277],
       grad_fn=<IndexBackward0>)
pred_loss tensor([0.5584], grad_fn=<MulBackward0>)
size_loss tensor(-0.0172, grad_fn=<MulBackward0>)
size_num_loss 1.90125
loss: tensor([2.4425], grad_fn=<AddBackward0>)
14
epoch:  14 ; loss:  2.442521572113037 ; pred:  tensor([0.0935, 0.1811, 0.5721, 0.1533], grad_fn=<SoftmaxBackward0>)
node_idx 5757
masked_adj tensor([0.4284, 0.4284, 0.4284, 0.4284, 0.4284, 0.4284, 0.4284, 0.4284, 0.4284,
        0.4284, 0.4621, 0.4724, 0.4020, 0.4585, 0.6432, 0.6444, 0.6444, 0.6444,
        0.6444, 0.6444, 0.6444, 0.6444, 0.6427, 0.4318],
       grad_fn=<MulBackward0>)
masked_hor tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.4284, 0.4284, 0.4284, 0.4284, 0.4284, 0.4284, 0.4284,
                      0.4284, 0.4284, 0.4284, 0.4621, 0.4724, 0.4020, 0.4585,
                      0.6432, 0.6444, 0.6444, 0.6444, 0.6444, 0.6444, 0.6444,
                      0.6444, 0.6427, 0.4318]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
ypred tensor([[ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        ...,
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028]], grad_fn=<AddBackward0>)
res: tensor([0.0895, 0.1750, 0.5848, 0.1508], grad_fn=<SoftmaxBackward0>)
label tensor([2])
logit tensor([0.5848], grad_fn=<IndexBackward0>)
mask_without_small tensor([0.6432, 0.6444, 0.6444, 0.6444, 0.6444, 0.6444, 0.6444, 0.6444, 0.6427],
       grad_fn=<IndexBackward0>)
pred_loss tensor([0.5365], grad_fn=<MulBackward0>)
size_loss tensor(-0.0447, grad_fn=<MulBackward0>)
size_num_loss 1.90125
loss: tensor([2.3930], grad_fn=<AddBackward0>)
15
epoch:  15 ; loss:  2.393004894256592 ; pred:  tensor([0.0895, 0.1750, 0.5848, 0.1508], grad_fn=<SoftmaxBackward0>)
node_idx 5757
masked_adj tensor([0.4196, 0.4196, 0.4196, 0.4196, 0.4196, 0.4196, 0.4196, 0.4196, 0.4196,
        0.4196, 0.4541, 0.4579, 0.3875, 0.4467, 0.6563, 0.6586, 0.6586, 0.6586,
        0.6586, 0.6586, 0.6586, 0.6586, 0.6552, 0.4241],
       grad_fn=<MulBackward0>)
masked_hor tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.4196, 0.4196, 0.4196, 0.4196, 0.4196, 0.4196, 0.4196,
                      0.4196, 0.4196, 0.4196, 0.4541, 0.4579, 0.3875, 0.4467,
                      0.6563, 0.6586, 0.6586, 0.6586, 0.6586, 0.6586, 0.6586,
                      0.6586, 0.6552, 0.4241]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
ypred tensor([[ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        ...,
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028]], grad_fn=<AddBackward0>)
res: tensor([0.0859, 0.1695, 0.5961, 0.1485], grad_fn=<SoftmaxBackward0>)
label tensor([2])
logit tensor([0.5961], grad_fn=<IndexBackward0>)
mask_without_small tensor([0.6563, 0.6586, 0.6586, 0.6586, 0.6586, 0.6586, 0.6586, 0.6586, 0.6552],
       grad_fn=<IndexBackward0>)
pred_loss tensor([0.5173], grad_fn=<MulBackward0>)
size_loss tensor(-0.1627, grad_fn=<MulBackward0>)
size_num_loss 1.90125
loss: tensor([2.2558], grad_fn=<AddBackward0>)
16
epoch:  16 ; loss:  2.2558445930480957 ; pred:  tensor([0.0859, 0.1695, 0.5961, 0.1485], grad_fn=<SoftmaxBackward0>)
node_idx 5757
masked_adj tensor([0.4135, 0.4135, 0.4135, 0.4135, 0.4135, 0.4135, 0.4135, 0.4135, 0.4135,
        0.4135, 0.4468, 0.4448, 0.3752, 0.4362, 0.6669, 0.6715, 0.6715, 0.6715,
        0.6715, 0.6715, 0.6715, 0.6715, 0.6648, 0.4191],
       grad_fn=<MulBackward0>)
masked_hor tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.4135, 0.4135, 0.4135, 0.4135, 0.4135, 0.4135, 0.4135,
                      0.4135, 0.4135, 0.4135, 0.4468, 0.4448, 0.3752, 0.4362,
                      0.6669, 0.6715, 0.6715, 0.6715, 0.6715, 0.6715, 0.6715,
                      0.6715, 0.6648, 0.4191]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
ypred tensor([[ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        ...,
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028]], grad_fn=<AddBackward0>)
res: tensor([0.0828, 0.1646, 0.6063, 0.1464], grad_fn=<SoftmaxBackward0>)
label tensor([2])
logit tensor([0.6063], grad_fn=<IndexBackward0>)
mask_without_small tensor([0.6669, 0.6715, 0.6715, 0.6715, 0.6715, 0.6715, 0.6715, 0.6715, 0.6648],
       grad_fn=<IndexBackward0>)
pred_loss tensor([0.5004], grad_fn=<MulBackward0>)
size_loss tensor(-0.6396, grad_fn=<MulBackward0>)
size_num_loss 1.90125
loss: tensor([1.7621], grad_fn=<AddBackward0>)
17
epoch:  17 ; loss:  1.7620630264282227 ; pred:  tensor([0.0828, 0.1646, 0.6063, 0.1464], grad_fn=<SoftmaxBackward0>)
node_idx 5757
masked_adj tensor([0.4099, 0.4099, 0.4099, 0.4099, 0.4099, 0.4099, 0.4099, 0.4099, 0.4099,
        0.4099, 0.4403, 0.4330, 0.3652, 0.4266, 0.6746, 0.6835, 0.6836, 0.6836,
        0.6836, 0.6836, 0.6836, 0.6835, 0.6702, 0.4168],
       grad_fn=<MulBackward0>)
masked_hor tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.4099, 0.4099, 0.4099, 0.4099, 0.4099, 0.4099, 0.4099,
                      0.4099, 0.4099, 0.4099, 0.4403, 0.4330, 0.3652, 0.4266,
                      0.6746, 0.6835, 0.6836, 0.6836, 0.6836, 0.6836, 0.6836,
                      0.6835, 0.6702, 0.4168]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
ypred tensor([[ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        ...,
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028]], grad_fn=<AddBackward0>)
res: tensor([0.0800, 0.1602, 0.6153, 0.1445], grad_fn=<SoftmaxBackward0>)
label tensor([2])
logit tensor([0.6153], grad_fn=<IndexBackward0>)
mask_without_small tensor([0.6746, 0.6835, 0.6836, 0.6836, 0.6836, 0.6836, 0.6836, 0.6835, 0.6702],
       grad_fn=<IndexBackward0>)
pred_loss tensor([0.4856], grad_fn=<MulBackward0>)
size_loss tensor(-2.5344, grad_fn=<MulBackward0>)
size_num_loss 1.90125
loss: tensor([-0.1476], grad_fn=<AddBackward0>)
18
epoch:  18 ; loss:  -0.14755094051361084 ; pred:  tensor([0.0800, 0.1602, 0.6153, 0.1445], grad_fn=<SoftmaxBackward0>)
node_idx 5757
masked_adj tensor([0.4085, 0.4085, 0.4085, 0.4085, 0.4085, 0.4085, 0.4085, 0.4085, 0.4085,
        0.4085, 0.4344, 0.4223, 0.3573, 0.4180, 0.6779, 0.6954, 0.6955, 0.6955,
        0.6955, 0.6955, 0.6955, 0.6954, 0.6695, 0.4168],
       grad_fn=<MulBackward0>)
masked_hor tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.4085, 0.4085, 0.4085, 0.4085, 0.4085, 0.4085, 0.4085,
                      0.4085, 0.4085, 0.4085, 0.4344, 0.4223, 0.3573, 0.4180,
                      0.6779, 0.6954, 0.6955, 0.6955, 0.6955, 0.6955, 0.6955,
                      0.6954, 0.6695, 0.4168]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
ypred tensor([[ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        ...,
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028]], grad_fn=<AddBackward0>)
res: tensor([0.0776, 0.1563, 0.6234, 0.1427], grad_fn=<SoftmaxBackward0>)
label tensor([2])
logit tensor([0.6234], grad_fn=<IndexBackward0>)
mask_without_small tensor([0.6779, 0.6954, 0.6955, 0.6955, 0.6955, 0.6955, 0.6955, 0.6954, 0.6695],
       grad_fn=<IndexBackward0>)
pred_loss tensor([0.4726], grad_fn=<MulBackward0>)
size_loss tensor(-9.6273, grad_fn=<MulBackward0>)
size_num_loss 1.90125
loss: tensor([-7.2534], grad_fn=<AddBackward0>)
19
epoch:  19 ; loss:  -7.253413200378418 ; pred:  tensor([0.0776, 0.1563, 0.6234, 0.1427], grad_fn=<SoftmaxBackward0>)
node_idx 5757
masked_adj tensor([0.4093, 0.4093, 0.4093, 0.4093, 0.4093, 0.4093, 0.4093, 0.4093, 0.4093,
        0.4093, 0.4290, 0.4127, 0.3515, 0.4102, 0.6750, 0.7079, 0.7081, 0.7081,
        0.7081, 0.7081, 0.7081, 0.7079, 0.6615, 0.4189],
       grad_fn=<MulBackward0>)
masked_hor tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.4093, 0.4093, 0.4093, 0.4093, 0.4093, 0.4093, 0.4093,
                      0.4093, 0.4093, 0.4093, 0.4290, 0.4127, 0.3515, 0.4102,
                      0.6750, 0.7079, 0.7081, 0.7081, 0.7081, 0.7081, 0.7081,
                      0.7079, 0.6615, 0.4189]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
ypred tensor([[ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        ...,
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028]], grad_fn=<AddBackward0>)
res: tensor([0.0754, 0.1526, 0.6308, 0.1411], grad_fn=<SoftmaxBackward0>)
label tensor([2])
logit tensor([0.6308], grad_fn=<IndexBackward0>)
mask_without_small tensor([0.6750, 0.7079, 0.7081, 0.7081, 0.7081, 0.7081, 0.7081, 0.7079, 0.6615],
       grad_fn=<IndexBackward0>)
pred_loss tensor([0.4607], grad_fn=<MulBackward0>)
size_loss tensor(-31.8600, grad_fn=<MulBackward0>)
size_num_loss 1.90125
loss: tensor([-29.4981], grad_fn=<AddBackward0>)
20
epoch:  20 ; loss:  -29.498071670532227 ; pred:  tensor([0.0754, 0.1526, 0.6308, 0.1411], grad_fn=<SoftmaxBackward0>)
node_idx 5757
masked_adj tensor([0.4119, 0.4119, 0.4119, 0.4119, 0.4119, 0.4119, 0.4119, 0.4119, 0.4119,
        0.4119, 0.4241, 0.4040, 0.3476, 0.4031, 0.6653, 0.7219, 0.7221, 0.7221,
        0.7221, 0.7221, 0.7221, 0.7219, 0.6479, 0.4228],
       grad_fn=<MulBackward0>)
masked_hor tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.4119, 0.4119, 0.4119, 0.4119, 0.4119, 0.4119, 0.4119,
                      0.4119, 0.4119, 0.4119, 0.4241, 0.4040, 0.3476, 0.4031,
                      0.6653, 0.7219, 0.7221, 0.7221, 0.7221, 0.7221, 0.7221,
                      0.7219, 0.6479, 0.4228]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
ypred tensor([[ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        ...,
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028]], grad_fn=<AddBackward0>)
res: tensor([0.0733, 0.1490, 0.6384, 0.1393], grad_fn=<SoftmaxBackward0>)
label tensor([2])
logit tensor([0.6384], grad_fn=<IndexBackward0>)
mask_without_small tensor([0.6653, 0.7219, 0.7221, 0.7221, 0.7221, 0.7221, 0.7221, 0.7219, 0.6479],
       grad_fn=<IndexBackward0>)
pred_loss tensor([0.4487], grad_fn=<MulBackward0>)
size_loss tensor(-85.2931, grad_fn=<MulBackward0>)
size_num_loss 1.90125
loss: tensor([-82.9431], grad_fn=<AddBackward0>)
21
epoch:  21 ; loss:  -82.94313049316406 ; pred:  tensor([0.0733, 0.1490, 0.6384, 0.1393], grad_fn=<SoftmaxBackward0>)
node_idx 5757
masked_adj tensor([0.4161, 0.4161, 0.4161, 0.4161, 0.4161, 0.4161, 0.4161, 0.4161, 0.4161,
        0.4161, 0.4197, 0.3961, 0.3457, 0.3967, 0.6506, 0.7377, 0.7379, 0.7379,
        0.7379, 0.7379, 0.7379, 0.7376, 0.6306, 0.4283],
       grad_fn=<MulBackward0>)
masked_hor tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.4161, 0.4161, 0.4161, 0.4161, 0.4161, 0.4161, 0.4161,
                      0.4161, 0.4161, 0.4161, 0.4197, 0.3961, 0.3457, 0.3967,
                      0.6506, 0.7377, 0.7379, 0.7379, 0.7379, 0.7379, 0.7379,
                      0.7376, 0.6306, 0.4283]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
ypred tensor([[ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        ...,
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028]], grad_fn=<AddBackward0>)
res: tensor([0.0710, 0.1452, 0.6466, 0.1372], grad_fn=<SoftmaxBackward0>)
label tensor([2])
logit tensor([0.6466], grad_fn=<IndexBackward0>)
mask_without_small tensor([0.6506, 0.7377, 0.7379, 0.7379, 0.7379, 0.7379, 0.7379, 0.7376, 0.6306],
       grad_fn=<IndexBackward0>)
pred_loss tensor([0.4360], grad_fn=<MulBackward0>)
size_loss tensor(-186.3800, grad_fn=<MulBackward0>)
size_num_loss 1.90125
loss: tensor([-184.0427], grad_fn=<AddBackward0>)
22
epoch:  22 ; loss:  -184.042724609375 ; pred:  tensor([0.0710, 0.1452, 0.6466, 0.1372], grad_fn=<SoftmaxBackward0>)
node_idx 5757
masked_adj tensor([0.4217, 0.4217, 0.4217, 0.4217, 0.4217, 0.4217, 0.4217, 0.4217, 0.4217,
        0.4217, 0.4157, 0.3890, 0.3454, 0.3909, 0.6326, 0.7546, 0.7549, 0.7549,
        0.7549, 0.7549, 0.7549, 0.7545, 0.6108, 0.4350],
       grad_fn=<MulBackward0>)
masked_hor tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.4217, 0.4217, 0.4217, 0.4217, 0.4217, 0.4217, 0.4217,
                      0.4217, 0.4217, 0.4217, 0.4157, 0.3890, 0.3454, 0.3909,
                      0.6326, 0.7546, 0.7549, 0.7549, 0.7549, 0.7549, 0.7549,
                      0.7545, 0.6108, 0.4350]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
ypred tensor([[ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        ...,
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028]], grad_fn=<AddBackward0>)
res: tensor([0.0686, 0.1412, 0.6553, 0.1350], grad_fn=<SoftmaxBackward0>)
label tensor([2])
logit tensor([0.6553], grad_fn=<IndexBackward0>)
mask_without_small tensor([0.6326, 0.7546, 0.7549, 0.7549, 0.7549, 0.7549, 0.7549, 0.7545, 0.6108],
       grad_fn=<IndexBackward0>)
pred_loss tensor([0.4227], grad_fn=<MulBackward0>)
size_loss tensor(-347.6017, grad_fn=<MulBackward0>)
size_num_loss 1.90125
loss: tensor([-345.2777], grad_fn=<AddBackward0>)
23
epoch:  23 ; loss:  -345.2776794433594 ; pred:  tensor([0.0686, 0.1412, 0.6553, 0.1350], grad_fn=<SoftmaxBackward0>)
node_idx 5757
masked_adj tensor([0.4285, 0.4285, 0.4285, 0.4285, 0.4285, 0.4285, 0.4285, 0.4285, 0.4285,
        0.4285, 0.4121, 0.3825, 0.3467, 0.3857, 0.6122, 0.7721, 0.7725, 0.7725,
        0.7725, 0.7725, 0.7725, 0.7720, 0.5889, 0.4427],
       grad_fn=<MulBackward0>)
masked_hor tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.4285, 0.4285, 0.4285, 0.4285, 0.4285, 0.4285, 0.4285,
                      0.4285, 0.4285, 0.4285, 0.4121, 0.3825, 0.3467, 0.3857,
                      0.6122, 0.7721, 0.7725, 0.7725, 0.7725, 0.7725, 0.7725,
                      0.7720, 0.5889, 0.4427]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
ypred tensor([[ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        ...,
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028]], grad_fn=<AddBackward0>)
res: tensor([0.0662, 0.1372, 0.6639, 0.1326], grad_fn=<SoftmaxBackward0>)
label tensor([2])
logit tensor([0.6639], grad_fn=<IndexBackward0>)
mask_without_small tensor([0.6122, 0.7721, 0.7725, 0.7725, 0.7725, 0.7725, 0.7725, 0.7720, 0.5889],
       grad_fn=<IndexBackward0>)
pred_loss tensor([0.4096], grad_fn=<MulBackward0>)
size_loss tensor(-577.5823, grad_fn=<MulBackward0>)
size_num_loss 1.90125
loss: tensor([-575.2714], grad_fn=<AddBackward0>)
24
epoch:  24 ; loss:  -575.2714233398438 ; pred:  tensor([0.0662, 0.1372, 0.6639, 0.1326], grad_fn=<SoftmaxBackward0>)
node_idx 5757
masked_adj tensor([0.4362, 0.4362, 0.4362, 0.4362, 0.4362, 0.4362, 0.4362, 0.4362, 0.4362,
        0.4362, 0.4088, 0.3767, 0.3494, 0.3809, 0.5897, 0.7897, 0.7901, 0.7901,
        0.7901, 0.7901, 0.7901, 0.7896, 0.5651, 0.4511],
       grad_fn=<MulBackward0>)
masked_hor tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.4362, 0.4362, 0.4362, 0.4362, 0.4362, 0.4362, 0.4362,
                      0.4362, 0.4362, 0.4362, 0.4088, 0.3767, 0.3494, 0.3809,
                      0.5897, 0.7897, 0.7901, 0.7901, 0.7901, 0.7901, 0.7901,
                      0.7896, 0.5651, 0.4511]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
ypred tensor([[ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        ...,
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028]], grad_fn=<AddBackward0>)
res: tensor([0.0640, 0.1334, 0.6723, 0.1302], grad_fn=<SoftmaxBackward0>)
label tensor([2])
logit tensor([0.6723], grad_fn=<IndexBackward0>)
mask_without_small tensor([0.5897, 0.7897, 0.7901, 0.7901, 0.7901, 0.7901, 0.7901, 0.7896, 0.5651],
       grad_fn=<IndexBackward0>)
pred_loss tensor([0.3970], grad_fn=<MulBackward0>)
size_loss tensor(-882.4904, grad_fn=<MulBackward0>)
size_num_loss 1.90125
loss: tensor([-880.1921], grad_fn=<AddBackward0>)
25
epoch:  25 ; loss:  -880.192138671875 ; pred:  tensor([0.0640, 0.1334, 0.6723, 0.1302], grad_fn=<SoftmaxBackward0>)
node_idx 5757
masked_adj tensor([0.4446, 0.4446, 0.4446, 0.4446, 0.4446, 0.4446, 0.4446, 0.4446, 0.4446,
        0.4446, 0.4058, 0.3714, 0.3535, 0.3766, 0.5654, 0.8071, 0.8074, 0.8074,
        0.8074, 0.8074, 0.8074, 0.8070, 0.5397, 0.4599],
       grad_fn=<MulBackward0>)
masked_hor tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.4446, 0.4446, 0.4446, 0.4446, 0.4446, 0.4446, 0.4446,
                      0.4446, 0.4446, 0.4446, 0.4058, 0.3714, 0.3535, 0.3766,
                      0.5654, 0.8071, 0.8074, 0.8074, 0.8074, 0.8074, 0.8074,
                      0.8070, 0.5397, 0.4599]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
ypred tensor([[ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        ...,
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028]], grad_fn=<AddBackward0>)
res: tensor([0.0619, 0.1299, 0.6803, 0.1280], grad_fn=<SoftmaxBackward0>)
label tensor([2])
logit tensor([0.6803], grad_fn=<IndexBackward0>)
mask_without_small tensor([0.5654, 0.8071, 0.8074, 0.8074, 0.8074, 0.8074, 0.8074, 0.8070, 0.5397],
       grad_fn=<IndexBackward0>)
pred_loss tensor([0.3853], grad_fn=<MulBackward0>)
size_loss tensor(-1266.5657, grad_fn=<MulBackward0>)
size_num_loss 1.90125
loss: tensor([-1264.2792], grad_fn=<AddBackward0>)
26
epoch:  26 ; loss:  -1264.2791748046875 ; pred:  tensor([0.0619, 0.1299, 0.6803, 0.1280], grad_fn=<SoftmaxBackward0>)
node_idx 5757
masked_adj tensor([0.4534, 0.4534, 0.4534, 0.4534, 0.4534, 0.4534, 0.4534, 0.4534, 0.4534,
        0.4534, 0.4031, 0.3666, 0.3587, 0.3727, 0.5394, 0.8240, 0.8243, 0.8243,
        0.8243, 0.8243, 0.8243, 0.8239, 0.5128, 0.4689],
       grad_fn=<MulBackward0>)
masked_hor tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.4534, 0.4534, 0.4534, 0.4534, 0.4534, 0.4534, 0.4534,
                      0.4534, 0.4534, 0.4534, 0.4031, 0.3666, 0.3587, 0.3727,
                      0.5394, 0.8240, 0.8243, 0.8243, 0.8243, 0.8243, 0.8243,
                      0.8239, 0.5128, 0.4689]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
ypred tensor([[ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        ...,
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028]], grad_fn=<AddBackward0>)
res: tensor([0.0600, 0.1266, 0.6876, 0.1258], grad_fn=<SoftmaxBackward0>)
label tensor([2])
logit tensor([0.6876], grad_fn=<IndexBackward0>)
mask_without_small tensor([0.5394, 0.8240, 0.8243, 0.8243, 0.8243, 0.8243, 0.8243, 0.8239, 0.5128],
       grad_fn=<IndexBackward0>)
pred_loss tensor([0.3746], grad_fn=<MulBackward0>)
size_loss tensor(-1731.9834, grad_fn=<MulBackward0>)
size_num_loss 1.90125
loss: tensor([-1729.7075], grad_fn=<AddBackward0>)
27
epoch:  27 ; loss:  -1729.70751953125 ; pred:  tensor([0.0600, 0.1266, 0.6876, 0.1258], grad_fn=<SoftmaxBackward0>)
node_idx 5757
masked_adj tensor([0.4626, 0.4626, 0.4626, 0.4626, 0.4626, 0.4626, 0.4626, 0.4626, 0.4626,
        0.4626, 0.4006, 0.3623, 0.3648, 0.3692, 0.5121, 0.8402, 0.8405, 0.8405,
        0.8405, 0.8405, 0.8405, 0.8401, 0.4848, 0.4779],
       grad_fn=<MulBackward0>)
masked_hor tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.4626, 0.4626, 0.4626, 0.4626, 0.4626, 0.4626, 0.4626,
                      0.4626, 0.4626, 0.4626, 0.4006, 0.3623, 0.3648, 0.3692,
                      0.5121, 0.8402, 0.8405, 0.8405, 0.8405, 0.8405, 0.8405,
                      0.8401, 0.4848, 0.4779]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
ypred tensor([[ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        ...,
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028]], grad_fn=<AddBackward0>)
res: tensor([0.0583, 0.1237, 0.6941, 0.1239], grad_fn=<SoftmaxBackward0>)
label tensor([2])
logit tensor([0.6941], grad_fn=<IndexBackward0>)
mask_without_small tensor([0.5121, 0.8402, 0.8405, 0.8405, 0.8405, 0.8405, 0.8405, 0.8401],
       grad_fn=<IndexBackward0>)
pred_loss tensor([0.3651], grad_fn=<MulBackward0>)
size_loss tensor(-1347.6962, grad_fn=<MulBackward0>)
size_num_loss 2.0
loss: tensor([-1345.3311], grad_fn=<AddBackward0>)
28
epoch:  28 ; loss:  -1345.3310546875 ; pred:  tensor([0.0583, 0.1237, 0.6941, 0.1239], grad_fn=<SoftmaxBackward0>)
node_idx 5757
masked_adj tensor([0.4717, 0.4717, 0.4717, 0.4717, 0.4717, 0.4717, 0.4717, 0.4717, 0.4717,
        0.4717, 0.3983, 0.3583, 0.3719, 0.3660, 0.4842, 0.8555, 0.8558, 0.8558,
        0.8558, 0.8558, 0.8558, 0.8554, 0.4594, 0.4865],
       grad_fn=<MulBackward0>)
masked_hor tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.4717, 0.4717, 0.4717, 0.4717, 0.4717, 0.4717, 0.4717,
                      0.4717, 0.4717, 0.4717, 0.3983, 0.3583, 0.3719, 0.3660,
                      0.4842, 0.8555, 0.8558, 0.8558, 0.8558, 0.8558, 0.8558,
                      0.8554, 0.4594, 0.4865]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
ypred tensor([[ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        ...,
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028]], grad_fn=<AddBackward0>)
res: tensor([0.0568, 0.1210, 0.7001, 0.1221], grad_fn=<SoftmaxBackward0>)
label tensor([2])
logit tensor([0.7001], grad_fn=<IndexBackward0>)
mask_without_small tensor([0.8555, 0.8558, 0.8558, 0.8558, 0.8558, 0.8558, 0.8554],
       grad_fn=<IndexBackward0>)
pred_loss tensor([0.3565], grad_fn=<MulBackward0>)
size_loss tensor(-0.0032, grad_fn=<MulBackward0>)
size_num_loss 2.10125
loss: tensor([2.4546], grad_fn=<AddBackward0>)
29
epoch:  29 ; loss:  2.4545657634735107 ; pred:  tensor([0.0568, 0.1210, 0.7001, 0.1221], grad_fn=<SoftmaxBackward0>)
Finished Training
masked_ver tensor(indices=tensor([[ 23430,  23444,  23490,  23546,  24301,  24407,  24427,
                         24475,  24503,  24543,  88607, 196312, 229452, 254307,
                        254307, 254307, 254307, 254307, 254307, 254307, 254307,
                        254307, 254307, 328872],
                       [  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,    908,   2227,   1002,   6860,
                          6874,   6920,   6976,   7731,   7837,   7857,   7905,
                          7933,   7973,   5230]]),
       values=tensor([0.4717, 0.4717, 0.4717, 0.4717, 0.4717, 0.4717, 0.4717,
                      0.4717, 0.4717, 0.4717, 0.3983, 0.3583, 0.3719, 0.3660,
                      0.4842, 0.8555, 0.8558, 0.8558, 0.8558, 0.8558, 0.8558,
                      0.8554, 0.4594, 0.4865]),
       size=(753935, 8285), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
sel masked ver tensor(indices=tensor([[5757, 5757, 5757, 5757, 5757, 5757, 5757],
                       [6920, 6976, 7731, 7837, 7857, 7905, 7933]]),
       values=tensor([0.8555, 0.8558, 0.8558, 0.8558, 0.8558, 0.8558, 0.8554]),
       size=(5758, 7934), nnz=7, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
/usr/local/Caskroom/miniconda/base/lib/python3.9/site-packages/networkx/drawing/nx_pylab.py:433: UserWarning: No data for colormapping provided via 'c'. Parameters 'cmap' will be ignored
  node_collection = ax.scatter(
Counter({'publication': 7})
dict index: {}
ypred explain tensor([0.0568, 0.1210, 0.7001, 0.1221], grad_fn=<SoftmaxBackward0>)
ypred full tensor([1.2879e-20, 7.0437e-17, 1.0000e+00, 1.2028e-17],
       grad_fn=<SoftmaxBackward0>)
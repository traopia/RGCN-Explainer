24
start training
masked_hor: tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.8258, 0.8068, 0.7790, 0.0597, 0.0768, 0.0656, 0.0729,
                      0.0631, 0.0751, 0.0690, 0.0702, 0.0745, 0.0664, 0.7362,
                      0.5820, 0.7186, 0.7131, 0.7080, 0.7742, 0.6944, 0.6962,
                      0.7275, 0.6815, 0.7494]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
gt_label_node tensor(2, dtype=torch.int32)
gt_label_node <class 'torch.Tensor'>
logit tensor(0.2903, grad_fn=<SelectBackward0>)
mask_without_small tensor([0.8258, 0.8068, 0.7790, 0.5968, 0.7678, 0.6556, 0.7286, 0.6311, 0.7508,
        0.6904, 0.7022, 0.7445, 0.6636, 0.7362, 0.5820, 0.7186, 0.7131, 0.7080,
        0.7742, 0.6944, 0.6962, 0.7275, 0.6815, 0.7494],
       grad_fn=<IndexBackward0>)
pred_loss tensor(1.2367, grad_fn=<MulBackward0>)
size_loss tensor(-0.3599, grad_fn=<MulBackward0>)
size_num_loss 1440.0
  0%|                                                                                                                | 0/10 [00:00<?, ?it/s]/Users/macoftraopia/Documents/GitHub/RGCN-Explainer/RGCN_stuff/r.py:126: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  adj = torch.tensor(adj)
epoch:  0 ; loss:  1440.8768310546875 ; pred:  tensor([0.2633, 0.2760, 0.2903, 0.1704], grad_fn=<SoftmaxBackward0>)
masked_hor: tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.8866, 0.8732, 0.8532, 0.0473, 0.0845, 0.0536, 0.0816,
                      0.0509, 0.0832, 0.0575, 0.0588, 0.0828, 0.0545, 0.8215,
                      0.4579, 0.8081, 0.8039, 0.5953, 0.8497, 0.5795, 0.5815,
                      0.8148, 0.5648, 0.8314]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
gt_label_node tensor(2, dtype=torch.int32)
gt_label_node <class 'torch.Tensor'>
logit tensor(1., grad_fn=<SelectBackward0>)
mask_without_small tensor([0.8866, 0.8732, 0.8532, 0.8450, 0.5358, 0.8157, 0.5092, 0.8324, 0.5749,
        0.5885, 0.8277, 0.5447, 0.8215, 0.8081, 0.8039, 0.5953, 0.8497, 0.5795,
        0.5815, 0.8148, 0.5648, 0.8314], grad_fn=<IndexBackward0>)
pred_loss tensor(-0., grad_fn=<MulBackward0>)
size_loss tensor(-1937.3950, grad_fn=<MulBackward0>)
size_num_loss 1690.0
 10%|██████████▍                                                                                             | 1/10 [00:23<03:35, 23.92s/it]
masked_hor: tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.9190, 0.9090, 0.8940, 0.0391, 0.0888, 0.0443, 0.0865,
                      0.0417, 0.0878, 0.0482, 0.0496, 0.0875, 0.0452, 0.8697,
                      0.3766, 0.8593, 0.8560, 0.5034, 0.8913, 0.4871, 0.4893,
                      0.8646, 0.4722, 0.8774]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
gt_label_node tensor(2, dtype=torch.int32)
gt_label_node <class 'torch.Tensor'>
logit tensor(1., grad_fn=<SelectBackward0>)
mask_without_small tensor([0.9190, 0.9090, 0.8940, 0.8878, 0.8653, 0.8781, 0.8746, 0.8697, 0.8593,
        0.8560, 0.5034, 0.8913, 0.8646, 0.8774], grad_fn=<IndexBackward0>)
pred_loss tensor(-0., grad_fn=<MulBackward0>)
size_loss tensor(-1048.8651, grad_fn=<MulBackward0>)

 20%|████████████████████▊                                                                                   | 2/10 [00:46<03:06, 23.28s/it]
epoch:  2 ; loss:  1841.1348876953125 ; pred:  tensor([5.6651e-23, 5.8778e-22, 1.0000e+00, 4.5391e-22],
       grad_fn=<SoftmaxBackward0>)
masked_hor: tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.9441, 0.9367, 0.9252, 0.0331, 0.0920, 0.0374, 0.0900,
                      0.0349, 0.0912, 0.0411, 0.0425, 0.0909, 0.0382, 0.9043,
                      0.3180, 0.8932, 0.8892, 0.4109, 0.9231, 0.4160, 0.4181,
                      0.8990, 0.4016, 0.9113]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
gt_label_node tensor(2, dtype=torch.int32)
gt_label_node <class 'torch.Tensor'>
logit tensor(1., grad_fn=<SelectBackward0>)
mask_without_small tensor([0.9441, 0.9367, 0.9252, 0.9202, 0.8998, 0.9120, 0.9088, 0.9043, 0.8932,
        0.8892, 0.9231, 0.8990, 0.9113], grad_fn=<IndexBackward0>)
pred_loss tensor(-0., grad_fn=<MulBackward0>)
size_loss tensor(-27.1649, grad_fn=<MulBackward0>)


 40%|█████████████████████████████████████████▌                                                              | 4/10 [01:32<02:16, 22.80s/it]
masked_hor: tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.9606, 0.9550, 0.9455, 0.0286, 0.0941, 0.0320, 0.0919,
                      0.0298, 0.0933, 0.0356, 0.0369, 0.0930, 0.0328, 0.9243,
                      0.2739, 0.9091, 0.9026, 0.3394, 0.9436, 0.3601, 0.3621,
                      0.9176, 0.3465, 0.9323]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
gt_label_node tensor(2, dtype=torch.int32)
gt_label_node <class 'torch.Tensor'>
logit tensor(1., grad_fn=<SelectBackward0>)
mask_without_small tensor([0.9606, 0.9550, 0.9455, 0.9410, 0.9186, 0.9330, 0.9296, 0.9243, 0.9091,
        0.9026, 0.9436, 0.9176, 0.9323], grad_fn=<IndexBackward0>)
pred_loss tensor(-0., grad_fn=<MulBackward0>)
size_loss tensor(-29.9013, grad_fn=<MulBackward0>)
size_num_loss 3062.5
epoch:  4 ; loss:  3032.5986328125 ; pred:  tensor([0.0000e+00, 1.4013e-45, 1.0000e+00, 1.4013e-45],
       grad_fn=<SoftmaxBackward0>)
masked_hor: tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.9716, 0.9671, 0.9592, 0.0251, 0.0955, 0.0279, 0.0930,
                      0.0258, 0.0947, 0.0312, 0.0324, 0.0943, 0.0286, 0.9372,
                      0.2397, 0.9156, 0.9050, 0.2840, 0.9575, 0.3156, 0.3175,
                      0.9283, 0.3029, 0.9464]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
gt_label_node tensor(2, dtype=torch.int32)
gt_label_node <class 'torch.Tensor'>
logit tensor(1., grad_fn=<SelectBackward0>)
mask_without_small tensor([0.9716, 0.9671, 0.9592, 0.9551, 0.9296, 0.9472, 0.9434, 0.9372, 0.9156,
        0.9050, 0.9575, 0.9283, 0.9464], grad_fn=<IndexBackward0>)
pred_loss tensor(-0., grad_fn=<MulBackward0>)
size_loss tensor(-38.9588, grad_fn=<MulBackward0>)

 50%|████████████████████████████████████████████████████                                                    | 5/10 [01:53<01:51, 22.35s/it]
masked_hor: tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.9790, 0.9755, 0.9688, 0.0223, 0.0965, 0.0246, 0.0936,
                      0.0226, 0.0957, 0.0276, 0.0287, 0.0953, 0.0252, 0.9460,
                      0.2127, 0.9155, 0.8980, 0.2409, 0.9673, 0.2798, 0.2815,
                      0.9345, 0.2679, 0.9565]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
gt_label_node tensor(2, dtype=torch.int32)
gt_label_node <class 'torch.Tensor'>
logit tensor(1., grad_fn=<SelectBackward0>)
mask_without_small tensor([0.9790, 0.9755, 0.9688, 0.9651, 0.9363, 0.9573, 0.9533, 0.9460, 0.9155,
        0.8980, 0.9673, 0.9345, 0.9565], grad_fn=<IndexBackward0>)
pred_loss tensor(-0., grad_fn=<MulBackward0>)
size_loss tensor(-56.7661, grad_fn=<MulBackward0>)

 60%|██████████████████████████████████████████████████████████████▍                                         | 6/10 [02:14<01:27, 21.94s/it]
epoch:  6 ; loss:  3005.73388671875 ; pred:  tensor([0., 0., 1., 0.], grad_fn=<SoftmaxBackward0>)
masked_hor: tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.9841, 0.9813, 0.9757, 0.0201, 0.0972, 0.0219, 0.0940,
                      0.0201, 0.0965, 0.0247, 0.0258, 0.0961, 0.0225, 0.9524,
                      0.1910, 0.9092, 0.8799, 0.2071, 0.9744, 0.2506, 0.2522,
                      0.9378, 0.2395, 0.9640]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
gt_label_node tensor(2, dtype=torch.int32)
gt_label_node <class 'torch.Tensor'>
logit tensor(1., grad_fn=<SelectBackward0>)
mask_without_small tensor([0.9841, 0.9813, 0.9757, 0.9724, 0.9402, 0.9649, 0.9606, 0.9524, 0.9092,
        0.8799, 0.9744, 0.9378, 0.9640], grad_fn=<IndexBackward0>)
pred_loss tensor(-0., grad_fn=<MulBackward0>)
size_loss tensor(-92.3820, grad_fn=<MulBackward0>)

 70%|████████████████████████████████████████████████████████████████████████▊                               | 7/10 [02:37<01:07, 22.36s/it]
masked_hor: tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.9877, 0.9855, 0.9808, 0.0182, 0.0978, 0.0197, 0.0942,
                      0.0181, 0.0971, 0.0223, 0.0233, 0.0966, 0.0203, 0.9574,
                      0.1733, 0.8949, 0.8470, 0.1803, 0.9796, 0.2266, 0.2281,
                      0.9389, 0.2163, 0.9699]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
gt_label_node tensor(2, dtype=torch.int32)
gt_label_node <class 'torch.Tensor'>
logit tensor(1., grad_fn=<SelectBackward0>)
mask_without_small tensor([0.9877, 0.9855, 0.9808, 0.9779, 0.9422, 0.9708, 0.9665, 0.9574, 0.8949,
        0.8470, 0.9796, 0.9389, 0.9699], grad_fn=<IndexBackward0>)
pred_loss tensor(-0., grad_fn=<MulBackward0>)
size_loss tensor(-167.2511, grad_fn=<MulBackward0>)

 80%|███████████████████████████████████████████████████████████████████████████████████▏                    | 8/10 [03:02<00:46, 23.09s/it]
epoch:  8 ; loss:  2895.2490234375 ; pred:  tensor([0., 0., 1., 0.], grad_fn=<SoftmaxBackward0>)
masked_hor: tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.9903, 0.9885, 0.9846, 0.0167, 0.0982, 0.0179, 0.0943,
                      0.0164, 0.0975, 0.0204, 0.0213, 0.0971, 0.0184, 0.9616,
                      0.1586, 0.8692, 0.7963, 0.1588, 0.9836, 0.2067, 0.2081,
                      0.9384, 0.1971, 0.9747]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
gt_label_node tensor(2, dtype=torch.int32)
gt_label_node <class 'torch.Tensor'>
logit tensor(1., grad_fn=<SelectBackward0>)
mask_without_small tensor([0.9903, 0.9885, 0.9846, 0.9821, 0.9429, 0.9755, 0.9712, 0.9616, 0.8692,
        0.7963, 0.9836, 0.9384, 0.9747], grad_fn=<IndexBackward0>)
pred_loss tensor(-0., grad_fn=<MulBackward0>)
size_loss tensor(-321.9904, grad_fn=<MulBackward0>)

 90%|█████████████████████████████████████████████████████████████████████████████████████████████▌          | 9/10 [03:28<00:24, 24.13s/it]
sel masked ver tensor(indices=tensor([[6860, 6874, 6920, 7731, 7857, 7933, 5757, 5757],
                       [5757, 5757, 5757, 5757, 5757, 5757, 2227, 5230]]),
       values=tensor([0.9903, 0.9885, 0.9846, 0.9821, 0.9429, 0.9755, 0.9712,
                      0.9747]),
       size=(7934, 5758), nnz=8, layout=torch.sparse_coo,

100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [03:51<00:00, 23.12s/it]
Counter({'author': 6, 'name': 1, 'type': 1})
dict index: {}
/usr/local/Caskroom/miniconda/base/lib/python3.9/site-packages/networkx/drawing/nx_pylab.py:433: UserWarning: No data for colormapping provided via 'c'. Parameters 'cmap' will be ignored
  node_collection = ax.scatter(
ypred explain tensor([0., 0., 1., 0.], grad_fn=<SoftmaxBackward0>)
ypred full tensor([0.0905, 0.1411, 0.7186, 0.0498], grad_fn=<SoftmaxBackward0>)
original label [2]
num mislabel 1
num correct 34
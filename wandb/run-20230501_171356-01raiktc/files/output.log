24
start training
masked_hor: tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.8258, 0.8068, 0.7790, 0.0597, 0.0768, 0.0656, 0.0729,
                      0.0631, 0.0751, 0.0690, 0.0702, 0.0745, 0.0664, 0.7362,
                      0.5820, 0.7186, 0.7131, 0.7080, 0.7742, 0.6944, 0.6962,
                      0.7275, 0.6815, 0.7494]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
gt_label_node tensor(2, dtype=torch.int32)
gt_label_node <class 'torch.Tensor'>
logit tensor(0.2903, grad_fn=<SelectBackward0>)
mask_without_small tensor([0.8258, 0.8068, 0.7790, 0.5968, 0.7678, 0.6556, 0.7286, 0.6311, 0.7508,
        0.6904, 0.7022, 0.7445, 0.6636, 0.7362, 0.5820, 0.7186, 0.7131, 0.7080,
        0.7742, 0.6944, 0.6962, 0.7275, 0.6815, 0.7494],
       grad_fn=<IndexBackward0>)
num_high 24
pred_loss tensor(1.2367, grad_fn=<MulBackward0>)
size_loss tensor(1.6764, grad_fn=<AddBackward0>)
size_num_loss 1.0
  0%|                                                                                                                | 0/10 [00:00<?, ?it/s]/Users/macoftraopia/Documents/GitHub/RGCN-Explainer/RGCN_stuff/r.py:126: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  adj = torch.tensor(adj)
epoch:  0 ; loss:  3.9130866527557373 ; pred:  tensor([0.2633, 0.2760, 0.2903, 0.1704], grad_fn=<SoftmaxBackward0>)
masked_hor: tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.7420, 0.7169, 0.6814, 0.0473, 0.0667, 0.0536, 0.0620,
                      0.0509, 0.0646, 0.0575, 0.0588, 0.0828, 0.0545, 0.6286,
                      0.4579, 0.6076, 0.6012, 0.5953, 0.6752, 0.5795, 0.5815,
                      0.6182, 0.5648, 0.6446]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
gt_label_node tensor(2, dtype=torch.int32)
gt_label_node <class 'torch.Tensor'>
logit tensor(1., grad_fn=<SelectBackward0>)
mask_without_small tensor([0.7420, 0.7169, 0.6814, 0.6673, 0.5358, 0.6195, 0.5092, 0.6463, 0.5749,
        0.5885, 0.8277, 0.5447, 0.6286, 0.6076, 0.6012, 0.5953, 0.6752, 0.5795,
        0.5815, 0.6182, 0.5648, 0.6446], grad_fn=<IndexBackward0>)
num_high 22
pred_loss tensor(-0., grad_fn=<MulBackward0>)
size_loss tensor(-46.7637, grad_fn=<AddBackward0>)
size_num_loss 0.9166666666666666
 10%|██████████▍                                                                                             | 1/10 [00:23<03:29, 23.22s/it]
masked_hor: tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.8066, 0.7861, 0.7562, 0.0391, 0.0744, 0.0443, 0.0528,
                      0.0417, 0.0726, 0.0482, 0.0496, 0.0875, 0.0452, 0.7094,
                      0.3766, 0.5161, 0.5094, 0.5033, 0.7510, 0.4870, 0.4891,
                      0.5269, 0.4721, 0.7241]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
gt_label_node tensor(2, dtype=torch.int32)
gt_label_node <class 'torch.Tensor'>
logit tensor(1., grad_fn=<SelectBackward0>)
mask_without_small tensor([0.8066, 0.7861, 0.7562, 0.7441, 0.5278, 0.7259, 0.8746, 0.7094, 0.5161,
        0.5094, 0.5033, 0.7510, 0.5269, 0.7241], grad_fn=<IndexBackward0>)
num_high 14
pred_loss tensor(-0., grad_fn=<MulBackward0>)
size_loss tensor(-163.4250, grad_fn=<AddBackward0>)

 20%|████████████████████▊                                                                                   | 2/10 [00:45<03:02, 22.80s/it]
epoch:  2 ; loss:  -162.84165954589844 ; pred:  tensor([4.2985e-21, 4.1592e-20, 1.0000e+00, 2.3629e-20],
       grad_fn=<SoftmaxBackward0>)
masked_hor: tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.8646, 0.8487, 0.8245, 0.0331, 0.0814, 0.0374, 0.0446,
                      0.0349, 0.0796, 0.0411, 0.0425, 0.0915, 0.0382, 0.7737,
                      0.3180, 0.4321, 0.4242, 0.4171, 0.8200, 0.4158, 0.4179,
                      0.4452, 0.4014, 0.7941]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
gt_label_node tensor(2, dtype=torch.int32)
gt_label_node <class 'torch.Tensor'>
logit tensor(1., grad_fn=<SelectBackward0>)
mask_without_small tensor([0.8646, 0.8487, 0.8245, 0.8140, 0.7960, 0.9146, 0.7737, 0.8200, 0.7941],
       grad_fn=<IndexBackward0>)
num_high 9
pred_loss tensor(-0., grad_fn=<MulBackward0>)
size_loss tensor(-14.6035, grad_fn=<AddBackward0>)

 30%|███████████████████████████████▏                                                                        | 3/10 [01:08<02:40, 22.86s/it]
masked_hor: tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.9063, 0.8929, 0.8666, 0.0286, 0.0850, 0.0320, 0.0382,
                      0.0297, 0.0806, 0.0355, 0.0369, 0.0943, 0.0328, 0.7457,
                      0.2739, 0.3658, 0.3575, 0.3499, 0.8601, 0.3599, 0.3618,
                      0.3802, 0.3462, 0.8005]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
gt_label_node tensor(2, dtype=torch.int32)
gt_label_node <class 'torch.Tensor'>
logit tensor(1., grad_fn=<SelectBackward0>)
mask_without_small tensor([0.9063, 0.8929, 0.8666, 0.8497, 0.8059, 0.9429, 0.7457, 0.8601, 0.8005],
       grad_fn=<IndexBackward0>)
num_high 9
pred_loss tensor(-0., grad_fn=<MulBackward0>)
size_loss tensor(-32.7265, grad_fn=<AddBackward0>)

 40%|█████████████████████████████████████████▌                                                              | 4/10 [01:30<02:15, 22.59s/it]
epoch:  4 ; loss:  -32.35149383544922 ; pred:  tensor([1.1252e-42, 2.8396e-41, 1.0000e+00, 1.2040e-41],
       grad_fn=<SoftmaxBackward0>)
masked_hor: tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.9359, 0.9254, 0.8990, 0.0251, 0.0874, 0.0278, 0.0330,
                      0.0257, 0.0783, 0.0311, 0.0324, 0.0962, 0.0285, 0.6844,
                      0.2397, 0.3135, 0.3049, 0.2973, 0.8904, 0.3153, 0.3171,
                      0.3284, 0.3026, 0.7719]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
gt_label_node tensor(2, dtype=torch.int32)
gt_label_node <class 'torch.Tensor'>
logit tensor(1., grad_fn=<SelectBackward0>)
mask_without_small tensor([0.9359, 0.9254, 0.8990, 0.8740, 0.7826, 0.9619, 0.6844, 0.8904, 0.7719],
       grad_fn=<IndexBackward0>)
num_high 9
pred_loss tensor(-0., grad_fn=<MulBackward0>)
size_loss tensor(-80.6491, grad_fn=<AddBackward0>)

 50%|████████████████████████████████████████████████████                                                    | 5/10 [01:52<01:51, 22.36s/it]
masked_hor: tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.9567, 0.9490, 0.9261, 0.0223, 0.0897, 0.0245, 0.0288,
                      0.0226, 0.0732, 0.0276, 0.0287, 0.0974, 0.0251, 0.6026,
                      0.2127, 0.2718, 0.2633, 0.2559, 0.9170, 0.2794, 0.2811,
                      0.2868, 0.2676, 0.7156]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
gt_label_node tensor(2, dtype=torch.int32)
gt_label_node <class 'torch.Tensor'>
logit tensor(1., grad_fn=<SelectBackward0>)
mask_without_small tensor([0.9567, 0.9490, 0.9261, 0.8966, 0.7316, 0.9743, 0.6026, 0.9170, 0.7156],
       grad_fn=<IndexBackward0>)
num_high 9
pred_loss tensor(-0., grad_fn=<MulBackward0>)
size_loss tensor(-174.1227, grad_fn=<AddBackward0>)

 60%|██████████████████████████████████████████████████████████████▍                                         | 6/10 [02:13<01:27, 21.97s/it]
epoch:  6 ; loss:  -173.74766540527344 ; pred:  tensor([0., 0., 1., 0.], grad_fn=<SoftmaxBackward0>)
masked_hor: tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.9709, 0.9657, 0.9482, 0.0201, 0.0920, 0.0219, 0.0255,
                      0.0201, 0.0658, 0.0247, 0.0257, 0.0983, 0.0224, 0.5068,
                      0.1910, 0.2384, 0.2301, 0.2229, 0.9402, 0.2502, 0.2518,
                      0.2532, 0.2392, 0.6381]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
gt_label_node tensor(2, dtype=torch.int32)
gt_label_node <class 'torch.Tensor'>
logit tensor(1., grad_fn=<SelectBackward0>)
mask_without_small tensor([0.9709, 0.9657, 0.9482, 0.9199, 0.6583, 0.9825, 0.5068, 0.9402, 0.6381],
       grad_fn=<IndexBackward0>)
num_high 9
pred_loss tensor(-0., grad_fn=<MulBackward0>)
size_loss tensor(-328.8665, grad_fn=<AddBackward0>)

 70%|████████████████████████████████████████████████████████████████████████▊                               | 7/10 [02:36<01:06, 22.26s/it]
masked_hor: tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.9805, 0.9771, 0.9648, 0.0182, 0.0942, 0.0197, 0.0227,
                      0.0180, 0.0568, 0.0223, 0.0233, 0.0988, 0.0202, 0.4045,
                      0.1733, 0.2114, 0.2034, 0.1965, 0.9587, 0.2262, 0.2277,
                      0.2258, 0.2160, 0.5453]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
gt_label_node tensor(2, dtype=torch.int32)
gt_label_node <class 'torch.Tensor'>
logit tensor(1., grad_fn=<SelectBackward0>)
mask_without_small tensor([0.9805, 0.9771, 0.9648, 0.9416, 0.5684, 0.9879, 0.9587, 0.5453],
       grad_fn=<IndexBackward0>)
num_high 8
pred_loss tensor(-0., grad_fn=<MulBackward0>)
size_loss tensor(-361.9984, grad_fn=<AddBackward0>)

 80%|███████████████████████████████████████████████████████████████████████████████████▏                    | 8/10 [02:58<00:44, 22.13s/it]
epoch:  8 ; loss:  -361.6650085449219 ; pred:  tensor([0., 0., 1., 0.], grad_fn=<SoftmaxBackward0>)
masked_hor: tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.9867, 0.9847, 0.9765, 0.0167, 0.0959, 0.0179, 0.0205,
                      0.0164, 0.0473, 0.0203, 0.0213, 0.0991, 0.0184, 0.3200,
                      0.1586, 0.1893, 0.1817, 0.1751, 0.9721, 0.2063, 0.2077,
                      0.2033, 0.1968, 0.4484]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
gt_label_node tensor(2, dtype=torch.int32)
gt_label_node <class 'torch.Tensor'>
logit tensor(1., grad_fn=<SelectBackward0>)
mask_without_small tensor([0.9867, 0.9847, 0.9765, 0.9590, 0.9915, 0.9721],
       grad_fn=<IndexBackward0>)
num_high 6
pred_loss tensor(-0., grad_fn=<MulBackward0>)
size_loss tensor(1.5408, grad_fn=<AddBackward0>)

 90%|█████████████████████████████████████████████████████████████████████████████████████████████▌          | 9/10 [03:21<00:22, 22.35s/it]
sel masked ver tensor(indices=tensor([[6860, 6874, 6920, 7731, 5757],
                       [5757, 5757, 5757, 5757, 2227]]),
       values=tensor([0.9867, 0.9847, 0.9765, 0.9590, 0.9915]),
       size=(7732, 5758), nnz=5, layout=torch.sparse_coo,

100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [03:43<00:00, 22.39s/it]
Counter({'author': 4, 'name': 1})
dict index: {}
/usr/local/Caskroom/miniconda/base/lib/python3.9/site-packages/networkx/drawing/nx_pylab.py:433: UserWarning: No data for colormapping provided via 'c'. Parameters 'cmap' will be ignored
  node_collection = ax.scatter(
ypred explain tensor([0., 0., 1., 0.], grad_fn=<SoftmaxBackward0>)
ypred full tensor([0.0905, 0.1411, 0.7186, 0.0498], grad_fn=<SoftmaxBackward0>)
original label [2]
num mislabel 1
num correct 34
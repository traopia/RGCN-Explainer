node_idx 5757
masked_adj tensor([0.7311, 0.7311, 0.7311, 0.7311, 0.7311, 0.7311, 0.7311, 0.7311, 0.7311,
        0.7311, 0.7311, 0.7311, 0.7311, 0.7311, 0.7311, 0.7311, 0.7311, 0.7311,
        0.7311, 0.7311, 0.7311, 0.7311, 0.7311, 0.7311],
       grad_fn=<MulBackward0>)
masked_hor tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.7311, 0.7311, 0.7311, 0.7311, 0.7311, 0.7311, 0.7311,
                      0.7311, 0.7311, 0.7311, 0.7311, 0.7311, 0.7311, 0.7311,
                      0.7311, 0.7311, 0.7311, 0.7311, 0.7311, 0.7311, 0.7311,
                      0.7311, 0.7311, 0.7311]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
ypred tensor([[ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        ...,
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028]], grad_fn=<AddBackward0>)
res: tensor([0.0609, 0.1418, 0.6873, 0.1100], grad_fn=<SoftmaxBackward0>)
label tensor([2])
logit tensor([0.6873], grad_fn=<IndexBackward0>)
mask_without_small tensor([0.7311, 0.7311, 0.7311, 0.7311, 0.7311, 0.7311, 0.7311, 0.7311, 0.7311,
        0.7311, 0.7311, 0.7311, 0.7311, 0.7311, 0.7311, 0.7311, 0.7311, 0.7311,
        0.7311, 0.7311, 0.7311, 0.7311, 0.7311, 0.7311],
       grad_fn=<IndexBackward0>)
pred_loss tensor([0.3750], grad_fn=<MulBackward0>)
size_loss tensor(-3.7072e-13, grad_fn=<MulBackward0>)
size_num_loss 0.72
loss: tensor([1.0950], grad_fn=<AddBackward0>)
[34m[1mwandb[39m[22m: [33mWARNING[39m Calling wandb.login() after wandb.init() has no effect.
/Users/macoftraopia/Documents/GitHub/RGCN-Explainer/RGCN_stuff/r_exp.py:222: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  adj = torch.tensor(adj)
/Users/macoftraopia/Documents/GitHub/RGCN-Explainer/RGCN_stuff/r_exp.py:248: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  adj = torch.tensor(adj)
0
epoch:  0 ; loss:  1.095016360282898 ; pred:  tensor([0.0609, 0.1418, 0.6873, 0.1100], grad_fn=<SoftmaxBackward0>)
node_idx 5757
masked_adj tensor([0.7109, 0.7109, 0.7109, 0.7109, 0.7109, 0.7109, 0.7109, 0.7109, 0.7109,
        0.7109, 0.7503, 0.7503, 0.7109, 0.7503, 0.7503, 0.7503, 0.7503, 0.7503,
        0.7503, 0.7503, 0.7503, 0.7503, 0.7503, 0.7503],
       grad_fn=<MulBackward0>)
masked_hor tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.7109, 0.7109, 0.7109, 0.7109, 0.7109, 0.7109, 0.7109,
                      0.7109, 0.7109, 0.7109, 0.7503, 0.7503, 0.7109, 0.7503,
                      0.7503, 0.7503, 0.7503, 0.7503, 0.7503, 0.7503, 0.7503,
                      0.7503, 0.7503, 0.7503]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
ypred tensor([[ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        ...,
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028]], grad_fn=<AddBackward0>)
res: tensor([0.0555, 0.1320, 0.7089, 0.1035], grad_fn=<SoftmaxBackward0>)
label tensor([2])
logit tensor([0.7089], grad_fn=<IndexBackward0>)
mask_without_small tensor([0.7109, 0.7109, 0.7109, 0.7109, 0.7109, 0.7109, 0.7109, 0.7109, 0.7109,
        0.7109, 0.7503, 0.7503, 0.7109, 0.7503, 0.7503, 0.7503, 0.7503, 0.7503,
        0.7503, 0.7503, 0.7503, 0.7503, 0.7503, 0.7503],
       grad_fn=<IndexBackward0>)
pred_loss tensor([0.3440], grad_fn=<MulBackward0>)
size_loss tensor(-0.0400, grad_fn=<MulBackward0>)
size_num_loss 0.72
loss: tensor([1.0239], grad_fn=<AddBackward0>)
1
epoch:  1 ; loss:  1.0239388942718506 ; pred:  tensor([0.0555, 0.1320, 0.7089, 0.1035], grad_fn=<SoftmaxBackward0>)
node_idx 5757
masked_adj tensor([0.6951, 0.6951, 0.6951, 0.6951, 0.6951, 0.6951, 0.6951, 0.6951, 0.6951,
        0.6951, 0.7662, 0.7673, 0.6918, 0.7671, 0.7680, 0.7680, 0.7680, 0.7680,
        0.7680, 0.7680, 0.7680, 0.7680, 0.7680, 0.7651],
       grad_fn=<MulBackward0>)
masked_hor tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.6951, 0.6951, 0.6951, 0.6951, 0.6951, 0.6951, 0.6951,
                      0.6951, 0.6951, 0.6951, 0.7662, 0.7673, 0.6918, 0.7671,
                      0.7680, 0.7680, 0.7680, 0.7680, 0.7680, 0.7680, 0.7680,
                      0.7680, 0.7680, 0.7651]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
ypred tensor([[ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        ...,
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028]], grad_fn=<AddBackward0>)
res: tensor([0.0509, 0.1232, 0.7284, 0.0975], grad_fn=<SoftmaxBackward0>)
label tensor([2])
logit tensor([0.7284], grad_fn=<IndexBackward0>)
mask_without_small tensor([0.6951, 0.6951, 0.6951, 0.6951, 0.6951, 0.6951, 0.6951, 0.6951, 0.6951,
        0.6951, 0.7662, 0.7673, 0.6918, 0.7671, 0.7680, 0.7680, 0.7680, 0.7680,
        0.7680, 0.7680, 0.7680, 0.7680, 0.7680, 0.7651],
       grad_fn=<IndexBackward0>)
pred_loss tensor([0.3170], grad_fn=<MulBackward0>)
size_loss tensor(-0.1371, grad_fn=<MulBackward0>)
size_num_loss 0.72
loss: tensor([0.8999], grad_fn=<AddBackward0>)
2
epoch:  2 ; loss:  0.8998736143112183 ; pred:  tensor([0.0509, 0.1232, 0.7284, 0.0975], grad_fn=<SoftmaxBackward0>)
node_idx 5757
masked_adj tensor([0.6770, 0.6770, 0.6770, 0.6770, 0.6770, 0.6770, 0.6770, 0.6770, 0.6770,
        0.6770, 0.7820, 0.7837, 0.6719, 0.7833, 0.7848, 0.7848, 0.7848, 0.7848,
        0.7848, 0.7848, 0.7848, 0.7848, 0.7848, 0.7805],
       grad_fn=<MulBackward0>)
masked_hor tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.6770, 0.6770, 0.6770, 0.6770, 0.6770, 0.6770, 0.6770,
                      0.6770, 0.6770, 0.6770, 0.7820, 0.7837, 0.6719, 0.7833,
                      0.7848, 0.7848, 0.7848, 0.7848, 0.7848, 0.7848, 0.7848,
                      0.7848, 0.7848, 0.7805]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
ypred tensor([[ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        ...,
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028]], grad_fn=<AddBackward0>)
res: tensor([0.0467, 0.1149, 0.7465, 0.0919], grad_fn=<SoftmaxBackward0>)
label tensor([2])
logit tensor([0.7465], grad_fn=<IndexBackward0>)
mask_without_small tensor([0.6770, 0.6770, 0.6770, 0.6770, 0.6770, 0.6770, 0.6770, 0.6770, 0.6770,
        0.6770, 0.7820, 0.7837, 0.6719, 0.7833, 0.7848, 0.7848, 0.7848, 0.7848,
        0.7848, 0.7848, 0.7848, 0.7848, 0.7848, 0.7805],
       grad_fn=<IndexBackward0>)
pred_loss tensor([0.2924], grad_fn=<MulBackward0>)
size_loss tensor(-0.2997, grad_fn=<MulBackward0>)
size_num_loss 0.72
loss: tensor([0.7127], grad_fn=<AddBackward0>)
3
epoch:  3 ; loss:  0.7126734256744385 ; pred:  tensor([0.0467, 0.1149, 0.7465, 0.0919], grad_fn=<SoftmaxBackward0>)
node_idx 5757
masked_adj tensor([0.6575, 0.6575, 0.6575, 0.6575, 0.6575, 0.6575, 0.6575, 0.6575, 0.6575,
        0.6575, 0.7974, 0.7994, 0.6512, 0.7989, 0.8008, 0.8008, 0.8008, 0.8008,
        0.8008, 0.8008, 0.8008, 0.8008, 0.8008, 0.7956],
       grad_fn=<MulBackward0>)
masked_hor tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.6575, 0.6575, 0.6575, 0.6575, 0.6575, 0.6575, 0.6575,
                      0.6575, 0.6575, 0.6575, 0.7974, 0.7994, 0.6512, 0.7989,
                      0.8008, 0.8008, 0.8008, 0.8008, 0.8008, 0.8008, 0.8008,
                      0.8008, 0.8008, 0.7956]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
ypred tensor([[ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        ...,
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028]], grad_fn=<AddBackward0>)
res: tensor([0.0429, 0.1071, 0.7634, 0.0866], grad_fn=<SoftmaxBackward0>)
label tensor([2])
logit tensor([0.7634], grad_fn=<IndexBackward0>)
mask_without_small tensor([0.6575, 0.6575, 0.6575, 0.6575, 0.6575, 0.6575, 0.6575, 0.6575, 0.6575,
        0.6575, 0.7974, 0.7994, 0.6512, 0.7989, 0.8008, 0.8008, 0.8008, 0.8008,
        0.8008, 0.8008, 0.8008, 0.8008, 0.8008, 0.7956],
       grad_fn=<IndexBackward0>)
pred_loss tensor([0.2700], grad_fn=<MulBackward0>)
size_loss tensor(-0.5297, grad_fn=<MulBackward0>)
size_num_loss 0.72
loss: tensor([0.4603], grad_fn=<AddBackward0>)
4
epoch:  4 ; loss:  0.46030473709106445 ; pred:  tensor([0.0429, 0.1071, 0.7634, 0.0866], grad_fn=<SoftmaxBackward0>)
node_idx 5757
masked_adj tensor([0.6369, 0.6369, 0.6369, 0.6369, 0.6369, 0.6369, 0.6369, 0.6369, 0.6369,
        0.6369, 0.8122, 0.8144, 0.6297, 0.8139, 0.8160, 0.8160, 0.8160, 0.8160,
        0.8160, 0.8160, 0.8160, 0.8160, 0.8160, 0.8104],
       grad_fn=<MulBackward0>)
masked_hor tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.6369, 0.6369, 0.6369, 0.6369, 0.6369, 0.6369, 0.6369,
                      0.6369, 0.6369, 0.6369, 0.8122, 0.8144, 0.6297, 0.8139,
                      0.8160, 0.8160, 0.8160, 0.8160, 0.8160, 0.8160, 0.8160,
                      0.8160, 0.8160, 0.8104]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
ypred tensor([[ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        ...,
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028]], grad_fn=<AddBackward0>)
res: tensor([0.0394, 0.0999, 0.7791, 0.0816], grad_fn=<SoftmaxBackward0>)
label tensor([2])
logit tensor([0.7791], grad_fn=<IndexBackward0>)
mask_without_small tensor([0.6369, 0.6369, 0.6369, 0.6369, 0.6369, 0.6369, 0.6369, 0.6369, 0.6369,
        0.6369, 0.8122, 0.8144, 0.6297, 0.8139, 0.8160, 0.8160, 0.8160, 0.8160,
        0.8160, 0.8160, 0.8160, 0.8160, 0.8160, 0.8104],
       grad_fn=<IndexBackward0>)
pred_loss tensor([0.2496], grad_fn=<MulBackward0>)
size_loss tensor(-0.8283, grad_fn=<MulBackward0>)
size_num_loss 0.72
loss: tensor([0.1413], grad_fn=<AddBackward0>)
5
epoch:  5 ; loss:  0.14133137464523315 ; pred:  tensor([0.0394, 0.0999, 0.7791, 0.0816], grad_fn=<SoftmaxBackward0>)
node_idx 5757
masked_adj tensor([0.6152, 0.6152, 0.6152, 0.6152, 0.6152, 0.6152, 0.6152, 0.6152, 0.6152,
        0.6152, 0.8264, 0.8288, 0.6072, 0.8282, 0.8304, 0.8304, 0.8304, 0.8304,
        0.8304, 0.8304, 0.8304, 0.8304, 0.8304, 0.8246],
       grad_fn=<MulBackward0>)
masked_hor tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.6152, 0.6152, 0.6152, 0.6152, 0.6152, 0.6152, 0.6152,
                      0.6152, 0.6152, 0.6152, 0.8264, 0.8288, 0.6072, 0.8282,
                      0.8304, 0.8304, 0.8304, 0.8304, 0.8304, 0.8304, 0.8304,
                      0.8304, 0.8304, 0.8246]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
ypred tensor([[ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        ...,
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028]], grad_fn=<AddBackward0>)
res: tensor([0.0362, 0.0932, 0.7936, 0.0769], grad_fn=<SoftmaxBackward0>)
label tensor([2])
logit tensor([0.7936], grad_fn=<IndexBackward0>)
mask_without_small tensor([0.6152, 0.6152, 0.6152, 0.6152, 0.6152, 0.6152, 0.6152, 0.6152, 0.6152,
        0.6152, 0.8264, 0.8288, 0.6072, 0.8282, 0.8304, 0.8304, 0.8304, 0.8304,
        0.8304, 0.8304, 0.8304, 0.8304, 0.8304, 0.8246],
       grad_fn=<IndexBackward0>)
pred_loss tensor([0.2312], grad_fn=<MulBackward0>)
size_loss tensor(-1.1964, grad_fn=<MulBackward0>)
size_num_loss 0.72
loss: tensor([-0.2452], grad_fn=<AddBackward0>)
6
epoch:  6 ; loss:  -0.24519062042236328 ; pred:  tensor([0.0362, 0.0932, 0.7936, 0.0769], grad_fn=<SoftmaxBackward0>)
node_idx 5757
masked_adj tensor([0.5927, 0.5927, 0.5927, 0.5927, 0.5927, 0.5927, 0.5927, 0.5927, 0.5927,
        0.5927, 0.8400, 0.8424, 0.5840, 0.8418, 0.8441, 0.8441, 0.8441, 0.8441,
        0.8441, 0.8441, 0.8441, 0.8441, 0.8441, 0.8382],
       grad_fn=<MulBackward0>)
masked_hor tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.5927, 0.5927, 0.5927, 0.5927, 0.5927, 0.5927, 0.5927,
                      0.5927, 0.5927, 0.5927, 0.8400, 0.8424, 0.5840, 0.8418,
                      0.8441, 0.8441, 0.8441, 0.8441, 0.8441, 0.8441, 0.8441,
                      0.8441, 0.8441, 0.8382]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
ypred tensor([[ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        ...,
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028]], grad_fn=<AddBackward0>)
res: tensor([0.0334, 0.0870, 0.8069, 0.0726], grad_fn=<SoftmaxBackward0>)
label tensor([2])
logit tensor([0.8069], grad_fn=<IndexBackward0>)
mask_without_small tensor([0.5927, 0.5927, 0.5927, 0.5927, 0.5927, 0.5927, 0.5927, 0.5927, 0.5927,
        0.5927, 0.8400, 0.8424, 0.5840, 0.8418, 0.8441, 0.8441, 0.8441, 0.8441,
        0.8441, 0.8441, 0.8441, 0.8441, 0.8441, 0.8382],
       grad_fn=<IndexBackward0>)
pred_loss tensor([0.2145], grad_fn=<MulBackward0>)
size_loss tensor(-1.6341, grad_fn=<MulBackward0>)
size_num_loss 0.72
loss: tensor([-0.6996], grad_fn=<AddBackward0>)
7
epoch:  7 ; loss:  -0.6996276378631592 ; pred:  tensor([0.0334, 0.0870, 0.8069, 0.0726], grad_fn=<SoftmaxBackward0>)
node_idx 5757
masked_adj tensor([0.5693, 0.5693, 0.5693, 0.5693, 0.5693, 0.5693, 0.5693, 0.5693, 0.5693,
        0.5693, 0.8530, 0.8553, 0.5601, 0.8547, 0.8570, 0.8570, 0.8570, 0.8570,
        0.8570, 0.8570, 0.8570, 0.8570, 0.8570, 0.8511],
       grad_fn=<MulBackward0>)
masked_hor tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.5693, 0.5693, 0.5693, 0.5693, 0.5693, 0.5693, 0.5693,
                      0.5693, 0.5693, 0.5693, 0.8530, 0.8553, 0.5601, 0.8547,
                      0.8570, 0.8570, 0.8570, 0.8570, 0.8570, 0.8570, 0.8570,
                      0.8570, 0.8570, 0.8511]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
ypred tensor([[ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        ...,
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028]], grad_fn=<AddBackward0>)
res: tensor([0.0309, 0.0814, 0.8191, 0.0686], grad_fn=<SoftmaxBackward0>)
label tensor([2])
logit tensor([0.8191], grad_fn=<IndexBackward0>)
mask_without_small tensor([0.5693, 0.5693, 0.5693, 0.5693, 0.5693, 0.5693, 0.5693, 0.5693, 0.5693,
        0.5693, 0.8530, 0.8553, 0.5601, 0.8547, 0.8570, 0.8570, 0.8570, 0.8570,
        0.8570, 0.8570, 0.8570, 0.8570, 0.8570, 0.8511],
       grad_fn=<IndexBackward0>)
pred_loss tensor([0.1995], grad_fn=<MulBackward0>)
size_loss tensor(-2.1412, grad_fn=<MulBackward0>)
size_num_loss 0.72
loss: tensor([-1.2217], grad_fn=<AddBackward0>)
8
epoch:  8 ; loss:  -1.2216594219207764 ; pred:  tensor([0.0309, 0.0814, 0.8191, 0.0686], grad_fn=<SoftmaxBackward0>)
node_idx 5757
masked_adj tensor([0.5451, 0.5451, 0.5451, 0.5451, 0.5451, 0.5451, 0.5451, 0.5451, 0.5451,
        0.5451, 0.8652, 0.8674, 0.5355, 0.8669, 0.8691, 0.8691, 0.8691, 0.8691,
        0.8691, 0.8691, 0.8691, 0.8691, 0.8691, 0.8634],
       grad_fn=<MulBackward0>)
masked_hor tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.5451, 0.5451, 0.5451, 0.5451, 0.5451, 0.5451, 0.5451,
                      0.5451, 0.5451, 0.5451, 0.8652, 0.8674, 0.5355, 0.8669,
                      0.8691, 0.8691, 0.8691, 0.8691, 0.8691, 0.8691, 0.8691,
                      0.8691, 0.8691, 0.8634]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
ypred tensor([[ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        ...,
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028]], grad_fn=<AddBackward0>)
res: tensor([0.0286, 0.0762, 0.8303, 0.0649], grad_fn=<SoftmaxBackward0>)
label tensor([2])
logit tensor([0.8303], grad_fn=<IndexBackward0>)
mask_without_small tensor([0.5451, 0.5451, 0.5451, 0.5451, 0.5451, 0.5451, 0.5451, 0.5451, 0.5451,
        0.5451, 0.8652, 0.8674, 0.5355, 0.8669, 0.8691, 0.8691, 0.8691, 0.8691,
        0.8691, 0.8691, 0.8691, 0.8691, 0.8691, 0.8634],
       grad_fn=<IndexBackward0>)
pred_loss tensor([0.1860], grad_fn=<MulBackward0>)
size_loss tensor(-2.7162, grad_fn=<MulBackward0>)
size_num_loss 0.72
loss: tensor([-1.8102], grad_fn=<AddBackward0>)
9
epoch:  9 ; loss:  -1.8101603984832764 ; pred:  tensor([0.0286, 0.0762, 0.8303, 0.0649], grad_fn=<SoftmaxBackward0>)
node_idx 5757
masked_adj tensor([0.5204, 0.5204, 0.5204, 0.5204, 0.5204, 0.5204, 0.5204, 0.5204, 0.5204,
        0.5204, 0.8767, 0.8788, 0.5103, 0.8783, 0.8804, 0.8804, 0.8804, 0.8804,
        0.8804, 0.8804, 0.8804, 0.8804, 0.8804, 0.8750],
       grad_fn=<MulBackward0>)
masked_hor tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.5204, 0.5204, 0.5204, 0.5204, 0.5204, 0.5204, 0.5204,
                      0.5204, 0.5204, 0.5204, 0.8767, 0.8788, 0.5103, 0.8783,
                      0.8804, 0.8804, 0.8804, 0.8804, 0.8804, 0.8804, 0.8804,
                      0.8804, 0.8804, 0.8750]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
ypred tensor([[ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        ...,
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028]], grad_fn=<AddBackward0>)
res: tensor([0.0266, 0.0715, 0.8404, 0.0615], grad_fn=<SoftmaxBackward0>)
label tensor([2])
logit tensor([0.8404], grad_fn=<IndexBackward0>)
mask_without_small tensor([0.5204, 0.5204, 0.5204, 0.5204, 0.5204, 0.5204, 0.5204, 0.5204, 0.5204,
        0.5204, 0.8767, 0.8788, 0.5103, 0.8783, 0.8804, 0.8804, 0.8804, 0.8804,
        0.8804, 0.8804, 0.8804, 0.8804, 0.8804, 0.8750],
       grad_fn=<IndexBackward0>)
pred_loss tensor([0.1739], grad_fn=<MulBackward0>)
size_loss tensor(-3.3570, grad_fn=<MulBackward0>)
size_num_loss 0.72
loss: tensor([-2.4631], grad_fn=<AddBackward0>)
10
epoch:  10 ; loss:  -2.4630990028381348 ; pred:  tensor([0.0266, 0.0715, 0.8404, 0.0615], grad_fn=<SoftmaxBackward0>)
node_idx 5757
masked_adj tensor([0.4951, 0.4951, 0.4951, 0.4951, 0.4951, 0.4951, 0.4951, 0.4951, 0.4951,
        0.4951, 0.8874, 0.8894, 0.4848, 0.8889, 0.8909, 0.8909, 0.8909, 0.8909,
        0.8909, 0.8909, 0.8909, 0.8909, 0.8909, 0.8858],
       grad_fn=<MulBackward0>)
masked_hor tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.4951, 0.4951, 0.4951, 0.4951, 0.4951, 0.4951, 0.4951,
                      0.4951, 0.4951, 0.4951, 0.8874, 0.8894, 0.4848, 0.8889,
                      0.8909, 0.8909, 0.8909, 0.8909, 0.8909, 0.8909, 0.8909,
                      0.8909, 0.8909, 0.8858]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
ypred tensor([[ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        ...,
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028]], grad_fn=<AddBackward0>)
res: tensor([0.0248, 0.0672, 0.8495, 0.0585], grad_fn=<SoftmaxBackward0>)
label tensor([2])
logit tensor([0.8495], grad_fn=<IndexBackward0>)
mask_without_small tensor([0.8874, 0.8894, 0.8889, 0.8909, 0.8909, 0.8909, 0.8909, 0.8909, 0.8909,
        0.8909, 0.8909, 0.8909, 0.8858], grad_fn=<IndexBackward0>)
pred_loss tensor([0.1631], grad_fn=<MulBackward0>)
size_loss tensor(-0.0277, grad_fn=<MulBackward0>)
size_num_loss 1.53125
loss: tensor([1.6667], grad_fn=<AddBackward0>)
11
epoch:  11 ; loss:  1.6666603088378906 ; pred:  tensor([0.0248, 0.0672, 0.8495, 0.0585], grad_fn=<SoftmaxBackward0>)
node_idx 5757
masked_adj tensor([0.4723, 0.4723, 0.4723, 0.4723, 0.4723, 0.4723, 0.4723, 0.4723, 0.4723,
        0.4723, 0.8897, 0.8970, 0.4617, 0.8952, 0.9007, 0.9007, 0.9007, 0.9007,
        0.9007, 0.9007, 0.9007, 0.9007, 0.9007, 0.8857],
       grad_fn=<MulBackward0>)
masked_hor tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.4723, 0.4723, 0.4723, 0.4723, 0.4723, 0.4723, 0.4723,
                      0.4723, 0.4723, 0.4723, 0.8897, 0.8970, 0.4617, 0.8952,
                      0.9007, 0.9007, 0.9007, 0.9007, 0.9007, 0.9007, 0.9007,
                      0.9007, 0.9007, 0.8857]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
ypred tensor([[ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        ...,
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028]], grad_fn=<AddBackward0>)
res: tensor([0.0233, 0.0637, 0.8571, 0.0559], grad_fn=<SoftmaxBackward0>)
label tensor([2])
logit tensor([0.8571], grad_fn=<IndexBackward0>)
mask_without_small tensor([0.8897, 0.8970, 0.8952, 0.9007, 0.9007, 0.9007, 0.9007, 0.9007, 0.9007,
        0.9007, 0.9007, 0.9007, 0.8857], grad_fn=<IndexBackward0>)
pred_loss tensor([0.1542], grad_fn=<MulBackward0>)
size_loss tensor(-0.2469, grad_fn=<MulBackward0>)
size_num_loss 1.53125
loss: tensor([1.4386], grad_fn=<AddBackward0>)
12
epoch:  12 ; loss:  1.4385560750961304 ; pred:  tensor([0.0233, 0.0637, 0.8571, 0.0559], grad_fn=<SoftmaxBackward0>)
node_idx 5757
masked_adj tensor([0.4519, 0.4519, 0.4519, 0.4519, 0.4519, 0.4519, 0.4519, 0.4519, 0.4519,
        0.4519, 0.8860, 0.9014, 0.4409, 0.8956, 0.9094, 0.9094, 0.9094, 0.9094,
        0.9094, 0.9094, 0.9094, 0.9094, 0.9094, 0.8810],
       grad_fn=<MulBackward0>)
masked_hor tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.4519, 0.4519, 0.4519, 0.4519, 0.4519, 0.4519, 0.4519,
                      0.4519, 0.4519, 0.4519, 0.8860, 0.9014, 0.4409, 0.8956,
                      0.9094, 0.9094, 0.9094, 0.9094, 0.9094, 0.9094, 0.9094,
                      0.9094, 0.9094, 0.8810]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
ypred tensor([[ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        ...,
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028]], grad_fn=<AddBackward0>)
res: tensor([0.0221, 0.0607, 0.8633, 0.0539], grad_fn=<SoftmaxBackward0>)
label tensor([2])
logit tensor([0.8633], grad_fn=<IndexBackward0>)
mask_without_small tensor([0.8860, 0.9014, 0.8956, 0.9094, 0.9094, 0.9094, 0.9094, 0.9094, 0.9094,
        0.9094, 0.9094, 0.9094, 0.8810], grad_fn=<IndexBackward0>)
pred_loss tensor([0.1470], grad_fn=<MulBackward0>)
size_loss tensor(-0.9963, grad_fn=<MulBackward0>)
size_num_loss 1.53125
loss: tensor([0.6820], grad_fn=<AddBackward0>)
13
epoch:  13 ; loss:  0.682024359703064 ; pred:  tensor([0.0221, 0.0607, 0.8633, 0.0539], grad_fn=<SoftmaxBackward0>)
node_idx 5757
masked_adj tensor([0.4336, 0.4336, 0.4336, 0.4336, 0.4336, 0.4336, 0.4336, 0.4336, 0.4336,
        0.4336, 0.8800, 0.9015, 0.4222, 0.8916, 0.9169, 0.9169, 0.9169, 0.9169,
        0.9169, 0.9169, 0.9169, 0.9169, 0.9169, 0.8743],
       grad_fn=<MulBackward0>)
masked_hor tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.4336, 0.4336, 0.4336, 0.4336, 0.4336, 0.4336, 0.4336,
                      0.4336, 0.4336, 0.4336, 0.8800, 0.9015, 0.4222, 0.8916,
                      0.9169, 0.9169, 0.9169, 0.9169, 0.9169, 0.9169, 0.9169,
                      0.9169, 0.9169, 0.8743]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
ypred tensor([[ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        ...,
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028]], grad_fn=<AddBackward0>)
res: tensor([0.0211, 0.0584, 0.8680, 0.0524], grad_fn=<SoftmaxBackward0>)
label tensor([2])
logit tensor([0.8680], grad_fn=<IndexBackward0>)
mask_without_small tensor([0.8800, 0.9015, 0.8916, 0.9169, 0.9169, 0.9169, 0.9169, 0.9169, 0.9169,
        0.9169, 0.9169, 0.9169, 0.8743], grad_fn=<IndexBackward0>)
pred_loss tensor([0.1415], grad_fn=<MulBackward0>)
size_loss tensor(-2.4471, grad_fn=<MulBackward0>)
size_num_loss 1.53125
loss: tensor([-0.7743], grad_fn=<AddBackward0>)
14
epoch:  14 ; loss:  -0.7743406295776367 ; pred:  tensor([0.0211, 0.0584, 0.8680, 0.0524], grad_fn=<SoftmaxBackward0>)
node_idx 5757
masked_adj tensor([0.4172, 0.4172, 0.4172, 0.4172, 0.4172, 0.4172, 0.4172, 0.4172, 0.4172,
        0.4172, 0.8724, 0.8979, 0.4053, 0.8856, 0.9236, 0.9236, 0.9236, 0.9236,
        0.9236, 0.9236, 0.9236, 0.9236, 0.9236, 0.8661],
       grad_fn=<MulBackward0>)
masked_hor tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.4172, 0.4172, 0.4172, 0.4172, 0.4172, 0.4172, 0.4172,
                      0.4172, 0.4172, 0.4172, 0.8724, 0.8979, 0.4053, 0.8856,
                      0.9236, 0.9236, 0.9236, 0.9236, 0.9236, 0.9236, 0.9236,
                      0.9236, 0.9236, 0.8661]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
ypred tensor([[ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        ...,
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028]], grad_fn=<AddBackward0>)
res: tensor([0.0204, 0.0565, 0.8720, 0.0512], grad_fn=<SoftmaxBackward0>)
label tensor([2])
logit tensor([0.8720], grad_fn=<IndexBackward0>)
mask_without_small tensor([0.8724, 0.8979, 0.8856, 0.9236, 0.9236, 0.9236, 0.9236, 0.9236, 0.9236,
        0.9236, 0.9236, 0.9236, 0.8661], grad_fn=<IndexBackward0>)
pred_loss tensor([0.1370], grad_fn=<MulBackward0>)
size_loss tensor(-4.7881, grad_fn=<MulBackward0>)
size_num_loss 1.53125
loss: tensor([-3.1198], grad_fn=<AddBackward0>)
15
epoch:  15 ; loss:  -3.1198487281799316 ; pred:  tensor([0.0204, 0.0565, 0.8720, 0.0512], grad_fn=<SoftmaxBackward0>)
node_idx 5757
masked_adj tensor([0.4025, 0.4025, 0.4025, 0.4025, 0.4025, 0.4025, 0.4025, 0.4025, 0.4025,
        0.4025, 0.8635, 0.8922, 0.3901, 0.8781, 0.9299, 0.9299, 0.9299, 0.9299,
        0.9299, 0.9299, 0.9299, 0.9299, 0.9299, 0.8565],
       grad_fn=<MulBackward0>)
masked_hor tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.4025, 0.4025, 0.4025, 0.4025, 0.4025, 0.4025, 0.4025,
                      0.4025, 0.4025, 0.4025, 0.8635, 0.8922, 0.3901, 0.8781,
                      0.9299, 0.9299, 0.9299, 0.9299, 0.9299, 0.9299, 0.9299,
                      0.9299, 0.9299, 0.8565]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
ypred tensor([[ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        ...,
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028]], grad_fn=<AddBackward0>)
res: tensor([0.0197, 0.0548, 0.8754, 0.0502], grad_fn=<SoftmaxBackward0>)
label tensor([2])
logit tensor([0.8754], grad_fn=<IndexBackward0>)
mask_without_small tensor([0.8635, 0.8922, 0.8781, 0.9299, 0.9299, 0.9299, 0.9299, 0.9299, 0.9299,
        0.9299, 0.9299, 0.9299, 0.8565], grad_fn=<IndexBackward0>)
pred_loss tensor([0.1331], grad_fn=<MulBackward0>)
size_loss tensor(-8.2203, grad_fn=<MulBackward0>)
size_num_loss 1.53125
loss: tensor([-6.5559], grad_fn=<AddBackward0>)
16
epoch:  16 ; loss:  -6.555932998657227 ; pred:  tensor([0.0197, 0.0548, 0.8754, 0.0502], grad_fn=<SoftmaxBackward0>)
node_idx 5757
masked_adj tensor([0.3894, 0.3894, 0.3894, 0.3894, 0.3894, 0.3894, 0.3894, 0.3894, 0.3894,
        0.3894, 0.8532, 0.8851, 0.3764, 0.8693, 0.9359, 0.9359, 0.9359, 0.9359,
        0.9359, 0.9359, 0.9359, 0.9359, 0.9359, 0.8455],
       grad_fn=<MulBackward0>)
masked_hor tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.3894, 0.3894, 0.3894, 0.3894, 0.3894, 0.3894, 0.3894,
                      0.3894, 0.3894, 0.3894, 0.8532, 0.8851, 0.3764, 0.8693,
                      0.9359, 0.9359, 0.9359, 0.9359, 0.9359, 0.9359, 0.9359,
                      0.9359, 0.9359, 0.8455]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
ypred tensor([[ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        ...,
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028]], grad_fn=<AddBackward0>)
res: tensor([0.0191, 0.0532, 0.8784, 0.0493], grad_fn=<SoftmaxBackward0>)
label tensor([2])
logit tensor([0.8784], grad_fn=<IndexBackward0>)
mask_without_small tensor([0.8532, 0.8851, 0.8693, 0.9359, 0.9359, 0.9359, 0.9359, 0.9359, 0.9359,
        0.9359, 0.9359, 0.9359, 0.8455], grad_fn=<IndexBackward0>)
pred_loss tensor([0.1297], grad_fn=<MulBackward0>)
size_loss tensor(-12.9472, grad_fn=<MulBackward0>)
size_num_loss 1.53125
loss: tensor([-11.2863], grad_fn=<AddBackward0>)
17
epoch:  17 ; loss:  -11.286316871643066 ; pred:  tensor([0.0191, 0.0532, 0.8784, 0.0493], grad_fn=<SoftmaxBackward0>)
node_idx 5757
masked_adj tensor([0.3775, 0.3775, 0.3775, 0.3775, 0.3775, 0.3775, 0.3775, 0.3775, 0.3775,
        0.3775, 0.8416, 0.8767, 0.3640, 0.8593, 0.9416, 0.9416, 0.9416, 0.9416,
        0.9416, 0.9416, 0.9416, 0.9416, 0.9416, 0.8332],
       grad_fn=<MulBackward0>)
masked_hor tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.3775, 0.3775, 0.3775, 0.3775, 0.3775, 0.3775, 0.3775,
                      0.3775, 0.3775, 0.3775, 0.8416, 0.8767, 0.3640, 0.8593,
                      0.9416, 0.9416, 0.9416, 0.9416, 0.9416, 0.9416, 0.9416,
                      0.9416, 0.9416, 0.8332]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
ypred tensor([[ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        ...,
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028]], grad_fn=<AddBackward0>)
res: tensor([0.0186, 0.0519, 0.8810, 0.0486], grad_fn=<SoftmaxBackward0>)
label tensor([2])
logit tensor([0.8810], grad_fn=<IndexBackward0>)
mask_without_small tensor([0.8416, 0.8767, 0.8593, 0.9416, 0.9416, 0.9416, 0.9416, 0.9416, 0.9416,
        0.9416, 0.9416, 0.9416, 0.8332], grad_fn=<IndexBackward0>)
pred_loss tensor([0.1267], grad_fn=<MulBackward0>)
size_loss tensor(-19.1870, grad_fn=<MulBackward0>)
size_num_loss 1.53125
loss: tensor([-17.5291], grad_fn=<AddBackward0>)
18
epoch:  18 ; loss:  -17.529075622558594 ; pred:  tensor([0.0186, 0.0519, 0.8810, 0.0486], grad_fn=<SoftmaxBackward0>)
node_idx 5757
masked_adj tensor([0.3669, 0.3669, 0.3669, 0.3669, 0.3669, 0.3669, 0.3669, 0.3669, 0.3669,
        0.3669, 0.8286, 0.8671, 0.3528, 0.8479, 0.9470, 0.9470, 0.9470, 0.9470,
        0.9470, 0.9470, 0.9470, 0.9470, 0.9470, 0.8195],
       grad_fn=<MulBackward0>)
masked_hor tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.3669, 0.3669, 0.3669, 0.3669, 0.3669, 0.3669, 0.3669,
                      0.3669, 0.3669, 0.3669, 0.8286, 0.8671, 0.3528, 0.8479,
                      0.9470, 0.9470, 0.9470, 0.9470, 0.9470, 0.9470, 0.9470,
                      0.9470, 0.9470, 0.8195]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
ypred tensor([[ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        ...,
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028]], grad_fn=<AddBackward0>)
res: tensor([0.0181, 0.0507, 0.8833, 0.0480], grad_fn=<SoftmaxBackward0>)
label tensor([2])
logit tensor([0.8833], grad_fn=<IndexBackward0>)
mask_without_small tensor([0.8286, 0.8671, 0.8479, 0.9470, 0.9470, 0.9470, 0.9470, 0.9470, 0.9470,
        0.9470, 0.9470, 0.9470, 0.8195], grad_fn=<IndexBackward0>)
pred_loss tensor([0.1241], grad_fn=<MulBackward0>)
size_loss tensor(-27.1791, grad_fn=<MulBackward0>)
size_num_loss 1.53125
loss: tensor([-25.5237], grad_fn=<AddBackward0>)
19
epoch:  19 ; loss:  -25.52368927001953 ; pred:  tensor([0.0181, 0.0507, 0.8833, 0.0480], grad_fn=<SoftmaxBackward0>)
node_idx 5757
masked_adj tensor([0.3574, 0.3574, 0.3574, 0.3574, 0.3574, 0.3574, 0.3574, 0.3574, 0.3574,
        0.3574, 0.8141, 0.8563, 0.3427, 0.8352, 0.9521, 0.9521, 0.9521, 0.9521,
        0.9521, 0.9521, 0.9521, 0.9521, 0.9521, 0.8043],
       grad_fn=<MulBackward0>)
masked_hor tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.3574, 0.3574, 0.3574, 0.3574, 0.3574, 0.3574, 0.3574,
                      0.3574, 0.3574, 0.3574, 0.8141, 0.8563, 0.3427, 0.8352,
                      0.9521, 0.9521, 0.9521, 0.9521, 0.9521, 0.9521, 0.9521,
                      0.9521, 0.9521, 0.8043]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
ypred tensor([[ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        ...,
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028]], grad_fn=<AddBackward0>)
res: tensor([0.0177, 0.0497, 0.8851, 0.0475], grad_fn=<SoftmaxBackward0>)
label tensor([2])
logit tensor([0.8851], grad_fn=<IndexBackward0>)
mask_without_small tensor([0.8141, 0.8563, 0.8352, 0.9521, 0.9521, 0.9521, 0.9521, 0.9521, 0.9521,
        0.9521, 0.9521, 0.9521, 0.8043], grad_fn=<IndexBackward0>)
pred_loss tensor([0.1220], grad_fn=<MulBackward0>)
size_loss tensor(-37.1909, grad_fn=<MulBackward0>)
size_num_loss 1.53125
loss: tensor([-35.5376], grad_fn=<AddBackward0>)
20
epoch:  20 ; loss:  -35.53763961791992 ; pred:  tensor([0.0177, 0.0497, 0.8851, 0.0475], grad_fn=<SoftmaxBackward0>)
node_idx 5757
masked_adj tensor([0.3488, 0.3488, 0.3488, 0.3488, 0.3488, 0.3488, 0.3488, 0.3488, 0.3488,
        0.3488, 0.7982, 0.8441, 0.3336, 0.8210, 0.9569, 0.9569, 0.9569, 0.9569,
        0.9569, 0.9569, 0.9569, 0.9569, 0.9569, 0.7876],
       grad_fn=<MulBackward0>)
masked_hor tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.3488, 0.3488, 0.3488, 0.3488, 0.3488, 0.3488, 0.3488,
                      0.3488, 0.3488, 0.3488, 0.7982, 0.8441, 0.3336, 0.8210,
                      0.9569, 0.9569, 0.9569, 0.9569, 0.9569, 0.9569, 0.9569,
                      0.9569, 0.9569, 0.7876]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
ypred tensor([[ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        ...,
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028]], grad_fn=<AddBackward0>)
res: tensor([0.0174, 0.0488, 0.8867, 0.0471], grad_fn=<SoftmaxBackward0>)
label tensor([2])
logit tensor([0.8867], grad_fn=<IndexBackward0>)
mask_without_small tensor([0.7982, 0.8441, 0.8210, 0.9569, 0.9569, 0.9569, 0.9569, 0.9569, 0.9569,
        0.9569, 0.9569, 0.9569, 0.7876], grad_fn=<IndexBackward0>)
pred_loss tensor([0.1203], grad_fn=<MulBackward0>)
size_loss tensor(-49.5247, grad_fn=<MulBackward0>)
size_num_loss 1.53125
loss: tensor([-47.8732], grad_fn=<AddBackward0>)
21
epoch:  21 ; loss:  -47.873165130615234 ; pred:  tensor([0.0174, 0.0488, 0.8867, 0.0471], grad_fn=<SoftmaxBackward0>)
node_idx 5757
masked_adj tensor([0.3411, 0.3411, 0.3411, 0.3411, 0.3411, 0.3411, 0.3411, 0.3411, 0.3411,
        0.3411, 0.7807, 0.8305, 0.3252, 0.8054, 0.9613, 0.9613, 0.9613, 0.9613,
        0.9613, 0.9613, 0.9613, 0.9613, 0.9613, 0.7693],
       grad_fn=<MulBackward0>)
masked_hor tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.3411, 0.3411, 0.3411, 0.3411, 0.3411, 0.3411, 0.3411,
                      0.3411, 0.3411, 0.3411, 0.7807, 0.8305, 0.3252, 0.8054,
                      0.9613, 0.9613, 0.9613, 0.9613, 0.9613, 0.9613, 0.9613,
                      0.9613, 0.9613, 0.7693]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
ypred tensor([[ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        ...,
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028]], grad_fn=<AddBackward0>)
res: tensor([0.0171, 0.0481, 0.8879, 0.0470], grad_fn=<SoftmaxBackward0>)
label tensor([2])
logit tensor([0.8879], grad_fn=<IndexBackward0>)
mask_without_small tensor([0.7807, 0.8305, 0.8054, 0.9613, 0.9613, 0.9613, 0.9613, 0.9613, 0.9613,
        0.9613, 0.9613, 0.9613, 0.7693], grad_fn=<IndexBackward0>)
pred_loss tensor([0.1190], grad_fn=<MulBackward0>)
size_loss tensor(-64.5219, grad_fn=<MulBackward0>)
size_num_loss 1.53125
loss: tensor([-62.8717], grad_fn=<AddBackward0>)
22
epoch:  22 ; loss:  -62.871742248535156 ; pred:  tensor([0.0171, 0.0481, 0.8879, 0.0470], grad_fn=<SoftmaxBackward0>)
node_idx 5757
masked_adj tensor([0.3342, 0.3342, 0.3342, 0.3342, 0.3342, 0.3342, 0.3342, 0.3342, 0.3342,
        0.3342, 0.7616, 0.8154, 0.3177, 0.7882, 0.9653, 0.9653, 0.9653, 0.9653,
        0.9653, 0.9653, 0.9653, 0.9653, 0.9653, 0.7494],
       grad_fn=<MulBackward0>)
masked_hor tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.3342, 0.3342, 0.3342, 0.3342, 0.3342, 0.3342, 0.3342,
                      0.3342, 0.3342, 0.3342, 0.7616, 0.8154, 0.3177, 0.7882,
                      0.9653, 0.9653, 0.9653, 0.9653, 0.9653, 0.9653, 0.9653,
                      0.9653, 0.9653, 0.7494]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
ypred tensor([[ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        ...,
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028]], grad_fn=<AddBackward0>)
res: tensor([0.0169, 0.0475, 0.8887, 0.0469], grad_fn=<SoftmaxBackward0>)
label tensor([2])
logit tensor([0.8887], grad_fn=<IndexBackward0>)
mask_without_small tensor([0.7616, 0.8154, 0.7882, 0.9653, 0.9653, 0.9653, 0.9653, 0.9653, 0.9653,
        0.9653, 0.9653, 0.9653, 0.7494], grad_fn=<IndexBackward0>)
pred_loss tensor([0.1180], grad_fn=<MulBackward0>)
size_loss tensor(-82.5663, grad_fn=<MulBackward0>)
size_num_loss 1.53125
loss: tensor([-80.9170], grad_fn=<AddBackward0>)
23
epoch:  23 ; loss:  -80.9169692993164 ; pred:  tensor([0.0169, 0.0475, 0.8887, 0.0469], grad_fn=<SoftmaxBackward0>)
node_idx 5757
masked_adj tensor([0.3279, 0.3279, 0.3279, 0.3279, 0.3279, 0.3279, 0.3279, 0.3279, 0.3279,
        0.3279, 0.7409, 0.7988, 0.3108, 0.7694, 0.9690, 0.9690, 0.9690, 0.9690,
        0.9690, 0.9690, 0.9690, 0.9690, 0.9690, 0.7278],
       grad_fn=<MulBackward0>)
masked_hor tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.3279, 0.3279, 0.3279, 0.3279, 0.3279, 0.3279, 0.3279,
                      0.3279, 0.3279, 0.3279, 0.7409, 0.7988, 0.3108, 0.7694,
                      0.9690, 0.9690, 0.9690, 0.9690, 0.9690, 0.9690, 0.9690,
                      0.9690, 0.9690, 0.7278]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
ypred tensor([[ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        ...,
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028]], grad_fn=<AddBackward0>)
res: tensor([0.0168, 0.0471, 0.8891, 0.0470], grad_fn=<SoftmaxBackward0>)
label tensor([2])
logit tensor([0.8891], grad_fn=<IndexBackward0>)
mask_without_small tensor([0.7409, 0.7988, 0.7694, 0.9690, 0.9690, 0.9690, 0.9690, 0.9690, 0.9690,
        0.9690, 0.9690, 0.9690, 0.7278], grad_fn=<IndexBackward0>)
pred_loss tensor([0.1175], grad_fn=<MulBackward0>)
size_loss tensor(-104.0831, grad_fn=<MulBackward0>)
size_num_loss 1.53125
loss: tensor([-102.4343], grad_fn=<AddBackward0>)
24
epoch:  24 ; loss:  -102.43429565429688 ; pred:  tensor([0.0168, 0.0471, 0.8891, 0.0470], grad_fn=<SoftmaxBackward0>)
node_idx 5757
masked_adj tensor([0.3223, 0.3223, 0.3223, 0.3223, 0.3223, 0.3223, 0.3223, 0.3223, 0.3223,
        0.3223, 0.7184, 0.7806, 0.3045, 0.7489, 0.9724, 0.9724, 0.9724, 0.9724,
        0.9724, 0.9724, 0.9724, 0.9724, 0.9724, 0.7046],
       grad_fn=<MulBackward0>)
masked_hor tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.3223, 0.3223, 0.3223, 0.3223, 0.3223, 0.3223, 0.3223,
                      0.3223, 0.3223, 0.3223, 0.7184, 0.7806, 0.3045, 0.7489,
                      0.9724, 0.9724, 0.9724, 0.9724, 0.9724, 0.9724, 0.9724,
                      0.9724, 0.9724, 0.7046]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
ypred tensor([[ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        ...,
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028]], grad_fn=<AddBackward0>)
res: tensor([0.0167, 0.0468, 0.8892, 0.0472], grad_fn=<SoftmaxBackward0>)
label tensor([2])
logit tensor([0.8892], grad_fn=<IndexBackward0>)
mask_without_small tensor([0.7184, 0.7806, 0.7489, 0.9724, 0.9724, 0.9724, 0.9724, 0.9724, 0.9724,
        0.9724, 0.9724, 0.9724, 0.7046], grad_fn=<IndexBackward0>)
pred_loss tensor([0.1174], grad_fn=<MulBackward0>)
size_loss tensor(-129.5352, grad_fn=<MulBackward0>)
size_num_loss 1.53125
loss: tensor([-127.8866], grad_fn=<AddBackward0>)
25
epoch:  25 ; loss:  -127.88661193847656 ; pred:  tensor([0.0167, 0.0468, 0.8892, 0.0472], grad_fn=<SoftmaxBackward0>)
node_idx 5757
masked_adj tensor([0.3172, 0.3172, 0.3172, 0.3172, 0.3172, 0.3172, 0.3172, 0.3172, 0.3172,
        0.3172, 0.6943, 0.7606, 0.2988, 0.7266, 0.9754, 0.9754, 0.9754, 0.9754,
        0.9754, 0.9754, 0.9754, 0.9754, 0.9754, 0.6796],
       grad_fn=<MulBackward0>)
masked_hor tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.3172, 0.3172, 0.3172, 0.3172, 0.3172, 0.3172, 0.3172,
                      0.3172, 0.3172, 0.3172, 0.6943, 0.7606, 0.2988, 0.7266,
                      0.9754, 0.9754, 0.9754, 0.9754, 0.9754, 0.9754, 0.9754,
                      0.9754, 0.9754, 0.6796]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
ypred tensor([[ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        ...,
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028]], grad_fn=<AddBackward0>)
res: tensor([0.0167, 0.0467, 0.8890, 0.0476], grad_fn=<SoftmaxBackward0>)
label tensor([2])
logit tensor([0.8890], grad_fn=<IndexBackward0>)
mask_without_small tensor([0.6943, 0.7606, 0.7266, 0.9754, 0.9754, 0.9754, 0.9754, 0.9754, 0.9754,
        0.9754, 0.9754, 0.9754, 0.6796], grad_fn=<IndexBackward0>)
pred_loss tensor([0.1177], grad_fn=<MulBackward0>)
size_loss tensor(-159.4136, grad_fn=<MulBackward0>)
size_num_loss 1.53125
loss: tensor([-157.7647], grad_fn=<AddBackward0>)
26
epoch:  26 ; loss:  -157.76466369628906 ; pred:  tensor([0.0167, 0.0467, 0.8890, 0.0476], grad_fn=<SoftmaxBackward0>)
node_idx 5757
masked_adj tensor([0.3127, 0.3127, 0.3127, 0.3127, 0.3127, 0.3127, 0.3127, 0.3127, 0.3127,
        0.3127, 0.6685, 0.7389, 0.2936, 0.7027, 0.9782, 0.9782, 0.9782, 0.9782,
        0.9782, 0.9782, 0.9782, 0.9782, 0.9782, 0.6531],
       grad_fn=<MulBackward0>)
masked_hor tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.3127, 0.3127, 0.3127, 0.3127, 0.3127, 0.3127, 0.3127,
                      0.3127, 0.3127, 0.3127, 0.6685, 0.7389, 0.2936, 0.7027,
                      0.9782, 0.9782, 0.9782, 0.9782, 0.9782, 0.9782, 0.9782,
                      0.9782, 0.9782, 0.6531]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
ypred tensor([[ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        ...,
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028]], grad_fn=<AddBackward0>)
res: tensor([0.0167, 0.0467, 0.8884, 0.0482], grad_fn=<SoftmaxBackward0>)
label tensor([2])
logit tensor([0.8884], grad_fn=<IndexBackward0>)
mask_without_small tensor([0.6685, 0.7389, 0.7027, 0.9782, 0.9782, 0.9782, 0.9782, 0.9782, 0.9782,
        0.9782, 0.9782, 0.9782, 0.6531], grad_fn=<IndexBackward0>)
pred_loss tensor([0.1183], grad_fn=<MulBackward0>)
size_loss tensor(-194.2226, grad_fn=<MulBackward0>)
size_num_loss 1.53125
loss: tensor([-192.5731], grad_fn=<AddBackward0>)
27
epoch:  27 ; loss:  -192.57305908203125 ; pred:  tensor([0.0167, 0.0467, 0.8884, 0.0482], grad_fn=<SoftmaxBackward0>)
node_idx 5757
masked_adj tensor([0.3085, 0.3085, 0.3085, 0.3085, 0.3085, 0.3085, 0.3085, 0.3085, 0.3085,
        0.3085, 0.6411, 0.7155, 0.2888, 0.6770, 0.9807, 0.9807, 0.9807, 0.9807,
        0.9807, 0.9807, 0.9807, 0.9807, 0.9807, 0.6251],
       grad_fn=<MulBackward0>)
masked_hor tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.3085, 0.3085, 0.3085, 0.3085, 0.3085, 0.3085, 0.3085,
                      0.3085, 0.3085, 0.3085, 0.6411, 0.7155, 0.2888, 0.6770,
                      0.9807, 0.9807, 0.9807, 0.9807, 0.9807, 0.9807, 0.9807,
                      0.9807, 0.9807, 0.6251]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
ypred tensor([[ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        ...,
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028]], grad_fn=<AddBackward0>)
res: tensor([0.0168, 0.0468, 0.8875, 0.0489], grad_fn=<SoftmaxBackward0>)
label tensor([2])
logit tensor([0.8875], grad_fn=<IndexBackward0>)
mask_without_small tensor([0.6411, 0.7155, 0.6770, 0.9807, 0.9807, 0.9807, 0.9807, 0.9807, 0.9807,
        0.9807, 0.9807, 0.9807, 0.6251], grad_fn=<IndexBackward0>)
pred_loss tensor([0.1193], grad_fn=<MulBackward0>)
size_loss tensor(-234.4585, grad_fn=<MulBackward0>)
size_num_loss 1.53125
loss: tensor([-232.8079], grad_fn=<AddBackward0>)
28
epoch:  28 ; loss:  -232.8079071044922 ; pred:  tensor([0.0168, 0.0468, 0.8875, 0.0489], grad_fn=<SoftmaxBackward0>)
node_idx 5757
masked_adj tensor([0.3048, 0.3048, 0.3048, 0.3048, 0.3048, 0.3048, 0.3048, 0.3048, 0.3048,
        0.3048, 0.6122, 0.6902, 0.2844, 0.6497, 0.9829, 0.9829, 0.9829, 0.9829,
        0.9829, 0.9829, 0.9829, 0.9829, 0.9829, 0.5956],
       grad_fn=<MulBackward0>)
masked_hor tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.3048, 0.3048, 0.3048, 0.3048, 0.3048, 0.3048, 0.3048,
                      0.3048, 0.3048, 0.3048, 0.6122, 0.6902, 0.2844, 0.6497,
                      0.9829, 0.9829, 0.9829, 0.9829, 0.9829, 0.9829, 0.9829,
                      0.9829, 0.9829, 0.5956]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
ypred tensor([[ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        ...,
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028],
        [ 0.1214, -0.0644,  0.0171, -0.1028]], grad_fn=<AddBackward0>)
res: tensor([0.0169, 0.0471, 0.8863, 0.0497], grad_fn=<SoftmaxBackward0>)
label tensor([2])
logit tensor([0.8863], grad_fn=<IndexBackward0>)
mask_without_small tensor([0.6122, 0.6902, 0.6497, 0.9829, 0.9829, 0.9829, 0.9829, 0.9829, 0.9829,
        0.9829, 0.9829, 0.9829, 0.5956], grad_fn=<IndexBackward0>)
pred_loss tensor([0.1207], grad_fn=<MulBackward0>)
size_loss tensor(-280.5809, grad_fn=<MulBackward0>)
size_num_loss 1.53125
loss: tensor([-278.9290], grad_fn=<AddBackward0>)
29
epoch:  29 ; loss:  -278.92901611328125 ; pred:  tensor([0.0169, 0.0471, 0.8863, 0.0497], grad_fn=<SoftmaxBackward0>)
Finished Training
masked_ver tensor(indices=tensor([[ 23430,  23444,  23490,  23546,  24301,  24407,  24427,
                         24475,  24503,  24543,  88607, 196312, 229452, 254307,
                        254307, 254307, 254307, 254307, 254307, 254307, 254307,
                        254307, 254307, 328872],
                       [  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,    908,   2227,   1002,   6860,
                          6874,   6920,   6976,   7731,   7837,   7857,   7905,
                          7933,   7973,   5230]]),
       values=tensor([0.3048, 0.3048, 0.3048, 0.3048, 0.3048, 0.3048, 0.3048,
                      0.3048, 0.3048, 0.3048, 0.6122, 0.6902, 0.2844, 0.6497,
                      0.9829, 0.9829, 0.9829, 0.9829, 0.9829, 0.9829, 0.9829,
                      0.9829, 0.9829, 0.5956]),
       size=(753935, 8285), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
sel masked ver tensor(indices=tensor([[5757, 5757, 5757, 5757, 5757, 5757, 5757, 5757, 5757,
                        5757, 5757, 5757, 5757],
                       [ 908, 2227, 6860, 6874, 6920, 6976, 7731, 7837, 7857,
                        7905, 7933, 7973, 5230]]),
       values=tensor([0.6122, 0.6902, 0.6497, 0.9829, 0.9829, 0.9829, 0.9829,
                      0.9829, 0.9829, 0.9829, 0.9829, 0.9829, 0.5956]),
       size=(5758, 7974), nnz=13, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
/usr/local/Caskroom/miniconda/base/lib/python3.9/site-packages/networkx/drawing/nx_pylab.py:433: UserWarning: No data for colormapping provided via 'c'. Parameters 'cmap' will be ignored
  node_collection = ax.scatter(
Counter({'publication': 10, 'fax': 1, 'name': 1, 'type': 1})
dict index: {}
ypred explain tensor([0.0169, 0.0471, 0.8863, 0.0497], grad_fn=<SoftmaxBackward0>)
ypred full tensor([1.2879e-20, 7.0437e-17, 1.0000e+00, 1.2028e-17],
       grad_fn=<SoftmaxBackward0>)
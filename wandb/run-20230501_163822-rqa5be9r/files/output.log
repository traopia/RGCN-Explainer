24
start training
masked_hor: tensor(indices=tensor([[  5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          5757,   5757,   5757,   5757,   5757,   5757,   5757,
                          6860,   6874,   6920,   6976,   7731,   7837,   7857,
                          7905,   7933,   7973],
                       [ 83758, 192782, 224697, 255410, 255424, 255470, 255526,
                        256281, 256387, 256407, 256455, 256483, 256523, 328345,
                         22327,  22327,  22327,  22327,  22327,  22327,  22327,
                         22327,  22327,  22327]]),
       values=tensor([0.8258, 0.8068, 0.7790, 0.0597, 0.0768, 0.0656, 0.0729,
                      0.0631, 0.0751, 0.0690, 0.0702, 0.0745, 0.0664, 0.7362,
                      0.5820, 0.7186, 0.7131, 0.7080, 0.7742, 0.6944, 0.6962,
                      0.7275, 0.6815, 0.7494]),
       size=(8285, 753935), nnz=24, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
tensor([0.8258, 0.8068, 0.7790, 0.5968, 0.7678, 0.6556, 0.7286, 0.6311, 0.7508,
        0.6904, 0.7022, 0.7445, 0.6636, 0.7362, 0.5820, 0.7186, 0.7131, 0.7080,
        0.7742, 0.6944, 0.6962, 0.7275, 0.6815, 0.7494],
       grad_fn=<SigmoidBackward0>)
num_high 24
  0%|                                                                                                                | 0/10 [00:00<?, ?it/s]/Users/macoftraopia/Documents/GitHub/RGCN-Explainer/RGCN_stuff/r.py:126: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  adj = torch.tensor(adj)
  0%|                                                                                                                | 0/10 [00:00<?, ?it/s]
Traceback (most recent call last):
  File "/Users/macoftraopia/Documents/GitHub/RGCN-Explainer/RGCN_stuff/r.py", line 672, in <module>
    main2(name = 'aifb', node_idx = 5757, n_hops = 0,threshold = 0.5, train= True)
  File "/Users/macoftraopia/Documents/GitHub/RGCN-Explainer/RGCN_stuff/r.py", line 548, in main2
    loss = explainer.criterion(epoch,hyperparameter_grid , size, size_num)
  File "/Users/macoftraopia/Documents/GitHub/RGCN-Explainer/RGCN_stuff/r.py", line 319, in criterion
    loss_val = self.loss_fc( pred, self.pred_label, self.new_node_idx, epoch, grid_coeff, size, size_num)
  File "/Users/macoftraopia/Documents/GitHub/RGCN-Explainer/RGCN_stuff/r.py", line 272, in loss_fc
    size_num_loss = size_num * len(self.num_high)/len(mask)
TypeError: object of type 'int' has no len()
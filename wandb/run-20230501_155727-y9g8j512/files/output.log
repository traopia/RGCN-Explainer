119
start training
masked_hor: tensor(indices=tensor([[  5357,   5357,   5408,   5408,   5413,   5413,   5431,
                          5431,   5450,   5450,   5494,   5494,   5502,   5502,
                          5502,   5502,   5502,   5502,   5502,   5502,   5502,
                          5502,   5502,   5502,   5502,   5502,   5502,   5502,
                          5502,   5502,   5502,   5502,   5678,   5678,   5678,
                          5678,   5678,   5678,   5678,   5678,   5678,   5678,
                          5678,   5678,   5678,   5678,   5678,   5678,   5678,
                          5678,   5678,   5678,   5678,   5678,   5678,   5678,
                          5678,   5937,   5937,   5937,   5937,   5937,   5939,
                          5939,   5939,   5939,   5939,   5939,   5939,   5939,
                          5939,   5939,   5939,   5939,   5939,   5939,   5939,
                          6881,   6881,   6881,   6887,   6887,   6887,   6888,
                          6888,   6981,   6981,   6997,   6997,   6997,   7045,
                          7045,   7068,   7068,   7100,   7100,   7393,   7393,
                          7393,   7861,   7911,   7911,   7911,   7968,   8010,
                          8010,   8010,   8012,   8012,   8012,   8013,   8013,
                          8013,   8014,   8014,   8014,   8015,   8015,   8015],
                       [ 63934, 154808,  63934, 154808,  63934, 154808,  63932,
                        154808,  63934, 154808,  63932, 154808,  47362,  47364,
                        179663, 263716, 263722, 263723, 263816, 263832, 263880,
                        263903, 263935, 264228, 264696, 264746, 264803, 264845,
                        264847, 264848, 264849, 264850,  82872, 124392, 192770,
                        223730, 237515, 255431, 255437, 255438, 255531, 255547,
                        255595, 255618, 255650, 255943, 256411, 256461, 256518,
                        256560, 256562, 256563, 256564, 256565, 304199, 328345,
                        328346,  38642, 146276, 146339, 179663, 247153,  38642,
                        146202, 146253, 146258, 146295, 179663, 247146, 247152,
                        247262, 248176, 248275, 248277, 248278, 248279, 248280,
                         22248, 113644, 146202,  80243, 113644, 146295,  22248,
                        113642,  22248, 146295,  22248, 113644, 146295,  22248,
                        146295,  22248, 146295,  22248, 146295,  22248, 146202,
                        146295,  22248,  22248, 113644, 146295,  22248,  22248,
                        113644, 146295,  22248, 113644, 146295,  22248, 113644,
                        146295,  22248, 113644, 146295,  22248, 113644, 146295]]),
       values=tensor([0.7773, 0.7672, 0.7534, 0.6742, 0.7480, 0.6985, 0.7300,
                      0.6883, 0.7115, 0.7710, 0.7209, 0.6938, 0.3561, 0.3583,
                      0.7110, 0.0441, 0.0453, 0.0428, 0.0422, 0.0437, 0.0418,
                      0.0446, 0.0442, 0.0454, 0.0448, 0.0449, 0.0439, 0.0449,
                      0.0427, 0.0431, 0.0426, 0.0443, 0.6943, 0.7083, 0.7253,
                      0.7725, 0.7391, 0.0424, 0.0435, 0.0418, 0.0406, 0.0445,
                      0.0417, 0.0421, 0.0410, 0.0460, 0.0411, 0.0423, 0.0416,
                      0.0420, 0.0431, 0.0438, 0.0423, 0.0447, 0.7098, 0.3559,
                      0.3469, 0.7320, 0.3647, 0.3740, 0.7286, 0.7754, 0.6998,
                      0.1912, 0.1916, 0.1881, 0.1959, 0.7442, 0.0822, 0.0807,
                      0.0781, 0.0847, 0.0807, 0.0827, 0.0814, 0.0824, 0.0828,
                      0.7144, 0.6713, 0.7115, 0.7313, 0.7223, 0.6955, 0.7159,
                      0.7445, 0.7442, 0.7591, 0.7324, 0.7496, 0.7186, 0.7035,
                      0.7462, 0.6850, 0.7094, 0.7637, 0.7432, 0.6625, 0.3717,
                      0.3753, 0.7318, 0.7471, 0.7457, 0.7574, 0.7443, 0.7565,
                      0.7127, 0.7561, 0.7225, 0.7440, 0.7408, 0.7160, 0.7414,
                      0.7162, 0.7438, 0.7188, 0.7183, 0.7379, 0.7165, 0.7480]),
       size=(8285, 753935), nnz=119, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
Parameter containing:
tensor([1.2498, 1.1928, 1.1168, 0.7270, 1.0880, 0.8400, 0.9944, 0.7920, 0.9025,
        1.2137, 0.9491, 0.8180, 0.9056, 0.9275, 0.9003, 1.0988, 1.2129, 0.9793,
        0.9355, 1.0570, 0.9017, 1.1398, 1.1038, 1.2179, 1.1658, 1.1681, 1.0791,
        1.1730, 0.9700, 1.0054, 0.9674, 1.1115, 0.8205, 0.8871, 0.9710, 1.2226,
        1.0413, 0.9450, 1.0396, 0.8996, 0.7981, 1.1291, 0.8859, 0.9221, 0.8348,
        1.2752, 0.8399, 0.9367, 0.8815, 0.9147, 1.0101, 1.0682, 0.9367, 1.1544,
        0.8945, 0.9046, 0.8181, 1.0047, 0.9918, 1.0876, 0.9873, 1.2391, 0.8464,
        1.1794, 1.1873, 1.1110, 1.2876, 1.0678, 1.0449, 0.9744, 0.8633, 1.1657,
        0.9777, 1.0679, 1.0073, 1.0553, 1.0745, 0.9168, 0.7140, 0.9027, 1.0014,
        0.9561, 0.8262, 0.9241, 1.0695, 1.0680, 1.1479, 1.0067, 1.0964, 0.9376,
        0.8639, 1.0783, 0.7767, 0.8927, 1.1730, 1.0627, 0.6747, 1.0633, 1.1017,
        1.0037, 1.0831, 1.0756, 1.1383, 1.0684, 1.1337, 0.9086, 1.1313, 0.9571,
        1.0671, 1.0503, 0.9249, 1.0533, 0.9257, 1.0657, 0.9384, 0.9362, 1.0351,
        0.9270, 1.0881], requires_grad=True)
num_high 119
pred_loss tensor(0.5702, grad_fn=<MulBackward0>)
size_loss tensor(1189.2319, grad_fn=<MulBackward0>) tensor(-9.6763, grad_fn=<MulBackward0>) tensor(-7.6084, grad_fn=<MulBackward0>)
size_num_loss 1770.125
  0%|                                                                                                                                             | 0/10 [00:00<?, ?it/s]/Users/macoftraopia/Documents/GitHub/RGCN-Explainer/RGCN_stuff/r.py:126: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  adj = torch.tensor(adj)
 10%|█████████████▎                                                                                                                       | 1/10 [00:25<03:50, 25.66s/it]
epoch:  0 ; loss:  2942.642578125 ; pred:  tensor([0.5654, 0.1537, 0.1557, 0.1251], grad_fn=<SoftmaxBackward0>)
masked_hor: tensor(indices=tensor([[  5357,   5357,   5408,   5408,   5413,   5413,   5431,
                          5431,   5450,   5450,   5494,   5494,   5502,   5502,
                          5502,   5502,   5502,   5502,   5502,   5502,   5502,
                          5502,   5502,   5502,   5502,   5502,   5502,   5502,
                          5502,   5502,   5502,   5502,   5678,   5678,   5678,
                          5678,   5678,   5678,   5678,   5678,   5678,   5678,
                          5678,   5678,   5678,   5678,   5678,   5678,   5678,
                          5678,   5678,   5678,   5678,   5678,   5678,   5678,
                          5678,   5937,   5937,   5937,   5937,   5937,   5939,
                          5939,   5939,   5939,   5939,   5939,   5939,   5939,
                          5939,   5939,   5939,   5939,   5939,   5939,   5939,
                          6881,   6881,   6881,   6887,   6887,   6887,   6888,
                          6888,   6981,   6981,   6997,   6997,   6997,   7045,
                          7045,   7068,   7068,   7100,   7100,   7393,   7393,
                          7393,   7861,   7911,   7911,   7911,   7968,   8010,
                          8010,   8010,   8012,   8012,   8012,   8013,   8013,
                          8013,   8014,   8014,   8014,   8015,   8015,   8015],
                       [ 63934, 154808,  63934, 154808,  63934, 154808,  63932,
                        154808,  63934, 154808,  63932, 154808,  47362,  47364,
                        179663, 263716, 263722, 263723, 263816, 263832, 263880,
                        263903, 263935, 264228, 264696, 264746, 264803, 264845,
                        264847, 264848, 264849, 264850,  82872, 124392, 192770,
                        223730, 237515, 255431, 255437, 255438, 255531, 255547,
                        255595, 255618, 255650, 255943, 256411, 256461, 256518,
                        256560, 256562, 256563, 256564, 256565, 304199, 328345,
                        328346,  38642, 146276, 146339, 179663, 247153,  38642,
                        146202, 146253, 146258, 146295, 179663, 247146, 247152,
                        247262, 248176, 248275, 248277, 248278, 248279, 248280,
                         22248, 113644, 146202,  80243, 113644, 146295,  22248,
                        113642,  22248, 146295,  22248, 113644, 146295,  22248,
                        146295,  22248, 146295,  22248, 146295,  22248, 146202,
                        146295,  22248,  22248, 113644, 146295,  22248,  22248,
                        113644, 146295,  22248, 113644, 146295,  22248, 113644,
                        146295,  22248, 113644, 146295,  22248, 113644, 146295]]),
       values=tensor([0.6791, 0.6666, 0.6495, 0.5565, 0.6429, 0.5842, 0.6211,
                      0.5725, 0.5993, 0.6712, 0.6104, 0.5788, 0.3000, 0.3026,
                      0.5988, 0.0380, 0.0395, 0.0363, 0.0357, 0.0374, 0.0352,
                      0.0385, 0.0380, 0.0395, 0.0389, 0.0389, 0.0377, 0.0390,
                      0.0362, 0.0367, 0.0362, 0.0381, 0.5794, 0.5956, 0.6156,
                      0.6732, 0.6321, 0.0358, 0.0372, 0.0352, 0.0338, 0.0384,
                      0.0350, 0.0355, 0.0343, 0.0403, 0.0344, 0.0357, 0.0350,
                      0.0354, 0.0368, 0.0375, 0.0357, 0.0387, 0.5974, 0.2999,
                      0.2894, 0.6236, 0.3103, 0.3214, 0.6195, 0.6768, 0.5858,
                      0.1659, 0.1663, 0.1620, 0.1718, 0.6383, 0.0703, 0.0685,
                      0.0655, 0.0734, 0.0686, 0.0709, 0.0694, 0.0706, 0.0711,
                      0.6027, 0.5533, 0.5993, 0.6228, 0.6121, 0.5808, 0.6045,
                      0.6387, 0.6383, 0.6565, 0.6240, 0.6448, 0.6077, 0.5900,
                      0.6407, 0.5687, 0.5969, 0.6622, 0.6371, 0.5436, 0.3186,
                      0.3230, 0.6233, 0.6418, 0.6401, 0.6544, 0.6384, 0.6533,
                      0.6008, 0.6528, 0.6123, 0.6381, 0.6342, 0.6046, 0.6349,
                      0.6048, 0.6378, 0.6079, 0.6074, 0.6307, 0.6052, 0.6429]),
       size=(8285, 753935), nnz=119, layout=torch.sparse_coo,
       grad_fn=<SparseCooTensorWithDimsAndTensorsBackward0>)
Parameter containing:
tensor([0.7498, 0.6928, 0.6168, 0.2270, 0.5880, 0.3400, 0.4944, 0.2920, 0.4025,
        0.7137, 0.4491, 0.3180, 0.4056, 0.4275, 0.4003, 0.5988, 0.7129, 0.4793,
        0.4355, 0.5570, 0.4017, 0.6398, 0.6038, 0.7179, 0.6658, 0.6681, 0.5791,
        0.6730, 0.4700, 0.5054, 0.4674, 0.6115, 0.3205, 0.3871, 0.4710, 0.7226,
        0.5413, 0.4450, 0.5396, 0.3996, 0.2981, 0.6291, 0.3859, 0.4221, 0.3348,
        0.7752, 0.3399, 0.4367, 0.3815, 0.4147, 0.5101, 0.5682, 0.4367, 0.6544,
        0.3945, 0.4046, 0.3181, 0.5047, 0.4918, 0.5876, 0.4873, 0.7391, 0.3464,
        0.6794, 0.6873, 0.6110, 0.7876, 0.5678, 0.5449, 0.4744, 0.3633, 0.6657,
        0.4777, 0.5679, 0.5073, 0.5553, 0.5745, 0.4168, 0.2140, 0.4027, 0.5014,
        0.4561, 0.3262, 0.4241, 0.5695, 0.5680, 0.6479, 0.5067, 0.5964, 0.4376,
        0.3639, 0.5783, 0.2767, 0.3927, 0.6730, 0.5627, 0.1747, 0.5633, 0.6017,
        0.5037, 0.5831, 0.5756, 0.6383, 0.5684, 0.6337, 0.4086, 0.6313, 0.4571,
        0.5671, 0.5503, 0.4249, 0.5533, 0.4257, 0.5657, 0.4384, 0.4362, 0.5351,
        0.4270, 0.5881], requires_grad=True)
num_high 63
pred_loss tensor(-0., grad_fn=<MulBackward0>)
size_loss tensor(594.2320, grad_fn=<MulBackward0>) tensor(-9.8983, grad_fn=<MulBackward0>) tensor(-7.6084, grad_fn=<MulBackward0>)
size_num_loss 3828.125
masked_hor: tensor(indices=tensor([[  5357,   5357,   5408,   5408,   5413,   5413,   5431,
                          5431,   5450,   5450,   5494,   5494,   5502,   5502,
                          5502,   5502,   5502,   5502,   5502,   5502,   5502,
                          5502,   5502,   5502,   5502,   5502,   5502,   5502,
                          5502,   5502,   5502,   5502,   5678,   5678,   5678,
                          5678,   5678,   5678,   5678,   5678,   5678,   5678,
                          5678,   5678,   5678,   5678,   5678,   5678,   5678,
                          5678,   5678,   5678,   5678,   5678,   5678,   5678,
                          5678,   5937,   5937,   5937,   5937,   5937,   5939,
                          5939,   5939,   5939,   5939,   5939,   5939,   5939,
                          5939,   5939,   5939,   5939,   5939,   5939,   5939,
                          6881,   6881,   6881,   6887,   6887,   6887,   6888,
                          6888,   6981,   6981,   6997,   6997,   6997,   7045,
                          7045,   7068,   7068,   7100,   7100,   7393,   7393,
                          7393,   7861,   7911,   7911,   7911,   7968,   8010,
                          8010,   8010,   8012,   8012,   8012,   8013,   8013,
                          8013,   8014,   8014,   8014,   8015,   8015,   8015],
                       [ 63934, 154808,  63934, 154808,  63934, 154808,  63932,
                        154808,  63934, 154808,  63932, 154808,  47362,  47364,
                        179663, 263716, 263722, 263723, 263816, 263832, 263880,
                        263903, 263935, 264228, 264696, 264746, 264803, 264845,
                        264847, 264848, 264849, 264850,  82872, 124392, 192770,
                        223730, 237515, 255431, 255437, 255438, 255531, 255547,
                        255595, 255618, 255650, 255943, 256411, 256461, 256518,
                        256560, 256562, 256563, 256564, 256565, 304199, 328345,
                        328346,  38642, 146276, 146339, 179663, 247153,  38642,
                        146202, 146253, 146258, 146295, 179663, 247146, 247152,
                        247262, 248176, 248275, 248277, 248278, 248279, 248280,
                         22248, 113644, 146202,  80243, 113644, 146295,  22248,
                        113642,  22248, 146295,  22248, 113644, 146295,  22248,
                        146295,  22248, 146295,  22248, 146295,  22248, 146202,
                        146295,  22248,  22248, 113644, 146295,  22248,  22248,
                        113644, 146295,  22248, 113644, 146295,  22248, 113644,
                        146295,  22248, 113644, 146295,  22248, 113644, 146295]]),
       values=tensor([0.5621, 0.5481, 0.5292, 0.4322, 0.5220, 0.4601, 0.4986,
                      0.4482, 0.4756, 0.5532, 0.4873, 0.4546, 0.2382, 0.2409,
                      0.4751, 0.0309, 0.0325, 0.0291, 0.0285, 0.0303, 0.0280,
                      0.0315, 0.0309, 0.0326, 0.0318, 0.0319, 0.0306, 0.0320,
                      0.0290, 0.0295, 0.0289, 0.0310, 0.4552, 0.4718, 0.4928,
                      0.5554, 0.5104, 0.0286, 0.0300, 0.0279, 0.0265, 0.0313,
                      0.0277, 0.0283, 0.0270, 0.0334, 0.0271, 0.0285, 0.0277,
                      0.0282, 0.0296, 0.0304, 0.0285, 0.0317, 0.4736, 0.2381,
                      0.2273, 0.5012, 0.2490, 0.2609, 0.4968, 0.5595, 0.4617,
                      0.1362, 0.1367, 0.1319, 0.1428, 0.5170, 0.0568, 0.0548,
                      0.0518, 0.0601, 0.0549, 0.0574, 0.0558, 0.0571, 0.0576,
                      0.4792, 0.4289, 0.4757, 0.5004, 0.4890, 0.4566, 0.4810,
                      0.5174, 0.5170, 0.5369, 0.5017, 0.5241, 0.4844, 0.4660,
                      0.5196, 0.4444, 0.4732, 0.5432, 0.5157, 0.4193, 0.2579,
                      0.2627, 0.5009, 0.5208, 0.5189, 0.5345, 0.5171, 0.5334,
                      0.4772, 0.5328, 0.4893, 0.5168, 0.5126, 0.4812, 0.5133,
                      0.4814, 0.5164, 0.4846, 0.4841, 0.5088, 0.4818, 0.5220]),
       size=(8285, 753935), nnz=119, layout=torch.sparse_coo,

 20%|██████████████████████████▌                                                                                                          | 2/10 [00:49<03:17, 24.65s/it]
Parameter containing:
tensor([ 0.2498,  0.1928,  0.1168, -0.2731,  0.0880, -0.1601, -0.0056, -0.2081,
        -0.0976,  0.2137, -0.0509, -0.1820, -0.0944, -0.0726, -0.0997,  0.0989,
         0.2129, -0.0207, -0.0645,  0.0571, -0.0983,  0.1398,  0.1039,  0.2179,
         0.1658,  0.1681,  0.0792,  0.1730, -0.0300,  0.0055, -0.0326,  0.1115,
        -0.1796, -0.1130, -0.0290,  0.2226,  0.0414, -0.0551,  0.0397, -0.1005,
        -0.2020,  0.1291, -0.1141, -0.0780, -0.1653,  0.2752, -0.1601, -0.0633,
        -0.1185, -0.0854,  0.0102,  0.0682, -0.0633,  0.1545, -0.1056, -0.0955,
        -0.1820,  0.0048, -0.0082,  0.0876, -0.0127,  0.2391, -0.1537,  0.1794,
         0.1874,  0.1111,  0.2875,  0.0679,  0.0450, -0.0256, -0.1368,  0.1657,
        -0.0223,  0.0680,  0.0074,  0.0553,  0.0746, -0.0832, -0.2862, -0.0974,
         0.0015, -0.0439, -0.1739, -0.0759,  0.0696,  0.0681,  0.1480,  0.0068,
         0.0965, -0.0625, -0.1361,  0.0783, -0.2234, -0.1074,  0.1730,  0.0627,
        -0.3255,  0.0633,  0.1018,  0.0038,  0.0831,  0.0757,  0.1383,  0.0685,
         0.1337, -0.0914,  0.1314, -0.0429,  0.0672,  0.0503, -0.0752,  0.0534,
        -0.0744,  0.0658, -0.0616, -0.0638,  0.0351, -0.0730,  0.0881],
       requires_grad=True)
num_high 0
pred_loss tensor(-0., grad_fn=<MulBackward0>)
size_loss tensor(0., grad_fn=<MulBackward0>) tensor(nan, grad_fn=<MulBackward0>) tensor(-7.6078, grad_fn=<MulBackward0>)
